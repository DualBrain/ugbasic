C:/Users/mario/AppData/Roaming/UGBASIC-IDE/temp/bhoajessceffbhb.asm:
     1  0000  21690c            	LD HL, DUFFDEVICEL0
     2  0003  112300            	LD DE, 35
     3  0006  19                	ADD HL, DE
     4  0007  11690c            	LD DE, DUFFDEVICEL0
     5  000a  13                	INC DE
     6  000b  13                	INC DE
     7  000c  7323722b          	LD (HL), DE
     8                          ORG $100
     9  0010  c3e000            	jp startup_after
    10                          ; /*****************************************************************************
    11                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
    12                          ;  *****************************************************************************
    13                          ;  * Copyright 2021-2023 Marco Spedaletti (asimov@mclink.it)
    14                          ;  *
    15                          ;  * Licensed under the Apache License, Version 2.0 (the "License
    16                          ;  * you may not use this file except in compliance with the License.
    17                          ;  * You may obtain a copy of the License at
    18                          ;  *
    19                          ;  * http://www.apache.org/licenses/LICENSE-2.0
    20                          ;  *
    21                          ;  * Unless required by applicable law or agreed to in writing, software
    22                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
    23                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    24                          ;  * See the License for the specific language governing permissions and
    25                          ;  * limitations under the License.
    26                          ;  *----------------------------------------------------------------------------
    27                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
    28                          ;  * (la "Licenza è proibito usare questo file se non in conformità alla
    29                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
    30                          ;  *
    31                          ;  * http://www.apache.org/licenses/LICENSE-2.0
    32                          ;  *
    33                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
    34                          ;  * il software distribuito nei termini della Licenza è distribuito
    35                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
    36                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
    37                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
    38                          ;  ****************************************************************************/
    39                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
    40                          ;*                                                                             *
    41                          ;*                      STARTUP ROUTINE FOR CPC                             *
    42                          ;*                                                                             *
    43                          ;*                             by Marco Spedaletti                             *
    44                          ;*                                                                             *
    45                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
    46                          PALETTE:
    47  0013  040a130c          	DB      4,  10,  19,  12
    48  0017  0b14150d          	DB     11,  20,  21,  13
    49  001b  061e1f07          	DB      6,  30,  31,   7
    50  001f  12190a07          	DB      18, 25,  10,   7
    51                          PALETTEUNUSED:
    52  0023  00                	DB $00
    53                          SETHWPALETTE:
    54  0024  c5                	PUSH BC
    55  0025  f5                	PUSH AF
    56  0026  01007f            	LD BC, $7F00
    57  0029  dd7c              	LD A, IXH
    58  002b  4f                	LD C, A
    59  002c  ed49              	OUT (C), C
    60  002e  dd7d              	LD A, IXL
    61  0030  f640              	OR A, $40
    62  0032  ed79              	OUT (C), A
    63  0034  f1                	POP AF
    64  0035  c1                	POP BC
    65  0036  c9                	RET
    66                          IRQTIMERVOID:
    67  0037  c9                	RET
    68                          CPCISVC:
    69  0038  f5                	PUSH	AF
    70  0039  c5                	PUSH	BC
    71  003a  d5                	PUSH	DE
    72  003b  e5                	PUSH	HL
    73  003c  dde5              	PUSH	IX
    74  003e  fde5              	PUSH	IY
    75  0040  08                	EX	AF,AF'
    76  0041  f5                	PUSH	AF
    77  0042  d9                	EXX
    78  0043  c5                	PUSH	BC
    79  0044  d5                	PUSH	DE
    80  0045  e5                	PUSH	HL
    81  0046  3ae20c            	LD A, (CPCTIMER2)
    82  0049  3d                	DEC A
    83  004a  32e20c            	LD (CPCTIMER2), A
    84  004d  fe00              	CP 0
    85  004f  202d              	JR NZ,IRQVECTORSKIP
    86  0051  3e06              	LD A,6
    87  0053  32e20c            	LD (CPCTIMER2), A
    88  0056  2aa20c            	LD HL,(CPCTIMER)
    89  0059  23                	INC HL
    90  005a  22a20c            	LD (CPCTIMER),HL
    91  005d  cd201d            	CALL MUSICPLAYER
    92  0060  3ae30c            	LD A, (EVERYCOUNTER)
    93  0063  fe00              	CP 0
    94  0065  2807              	JR Z, IRQTIMERADDR2
    95  0067  3d                	DEC A
    96  0068  32e30c            	LD (EVERYCOUNTER), A
    97  006b  c37e00            	JP IRQVECTORSKIP
    98                          IRQTIMERADDR2:
    99  006e  3a910c            	LD A, (EVERYSTATUS)
   100  0071  fe00              	CP 0
   101  0073  2809              	JR Z, IRQVECTORSKIP
   102  0075  3ae40c            	LD A, (EVERYTIMING)
   103  0078  32e30c            	LD (EVERYCOUNTER), A
   104                          IRQTIMERADDR:
   105  007b  cd3700            	CALL IRQTIMERVOID
   106                          IRQVECTORSKIP:
   107  007e  e1                	POP	HL
   108  007f  d1                	POP	DE
   109  0080  c1                	POP	BC
   110  0081  d9                	EXX
   111  0082  f1                	POP	AF
   112  0083  08                	EX	AF,AF'
   113  0084  fde1              	POP	IY
   114  0086  dde1              	POP	IX
   115  0088  e1                	POP	HL
   116  0089  d1                	POP	DE
   117  008a  c1                	POP	BC
   118  008b  f1                	POP	AF
   119  008c  fb                	EI
   120  008d  c9                	RET
   121                          CPCSTARTUP:
   122  008e  3e32              	LD A, 50
   123  0090  32a80c            	LD (TICKSPERSECOND), A
   124                          
   125                          SYSCALLDONE:
   126  0093  f3                	DI
   127  0094  d9                	EXX
   128  0095  067f              	LD B, $7F
   129  0097  3afc0c            	LD A, (GAVALUE)
   130  009a  f60c              	OR A, $0C
   131  009c  32fc0c            	LD (GAVALUE), A
   132  009f  4f                	LD C, A
   133  00a0  ed49              	OUT (C), C
   134  00a2  d9                	EXX
   135  00a3  fb                	EI
   136  00a4  c9                	RET
   137                          SYSCALL:
   138  00a5  f3                	DI
   139  00a6  d9                	EXX
   140  00a7  067f              	LD B, $7F
   141  00a9  3afc0c            	LD A, (GAVALUE)
   142  00ac  e6f7              	AND A, $F7
   143  00ae  32fc0c            	LD (GAVALUE), A
   144  00b1  4f                	LD C, A
   145  00b2  ed49              	OUT (C), C
   146  00b4  d9                	EXX
   147  00b5  fb                	EI
   148  00b6  f3                	DI
   149                          SYSCALL0:
   150  00b7  cd0000            	CALL $0000
   151  00ba  fb                	EI
   152  00bb  c39300            	JP SYSCALLDONE
   153                          CPCVIDEOSTARTUP:
   154  00be  f3                	DI
   155  00bf  3ec3              	LD A, $C3
   156  00c1  323800            	LD ($0038), A
   157  00c4  213800            	LD HL, CPCISVC
   158  00c7  223900            	LD ($0039), HL
   159  00ca  fb                	EI
   160  00cb  211300            	LD HL, PALETTE
   161                          ; peephole(1): r228 (LD A, 0)->(XOR A)
   162                          ;	LD A, 0
   163  00ce  af                	XOR A
   164  00cf  01000f            	LD BC, $0F00
   165                          CPCVIDEOSTARTUPL1:
   166  00d2  79                	LD A, C
   167  00d3  dd67              	LD IXH, A
   168  00d5  7e                	LD A, (HL)
   169  00d6  dd6f              	LD IXL, A
   170  00d8  cd2400            	CALL SETHWPALETTE
   171  00db  23                	INC HL
   172  00dc  0c                	INC C
   173                          ; peephole(1): r397 (DEC B+JR NZ)->(DJNZ)
   174                          ;	DEC B
   175  00dd  10f3              	DJNZ CPCVIDEOSTARTUPL1
   176                          ;	JR NZ, CPCVIDEOSTARTUPL1
   177  00df  c9                	RET
   178                          startup_after:
   179                          CODESTART:
   180  00e0  3100c0            	LD SP, $C000
   181  00e3  cd7d13            	CALL VARINIT
   182  00e6  cd211d            	CALL PROTOTHREADINIT
   183  00e9  cdbe00            	CALL CPCVIDEOSTARTUP
   184  00ec  3e00              	LD A, $00
   185                          ; peephole(3): unread
   186                          ;	LD (_PEN), A
   187  00ee  3e14              	LD A, $14
   188                          ; peephole(3): unread
   189                          ;	LD (_PAPER), A
   190  00f0  067f              	LD B, $7F
   191  00f2  3afc0c            	LD A, (GAVALUE)
   192  00f5  e63d              	AND A, $3d
   193  00f7  f682              	OR A, $82
   194  00f9  32fc0c            	LD (GAVALUE), A
   195  00fc  4f                	LD C, A
   196  00fd  ed49              	OUT (C), C
   197  00ff  3e00              	LD A, $00
   198                          ; peephole(3): unread
   199                          ;	LD (CLIPX1), A
   200                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
   201                          ;	LD A, $00
   202                          ; peephole(3): unread
   203                          ;	LD (CLIPX1+1), A
   204  0101  3e7f              	LD A, $7f
   205                          ; peephole(3): unread
   206                          ;	LD (CLIPX2), A
   207  0103  3e02              	LD A, $02
   208                          ; peephole(3): unread
   209                          ;	LD (CLIPX2+1), A
   210  0105  3e00              	LD A, $00
   211                          ; peephole(3): unread
   212                          ;	LD (CLIPY1), A
   213                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
   214                          ;	LD A, $00
   215                          ; peephole(3): unread
   216                          ;	LD (CLIPY1+1), A
   217  0107  3ec7              	LD A, $c7
   218                          ; peephole(3): unread
   219                          ;	LD (CLIPY2), A
   220                          ; peephole(4): r407 (LD A, *; LD A, *)->(LD, A)
   221                          ;	LD A, $00
   222                          ; peephole(3): unread
   223                          ;	LD (CLIPY2+1), A
   224                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
   225                          ;	LD A, $00
   226  0109  32b50c            	LD (ORIGINX), A
   227  010c  3e00              	LD A, $00
   228  010e  32b60c            	LD (ORIGINX+1), A
   229                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
   230                          ;	LD A, $00
   231  0111  32b70c            	LD (ORIGINY), A
   232  0114  3e00              	LD A, $00
   233  0116  32b80c            	LD (ORIGINY+1), A
   234  0119  3e80              	LD A, $80
   235  011b  32ae0c            	LD (CURRENTWIDTH), A
   236  011e  3e02              	LD A, $02
   237  0120  32af0c            	LD (CURRENTWIDTH+1), A
   238  0123  3ec8              	LD A, $c8
   239  0125  32b00c            	LD (CURRENTHEIGHT), A
   240  0128  3e00              	LD A, $00
   241  012a  32b10c            	LD (CURRENTHEIGHT+1), A
   242  012d  3aae0c            	LD A, (CURRENTWIDTH)
   243  0130  32b90c            	LD (RESOLUTIONX), A
   244  0133  3aaf0c            	LD A, (CURRENTWIDTH+1)
   245  0136  32ba0c            	LD (RESOLUTIONX+1), A
   246  0139  3ab00c            	LD A, (CURRENTHEIGHT)
   247  013c  32bb0c            	LD (RESOLUTIONY), A
   248  013f  3ab10c            	LD A, (CURRENTHEIGHT+1)
   249  0142  32bc0c            	LD (RESOLUTIONY+1), A
   250  0145  3eff              	LD A, $ff
   251                          ; peephole(3): unread
   252                          ;	LD (CURRENTTILES), A
   253  0147  3e50              	LD A, $50
   254                          ; peephole(3): unread
   255                          ;	LD (CURRENTTILESWIDTH), A
   256  0149  3e19              	LD A, $19
   257                          ; peephole(3): unread
   258                          ;	LD (CURRENTTILESHEIGHT), A
   259  014b  3e08              	LD A, $08
   260                          ; peephole(3): unread
   261                          ;	LD (FONTWIDTH), A
   262                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
   263                          ;	LD A, $08
   264                          ; peephole(3): unread
   265                          ;	LD (FONTHEIGHT), A
   266  014d  3e02              	LD A, $02
   267  014f  32b20c            	LD (PALETTELIMIT), A
   268  0152  cd1f1d            	call AY8910STARTUP
   269  0155  cd8e00            	CALL CPCSTARTUP
   270                          	; L:0
   271                          	; P:208
   272                          	; L:1
   273                          	; P:0
   274                          	; L:2
   275  0158  3e80              	LD A, $80
   276  015a  324013            	LD (_Ttmp1), A
   277  015d  3e02              	LD A, $02
   278  015f  324113            	LD (_Ttmp1+1), A
   279  0162  3e90              	LD A, $90
   280  0164  324213            	LD (_Ttmp2), A
   281  0167  3e01              	LD A, $01
   282  0169  324313            	LD (_Ttmp2+1), A
   283  016c  3a4013            	LD A, (_Ttmp1)
   284  016f  32b90c            	LD (RESOLUTIONX), A
   285  0172  3a4113            	LD A, (_Ttmp1+1)
   286  0175  32ba0c            	LD (RESOLUTIONX+1), A
   287  0178  3aba0c            	LD A, (RESOLUTIONX+1)
   288  017b  e67f              	AND $7f
   289  017d  32ba0c            	LD (RESOLUTIONX+1), A
   290  0180  3a4213            	LD A, (_Ttmp2)
   291  0183  32bb0c            	LD (RESOLUTIONY), A
   292  0186  3a4313            	LD A, (_Ttmp2+1)
   293  0189  32bc0c            	LD (RESOLUTIONY+1), A
   294  018c  3abc0c            	LD A, (RESOLUTIONY+1)
   295  018f  e67f              	AND $7f
   296  0191  32bc0c            	LD (RESOLUTIONY+1), A
   297                          	; P:22
   298                          	; L:3
   299  0194  c3a501            	jp clsGraphic_after
   300                          ; /*****************************************************************************
   301                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
   302                          ;  *****************************************************************************
   303                          ;  * Copyright 2021-2023 Marco Spedaletti (asimov@mclink.it)
   304                          ;  *
   305                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
   306                          ;  * you may not use this file except in compliance with the License.
   307                          ;  * You may obtain a copy of the License at
   308                          ;  *
   309                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   310                          ;  *
   311                          ;  * Unless required by applicable law or agreed to in writing, software
   312                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
   313                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   314                          ;  * See the License for the specific language governing permissions and
   315                          ;  * limitations under the License.
   316                          ;  *----------------------------------------------------------------------------
   317                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
   318                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
   319                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
   320                          ;  *
   321                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   322                          ;  *
   323                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
   324                          ;  * il software distribuito nei termini della Licenza è distribuito
   325                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
   326                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
   327                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
   328                          ;  ****************************************************************************/
   329                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
   330                          ;*                                                                             *
   331                          ;*                      CLEAR SCREEN ROUTINE FOR CPC                           *
   332                          ;*                                                                             *
   333                          ;*                             by Marco Spedaletti                             *
   334                          ;*                                                                             *
   335                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
   336                          CLSG:
   337                          CLSX:
   338                          ; peephole(1): r228 (LD A, 0)->(XOR A)
   339                          ;    LD A, 0
   340  0197  af                	XOR A
   341  0198  2100c0            	LD HL, $C000
   342  019b  77                	LD (HL), A
   343  019c  5d                	LD E, L
   344  019d  54                	LD D, H
   345  019e  13                	INC DE
   346  019f  01ff3f            	LD BC, $3FFF
   347  01a2  edb0              	LDIR
   348  01a4  c9                	RET
   349                          clsGraphic_after:
   350  01a5  cd9701            	CALL CLSG
   351                          	; P:14
   352                          	; L:4
   353  01a8  3e00              	LD A, $00
   354  01aa  324413            	LD (_Ttmp3), A
   355  01ad  3e90              	LD A, $90
   356  01af  324013            	LD (_Ttmp1), A
   357  01b2  3e01              	LD A, $01
   358  01b4  324113            	LD (_Ttmp1+1), A
   359  01b7  3e00              	LD A, $00
   360  01b9  32b50c            	LD (ORIGINX), A
   361                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
   362                          ;	LD A, $00
   363  01bc  32b60c            	LD (ORIGINX+1), A
   364  01bf  3a4413            	LD A, (_Ttmp3)
   365  01c2  32b50c            	LD (ORIGINX), A
   366  01c5  3a4013            	LD A, (_Ttmp1)
   367  01c8  32b70c            	LD (ORIGINY), A
   368  01cb  3a4113            	LD A, (_Ttmp1+1)
   369  01ce  32b80c            	LD (ORIGINY+1), A
   370  01d1  3ab80c            	LD A, (ORIGINY+1)
   371  01d4  e67f              	AND $7f
   372  01d6  32b80c            	LD (ORIGINY+1), A
   373                          	; P:19
   374                          	; L:5
   375                          	; P:0
   376                          	; L:6
   377                          	; P:0
   378                          	; L:7
   379                          	; P:0
   380                          	; L:8
   381                          	; P:0
   382                          	; L:9
   383  01d9  3e15              	LD A, $15
   384  01db  324513            	LD (_Ttmp8), A
   385  01de  01107f            	LD BC,$7F10
   386  01e1  ed49              	OUT (C), C
   387  01e3  3a4513            	LD A, (_Ttmp8)
   388  01e6  f640              	OR A, $40
   389  01e8  ed79              	OUT (C), A
   390                          	; P:7
   391                          	; L:10
   392                          	; P:0
   393                          	; L:11
   394  01ea  3e00              	LD A, $00
   395  01ec  324413            	LD (_Ttmp3), A
   396                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
   397                          ;	LD A, $00
   398  01ef  324813            	LD (_Ttmp12), A
   399  01f2  3e00              	LD A, $00
   400  01f4  324913            	LD (_Ttmp12+1), A
   401  01f7  3a4413            	LD A, (_Ttmp3)
   402  01fa  324813            	LD (_Ttmp12), A
   403  01fd  2ab50c            	LD HL, (ORIGINX)
   404  0200  ed5b4813          	LD DE, (_Ttmp12)
   405  0204  19                	ADD HL, DE
   406  0205  224a13            	LD (_Ttmp14), HL
   407  0208  c32402            	jp fp_fast_from_16_after
   408                          ; /*****************************************************************************
   409                          
   410                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
   411                          
   412                          ;  *****************************************************************************
   413                          
   414                          ;  * Copyright 2023 Marco Spedaletti (asimov@mclink.it)
   415                          
   416                          ;  * Inspired from modules/z80float, copyright 2018 Zeda A.K. Thomas
   417                          
   418                          ;  *
   419                          
   420                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
   421                          
   422                          ;  * you may not use this file except in compliance with the License.
   423                          
   424                          ;  * You may obtain a copy of the License at
   425                          
   426                          ;  *
   427                          
   428                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   429                          
   430                          ;  *
   431                          
   432                          ;  * Unless required by applicable law or agreed to in writing, software
   433                          
   434                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
   435                          
   436                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   437                          
   438                          ;  * See the License for the specific language governing permissions and
   439                          
   440                          ;  * limitations under the License.
   441                          
   442                          ;  *----------------------------------------------------------------------------
   443                          
   444                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
   445                          
   446                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
   447                          
   448                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
   449                          
   450                          ;  *
   451                          
   452                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   453                          
   454                          ;  *
   455                          
   456                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
   457                          
   458                          ;  * il software distribuito nei termini della Licenza è distribuito
   459                          
   460                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
   461                          
   462                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
   463                          
   464                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
   465                          
   466                          ;  ****************************************************************************/
   467                          
   468                          
   469                          
   470                          FPFASTFROM16S:
   471                          
   472  020b  cb7c              	BIT 7, H
   473                          
   474  020d  280a              	JR Z, FPFASTFROM16SPOS
   475                          
   476  020f  af                	XOR A
   477                          
   478  0210  95                	SUB L
   479                          
   480  0211  6f                	LD L, A
   481                          
   482  0212  9f                	SBC A, A
   483                          
   484  0213  94                	SUB H
   485                          
   486  0214  67                	LD H, A
   487                          
   488  0215  06cf              	LD B, $BF+16
   489                          
   490  0217  1802              	JR FPFASTFROM16L1
   491                          
   492                          
   493                          
   494                          FPFASTFROM16SPOS:
   495                          
   496                          
   497                          
   498                          FPFASTFROM16U:
   499                          
   500                          
   501                          
   502  0219  064f              	LD B, $3F+16
   503                          
   504                          
   505                          
   506                          FPFASTFROM16L1:
   507                          
   508                          
   509                          
   510  021b  7c                	LD A, H
   511                          
   512  021c  b5                	OR L
   513                          
   514  021d  c8                	RET Z
   515                          
   516                          
   517                          
   518  021e  05                	DEC B
   519                          
   520  021f  29                	ADD HL, HL
   521                          
   522  0220  30fc              	JR NC, $-2
   523                          
   524  0222  78                	LD A, B
   525                          
   526  0223  c9                	RET
   527                          
   528                          fp_fast_from_16_after:
   529  0224  2a4a13            	LD HL, (_Ttmp14)
   530  0227  cd0b02            	CALL FPFASTFROM16S
   531  022a  324c13            	LD (_Tflt15), A
   532  022d  7c                	LD A, H
   533  022e  324d13            	LD (_Tflt15+1), A
   534  0231  7d                	LD A, L
   535  0232  324e13            	LD (_Tflt15+2), A
   536  0235  2aae0c            	LD HL, (CURRENTWIDTH)
   537  0238  cd0b02            	CALL FPFASTFROM16S
   538  023b  325013            	LD (_Tflt16), A
   539  023e  7c                	LD A, H
   540  023f  325113            	LD (_Tflt16+1), A
   541  0242  7d                	LD A, L
   542  0243  325213            	LD (_Tflt16+2), A
   543  0246  2ab90c            	LD HL, (RESOLUTIONX)
   544  0249  cd0b02            	CALL FPFASTFROM16S
   545  024c  325413            	LD (_Tflt18), A
   546  024f  7c                	LD A, H
   547  0250  325513            	LD (_Tflt18+1), A
   548  0253  7d                	LD A, L
   549  0254  325613            	LD (_Tflt18+2), A
   550  0257  c30b03            	jp fp_mul16_after
   551                          ; /*****************************************************************************
   552                          
   553                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
   554                          
   555                          ;  *****************************************************************************
   556                          
   557                          ;  * Copyright 2023 Marco Spedaletti (asimov@mclink.it)
   558                          
   559                          ;  * Inspired from modules/z80float, copyright 2018 Zeda A.K. Thomas
   560                          
   561                          ;  *
   562                          
   563                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
   564                          
   565                          ;  * you may not use this file except in compliance with the License.
   566                          
   567                          ;  * You may obtain a copy of the License at
   568                          
   569                          ;  *
   570                          
   571                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   572                          
   573                          ;  *
   574                          
   575                          ;  * Unless required by applicable law or agreed to in writing, software
   576                          
   577                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
   578                          
   579                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   580                          
   581                          ;  * See the License for the specific language governing permissions and
   582                          
   583                          ;  * limitations under the License.
   584                          
   585                          ;  *----------------------------------------------------------------------------
   586                          
   587                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
   588                          
   589                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
   590                          
   591                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
   592                          
   593                          ;  *
   594                          
   595                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   596                          
   597                          ;  *
   598                          
   599                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
   600                          
   601                          ;  * il software distribuito nei termini della Licenza è distribuito
   602                          
   603                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
   604                          
   605                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
   606                          
   607                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
   608                          
   609                          ;  ****************************************************************************/
   610                          
   611                          
   612                          
   613                          FPMUL16:
   614                          
   615  025a  7a                	LD	A, D
   616                          
   617  025b  1600              	LD	D, 0
   618                          
   619  025d  60                	LD	H, B
   620                          
   621  025e  69                	LD	L, C
   622                          
   623  025f  87                	ADD	A, A
   624                          
   625  0260  3833              	JR	C, FPMUL_BC_DE_DEHL_BIT14
   626                          
   627  0262  87                	ADD	A, A
   628                          
   629  0263  3836              	JR	C, FPMUL_BC_DE_DEHL_BIT13
   630                          
   631  0265  87                	ADD	A, A
   632                          
   633  0266  3839              	JR	C, FPMUL_BC_DE_DEHL_BIT12
   634                          
   635  0268  87                	ADD	A, A
   636                          
   637  0269  383c              	JR	C, FPMUL_BC_DE_DEHL_BIT11
   638                          
   639  026b  87                	ADD	A, A
   640                          
   641  026c  383f              	JR	C, FPMUL_BC_DE_DEHL_BIT10
   642                          
   643  026e  87                	ADD	A, A
   644                          
   645  026f  3842              	JR	C, FPMUL_BC_DE_DEHL_BIT9
   646                          
   647  0271  87                	ADD	A, A
   648                          
   649  0272  3845              	JR	C, FPMUL_BC_DE_DEHL_BIT8
   650                          
   651  0274  87                	ADD	A, A
   652                          
   653  0275  3848              	JR	C, FPMUL_BC_DE_DEHL_BIT7
   654                          
   655  0277  7b                	LD	A, E
   656                          
   657  0278  e6fe              	AND	%11111110
   658                          
   659  027a  87                	ADD	A, A
   660                          
   661  027b  384d              	JR	C, FPMUL_BC_DE_DEHL_BIT6
   662                          
   663  027d  87                	ADD	A, A
   664                          
   665  027e  3851              	JR	C, FPMUL_BC_DE_DEHL_BIT5
   666                          
   667  0280  87                	ADD	A, A
   668                          
   669  0281  3855              	JR	C, FPMUL_BC_DE_DEHL_BIT4
   670                          
   671  0283  87                	ADD	A, A
   672                          
   673  0284  3859              	JR	C, FPMUL_BC_DE_DEHL_BIT3
   674                          
   675  0286  87                	ADD	A, A
   676                          
   677  0287  385d              	JR	C, FPMUL_BC_DE_DEHL_BIT2
   678                          
   679  0289  87                	ADD	A, A
   680                          
   681  028a  3861              	JR	C, FPMUL_BC_DE_DEHL_BIT1
   682                          
   683  028c  87                	ADD	A, A
   684                          
   685  028d  3865              	JR	C, FPMUL_BC_DE_DEHL_BIT0
   686                          
   687  028f  cb1b              	RR	E
   688                          
   689  0291  d8                	RET	C
   690                          
   691  0292  62                	LD	H, D
   692                          
   693  0293  6b                	LD	L, E
   694                          
   695  0294  c9                	RET
   696                          
   697                          
   698                          
   699                          FPMUL_BC_DE_DEHL_BIT14:
   700                          
   701  0295  29                	ADD	HL, HL
   702                          
   703  0296  8f                	ADC	A, A
   704                          
   705  0297  3002              	JR	NC, FPMUL_BC_DE_DEHL_BIT13
   706                          
   707  0299  09                	ADD	HL, BC
   708                          
   709  029a  8a                	ADC	A, D
   710                          
   711                          FPMUL_BC_DE_DEHL_BIT13:
   712                          
   713  029b  29                	ADD	HL, HL
   714                          
   715  029c  8f                	ADC	A, A
   716                          
   717  029d  3002              	JR	NC, FPMUL_BC_DE_DEHL_BIT12
   718                          
   719  029f  09                	ADD	HL, BC
   720                          
   721  02a0  8a                	ADC	A, D
   722                          
   723                          FPMUL_BC_DE_DEHL_BIT12:
   724                          
   725  02a1  29                	ADD	HL, HL
   726                          
   727  02a2  8f                	ADC	A, A
   728                          
   729  02a3  3002              	JR	NC, FPMUL_BC_DE_DEHL_BIT11
   730                          
   731  02a5  09                	ADD	HL, BC
   732                          
   733  02a6  8a                	ADC	A, D
   734                          
   735                          FPMUL_BC_DE_DEHL_BIT11:
   736                          
   737  02a7  29                	ADD	HL, HL
   738                          
   739  02a8  8f                	ADC	A, A
   740                          
   741  02a9  3002              	JR	NC, FPMUL_BC_DE_DEHL_BIT10
   742                          
   743  02ab  09                	ADD	HL, BC
   744                          
   745  02ac  8a                	ADC	A, D
   746                          
   747                          FPMUL_BC_DE_DEHL_BIT10:
   748                          
   749  02ad  29                	ADD	HL, HL
   750                          
   751  02ae  8f                	ADC	A, A
   752                          
   753  02af  3002              	JR	NC, FPMUL_BC_DE_DEHL_BIT9
   754                          
   755  02b1  09                	ADD	HL, BC
   756                          
   757  02b2  8a                	ADC	A, D
   758                          
   759                          FPMUL_BC_DE_DEHL_BIT9:
   760                          
   761  02b3  29                	ADD	HL, HL
   762                          
   763  02b4  8f                	ADC	A, A
   764                          
   765  02b5  3002              	JR	NC, FPMUL_BC_DE_DEHL_BIT8
   766                          
   767  02b7  09                	ADD	HL, BC
   768                          
   769  02b8  8a                	ADC	A, D
   770                          
   771                          FPMUL_BC_DE_DEHL_BIT8:
   772                          
   773  02b9  29                	ADD	HL, HL
   774                          
   775  02ba  8f                	ADC	A, A
   776                          
   777  02bb  3002              	JR	NC, FPMUL_BC_DE_DEHL_BIT7
   778                          
   779  02bd  09                	ADD	HL, BC
   780                          
   781  02be  8a                	ADC	A, D
   782                          
   783                          FPMUL_BC_DE_DEHL_BIT7:
   784                          
   785  02bf  57                	LD	D, A
   786                          
   787  02c0  7b                	LD	A, E
   788                          
   789  02c1  e6fe              	AND	%11111110
   790                          
   791  02c3  29                	ADD	HL, HL
   792                          
   793  02c4  8f                	ADC	A, A
   794                          
   795  02c5  3003              	JR	NC, FPMUL_BC_DE_DEHL_BIT6
   796                          
   797  02c7  09                	ADD	HL, BC
   798                          
   799  02c8  ce00              	ADC	A, 0
   800                          
   801                          FPMUL_BC_DE_DEHL_BIT6:
   802                          
   803  02ca  29                	ADD	HL, HL
   804                          
   805  02cb  8f                	ADC	A, A
   806                          
   807  02cc  3003              	JR	NC, FPMUL_BC_DE_DEHL_BIT5
   808                          
   809  02ce  09                	ADD	HL, BC
   810                          
   811  02cf  ce00              	ADC	A, 0
   812                          
   813                          FPMUL_BC_DE_DEHL_BIT5:
   814                          
   815  02d1  29                	ADD	HL, HL
   816                          
   817  02d2  8f                	ADC	A, A
   818                          
   819  02d3  3003              	JR	NC, FPMUL_BC_DE_DEHL_BIT4
   820                          
   821  02d5  09                	ADD	HL, BC
   822                          
   823  02d6  ce00              	ADC	A, 0
   824                          
   825                          FPMUL_BC_DE_DEHL_BIT4:
   826                          
   827  02d8  29                	ADD	HL, HL
   828                          
   829  02d9  8f                	ADC	A, A
   830                          
   831  02da  3003              	JR	NC, FPMUL_BC_DE_DEHL_BIT3
   832                          
   833  02dc  09                	ADD	HL, BC
   834                          
   835  02dd  ce00              	ADC	A, 0
   836                          
   837                          FPMUL_BC_DE_DEHL_BIT3:
   838                          
   839  02df  29                	ADD	HL, HL
   840                          
   841  02e0  8f                	ADC	A, A
   842                          
   843  02e1  3003              	JR	NC, FPMUL_BC_DE_DEHL_BIT2
   844                          
   845  02e3  09                	ADD	HL, BC
   846                          
   847  02e4  ce00              	ADC	A, 0
   848                          
   849                          FPMUL_BC_DE_DEHL_BIT2:
   850                          
   851  02e6  29                	ADD	HL, HL
   852                          
   853  02e7  8f                	ADC	A, A
   854                          
   855  02e8  3003              	JR	NC, FPMUL_BC_DE_DEHL_BIT1
   856                          
   857  02ea  09                	ADD	HL, BC
   858                          
   859  02eb  ce00              	ADC	A, 0
   860                          
   861                          FPMUL_BC_DE_DEHL_BIT1:
   862                          
   863  02ed  29                	ADD	HL, HL
   864                          
   865  02ee  8f                	ADC	A, A
   866                          
   867  02ef  3003              	JR	NC, FPMUL_BC_DE_DEHL_BIT0
   868                          
   869  02f1  09                	ADD	HL, BC
   870                          
   871  02f2  ce00              	ADC	A, 0
   872                          
   873                          FPMUL_BC_DE_DEHL_BIT0:
   874                          
   875  02f4  29                	ADD	HL, HL
   876                          
   877  02f5  8f                	ADC	A, A
   878                          
   879  02f6  380a              	JR	C, FPMUL_BC_DE_DEHL_FUNKYCARRY
   880                          
   881  02f8  cb1b              	RR	E
   882                          
   883  02fa  5f                	LD	E, A
   884                          
   885  02fb  d0                	RET	NC
   886                          
   887  02fc  09                	ADD	HL, BC
   888                          
   889  02fd  d0                	RET	NC
   890                          
   891  02fe  1c                	INC	E
   892                          
   893  02ff  c0                	RET	NZ
   894                          
   895  0300  14                	INC	D
   896                          
   897  0301  c9                	RET
   898                          
   899                          
   900                          
   901                          FPMUL_BC_DE_DEHL_FUNKYCARRY:
   902                          
   903  0302  14                	INC	D
   904                          
   905  0303  cb1b              	RR	E
   906                          
   907  0305  5f                	LD	E, A
   908                          
   909  0306  d0                	RET	NC
   910                          
   911  0307  09                	ADD	HL, BC
   912                          
   913  0308  d0                	RET	NC
   914                          
   915  0309  1c                	INC	E
   916                          
   917  030a  c9                	RET
   918                          
   919                          fp_mul16_after:
   920  030b  c38703            	jp fp_fast_mul_after
   921                          ; /*****************************************************************************
   922                          
   923                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
   924                          
   925                          ;  *****************************************************************************
   926                          
   927                          ;  * Copyright 2023 Marco Spedaletti (asimov@mclink.it)
   928                          
   929                          ;  * Inspired from modules/z80float, copyright 2018 Zeda A.K. Thomas
   930                          
   931                          ;  *
   932                          
   933                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
   934                          
   935                          ;  * you may not use this file except in compliance with the License.
   936                          
   937                          ;  * You may obtain a copy of the License at
   938                          
   939                          ;  *
   940                          
   941                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   942                          
   943                          ;  *
   944                          
   945                          ;  * Unless required by applicable law or agreed to in writing, software
   946                          
   947                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
   948                          
   949                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   950                          
   951                          ;  * See the License for the specific language governing permissions and
   952                          
   953                          ;  * limitations under the License.
   954                          
   955                          ;  *----------------------------------------------------------------------------
   956                          
   957                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
   958                          
   959                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
   960                          
   961                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
   962                          
   963                          ;  *
   964                          
   965                          ;  * http://www.apache.org/licenses/LICENSE-2.0
   966                          
   967                          ;  *
   968                          
   969                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
   970                          
   971                          ;  * il software distribuito nei termini della Licenza è distribuito
   972                          
   973                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
   974                          
   975                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
   976                          
   977                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
   978                          
   979                          ;  ****************************************************************************/
   980                          
   981                          
   982                          
   983                          FPFASTMUL:
   984                          
   985                          
   986                          
   987  030e  47                	LD B, A
   988                          
   989  030f  79                	LD A, C
   990                          
   991  0310  e680              	AND $80
   992                          
   993  0312  a8                	XOR B
   994                          
   995                          
   996                          
   997  0313  47                	LD B, A
   998                          
   999  0314  e67f              	AND $7F
  1000                          
  1001  0316  284f              	JR Z, FPFASTMUL_OP1_0
  1002                          
  1003  0318  3c                	INC A
  1004                          
  1005  0319  fa7103            	JP M, FPFASTMUL_OP1_INF_NAN
  1006                          
  1007                          
  1008                          
  1009  031c  79                	LD A, C
  1010                          
  1011  031d  e67f              	AND $7F
  1012                          
  1013  031f  4f                	LD C, A
  1014                          
  1015  0320  c8                	RET Z
  1016                          
  1017  0321  3c                	INC A
  1018                          
  1019  0322  f22803            	JP P, FPFASTMUL_RETURN_CDEL1
  1020                          
  1021                          FPFASTMUL_RETURN_CDE:
  1022                          
  1023  0325  79                	LD A, C
  1024                          
  1025  0326  eb                	EX DE, HL
  1026                          
  1027  0327  c9                	RET
  1028                          
  1029                          FPFASTMUL_RETURN_CDEL1:
  1030                          
  1031                          
  1032                          
  1033  0328  78                	LD A, B
  1034                          
  1035  0329  e67f              	AND $7F
  1036                          
  1037  032b  81                	ADD A, C
  1038                          
  1039  032c  d63f              	SUB 63
  1040                          
  1041  032e  3002              	JR NC, $+4
  1042                          
  1043  0330  af                	XOR A
  1044                          
  1045  0331  c9                	RET
  1046                          
  1047                          
  1048                          
  1049  0332  fe7f              	CP $7F
  1050                          
  1051  0334  3807              	JR C, FPFASTMUL_RETURN_INFX
  1052                          
  1053                          FPFASTMUL_RETURN_INF:
  1054                          
  1055  0336  78                	LD A, B
  1056                          
  1057  0337  f67f              	OR %01111111
  1058                          
  1059  0339  210000            	LD HL, 0
  1060                          
  1061  033c  c9                	RET
  1062                          
  1063                          FPFASTMUL_RETURN_INFX:
  1064                          
  1065                          
  1066                          
  1067  033d  a8                	XOR B
  1068                          
  1069  033e  e67f              	AND $7F
  1070                          
  1071  0340  a8                	XOR B
  1072                          
  1073                          FPFASTMUL_SIGNIFICAND:
  1074                          
  1075  0341  f5                	PUSH AF
  1076                          
  1077                          
  1078                          
  1079  0342  44                	LD B, H
  1080                          
  1081  0343  4d                	LD C, L
  1082                          
  1083  0344  e5                	PUSH HL
  1084                          
  1085  0345  d5                	PUSH DE
  1086                          
  1087  0346  cd5a02            	CALL FPMUL16
  1088                          
  1089  0349  af                	XOR A
  1090                          
  1091  034a  cb24              	SLA H
  1092                          
  1093  034c  eb                	EX DE, HL
  1094                          
  1095  034d  c1                	POP BC
  1096                          
  1097  034e  ed4a              	ADC HL, BC
  1098                          
  1099  0350  ce00              	ADC A, 0
  1100                          
  1101  0352  c1                	POP BC
  1102                          
  1103  0353  09                	ADD HL, BC
  1104                          
  1105  0354  ce00              	ADC A, 0
  1106                          
  1107  0356  1f                	RRA
  1108                          
  1109  0357  c1                	POP BC
  1110                          
  1111  0358  78                	LD A, B
  1112                          
  1113  0359  c8                	RET Z
  1114                          
  1115  035a  3f                	CCF
  1116                          
  1117  035b  cb1c              	RR H
  1118                          
  1119  035d  cb1d              	RR L
  1120                          
  1121  035f  3c                	INC A
  1122                          
  1123  0360  3c                	INC A
  1124                          
  1125  0361  87                	ADD A, A
  1126                          
  1127  0362  28d2              	JR Z, FPFASTMUL_RETURN_INF
  1128                          
  1129  0364  1f                	RRA
  1130                          
  1131  0365  3d                	DEC A
  1132                          
  1133  0366  c9                	RET
  1134                          
  1135                          
  1136                          
  1137                          FPFASTMUL_OP1_0:
  1138                          
  1139  0367  79                	LD A, C
  1140                          
  1141  0368  e67f              	AND $7F
  1142                          
  1143  036a  c8                	RET Z
  1144                          
  1145  036b  3c                	INC A
  1146                          
  1147  036c  fa7a03            	JP M, FPFASTMUL_RETURN_NAN
  1148                          
  1149  036f  af                	XOR A
  1150                          
  1151  0370  c9                	RET
  1152                          
  1153                          
  1154                          
  1155                          FPFASTMUL_OP1_INF_NAN:
  1156                          
  1157  0371  7c                	LD A, H
  1158                          
  1159  0372  b5                	OR L
  1160                          
  1161  0373  78                	LD A, B
  1162                          
  1163  0374  c0                	RET NZ
  1164                          
  1165                          
  1166                          
  1167  0375  79                	LD A, C
  1168                          
  1169  0376  e67f              	AND $7F
  1170                          
  1171  0378  2004              	JR NZ, +FPFASTMUL_RETURN_NANX
  1172                          
  1173                          FPFASTMUL_RETURN_NAN:
  1174                          
  1175  037a  3d                	DEC A
  1176                          
  1177  037b  67                	LD H, A
  1178                          
  1179  037c  6f                	LD L, A
  1180                          
  1181  037d  c9                	RET
  1182                          
  1183                          FPFASTMUL_RETURN_NANX:
  1184                          
  1185  037e  3c                	INC A
  1186                          
  1187  037f  fa8403            	JP M, +FPFASTMUL_RETURN_NANX2
  1188                          
  1189  0382  78                	LD A, B
  1190                          
  1191  0383  c9                	RET
  1192                          
  1193                          FPFASTMUL_RETURN_NANX2:
  1194                          
  1195                          
  1196                          
  1197  0384  79                	LD A, C
  1198                          
  1199  0385  eb                	EX DE, HL
  1200                          
  1201  0386  c9                	RET
  1202                          
  1203                          fp_fast_mul_after:
  1204  0387  3a5213            	LD A, (_Tflt16+2)
  1205  038a  5f                	LD E, A
  1206  038b  3a5113            	LD A, (_Tflt16+1)
  1207  038e  57                	LD D, A
  1208  038f  3a5013            	LD A, (_Tflt16)
  1209  0392  4f                	LD C, A
  1210  0393  3a4e13            	LD A, (_Tflt15+2)
  1211  0396  6f                	LD L, A
  1212  0397  3a4d13            	LD A, (_Tflt15+1)
  1213  039a  67                	LD H, A
  1214  039b  3a4c13            	LD A, (_Tflt15)
  1215  039e  cd0e03            	CALL FPFASTMUL
  1216  03a1  325813            	LD (_Tflt20), A
  1217  03a4  7c                	LD A, H
  1218  03a5  325913            	LD (_Tflt20+1), A
  1219  03a8  7d                	LD A, L
  1220  03a9  325a13            	LD (_Tflt20+2), A
  1221  03ac  c36e04            	jp fp_fast_div_after
  1222                          ; /*****************************************************************************
  1223                          
  1224                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
  1225                          
  1226                          ;  *****************************************************************************
  1227                          
  1228                          ;  * Copyright 2023 Marco Spedaletti (asimov@mclink.it)
  1229                          
  1230                          ;  * Inspired from modules/z80float, copyright 2018 Zeda A.K. Thomas
  1231                          
  1232                          ;  *
  1233                          
  1234                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
  1235                          
  1236                          ;  * you may not use this file except in compliance with the License.
  1237                          
  1238                          ;  * You may obtain a copy of the License at
  1239                          
  1240                          ;  *
  1241                          
  1242                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  1243                          
  1244                          ;  *
  1245                          
  1246                          ;  * Unless required by applicable law or agreed to in writing, software
  1247                          
  1248                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
  1249                          
  1250                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  1251                          
  1252                          ;  * See the License for the specific language governing permissions and
  1253                          
  1254                          ;  * limitations under the License.
  1255                          
  1256                          ;  *----------------------------------------------------------------------------
  1257                          
  1258                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
  1259                          
  1260                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
  1261                          
  1262                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
  1263                          
  1264                          ;  *
  1265                          
  1266                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  1267                          
  1268                          ;  *
  1269                          
  1270                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
  1271                          
  1272                          ;  * il software distribuito nei termini della Licenza è distribuito
  1273                          
  1274                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
  1275                          
  1276                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
  1277                          
  1278                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
  1279                          
  1280                          ;  ****************************************************************************/
  1281                          
  1282                          
  1283                          
  1284                          FPFASTINV:
  1285                          
  1286  03af  4f                	LD C, A
  1287                          
  1288  03b0  eb                	EX DE, HL
  1289                          
  1290  03b1  3e3f              	LD A, $3F
  1291                          
  1292  03b3  210000            	LD HL, 0
  1293                          
  1294                          
  1295                          
  1296                          FPFASTDIV:
  1297                          
  1298                          
  1299                          
  1300  03b6  47                	LD B, A
  1301                          
  1302  03b7  a9                	XOR C
  1303                          
  1304  03b8  87                	ADD A, A
  1305                          
  1306  03b9  78                	LD A, B
  1307                          
  1308  03ba  17                	RLA
  1309                          
  1310  03bb  0f                	RRCA
  1311                          
  1312  03bc  47                	LD B, A
  1313                          
  1314                          
  1315                          
  1316  03bd  e67f              	AND $7F
  1317                          
  1318  03bf  ca4804            	JP Z, FPFASTDIV_0_X
  1319                          
  1320  03c2  3c                	INC A
  1321                          
  1322  03c3  fa5f04            	JP M, FPFASTDIV_INFNAN_X
  1323                          
  1324                          
  1325                          
  1326  03c6  79                	LD A, C
  1327                          
  1328  03c7  e67f              	AND $7F
  1329                          
  1330  03c9  2004              	JR NZ, FPFASTDIVL1
  1331                          
  1332  03cb  3d                	DEC A
  1333                          
  1334  03cc  67                	LD H, A
  1335                          
  1336  03cd  6f                	LD L, A
  1337                          
  1338  03ce  c9                	RET
  1339                          
  1340                          
  1341                          
  1342                          FPFASTDIVL1:
  1343                          
  1344  03cf  3c                	INC A
  1345                          
  1346  03d0  fa5904            	JP M,FPFASTDIV_X_INFNAN
  1347                          
  1348                          
  1349                          
  1350  03d3  cbb9              	RES 7, C
  1351                          
  1352  03d5  78                	LD A, B
  1353                          
  1354  03d6  e67f              	AND $7F
  1355                          
  1356  03d8  c63f              	ADD A, 63
  1357                          
  1358  03da  91                	SUB C
  1359                          
  1360  03db  3002              	JR NC, $+4
  1361                          
  1362  03dd  af                	XOR A
  1363                          
  1364  03de  c9                	RET
  1365                          
  1366                          
  1367                          
  1368  03df  fe7f              	CP $7F
  1369                          
  1370  03e1  3807              	JR C, FPFASTDIV_RETURN_INFL1
  1371                          
  1372                          
  1373                          
  1374                          FPFASTDIV_RETURN_INF:
  1375                          
  1376  03e3  78                	LD A, B
  1377                          
  1378  03e4  f67f              	OR %01111111
  1379                          
  1380  03e6  210000            	LD HL, 0
  1381                          
  1382  03e9  c9                	RET
  1383                          
  1384                          FPFASTDIV_RETURN_INFL1:
  1385                          
  1386                          
  1387                          
  1388  03ea  b7                	OR A
  1389                          
  1390  03eb  0e00              	LD C, 0
  1391                          
  1392  03ed  ed52              	SBC HL, DE
  1393                          
  1394  03ef  300c              	JR NC, FPFASTDIV_READY
  1395                          
  1396                          
  1397                          
  1398  03f1  3d                	DEC A
  1399                          
  1400  03f2  c8                	RET Z
  1401                          
  1402  03f3  19                	ADD HL, DE
  1403                          
  1404  03f4  29                	ADD HL, HL
  1405                          
  1406  03f5  cb11              	RL C
  1407                          
  1408  03f7  0c                	INC C
  1409                          
  1410  03f8  ed52              	SBC HL, DE
  1411                          
  1412  03fa  3001              	JR NC, FPFASTDIV_READY
  1413                          
  1414  03fc  0d                	DEC C
  1415                          
  1416                          FPFASTDIV_READY:
  1417                          
  1418  03fd  c5                	PUSH BC
  1419                          
  1420  03fe  f5                	PUSH AF
  1421                          
  1422                          
  1423                          
  1424  03ff  cd1004            	CALL FPFASTDIV_DIV16
  1425                          
  1426                          
  1427                          
  1428  0402  d1                	POP DE
  1429                          
  1430  0403  c1                	POP BC
  1431                          
  1432  0404  8a                	ADC A, D
  1433                          
  1434  0405  f20b04            	JP P, FPFASTDIV_READYL1
  1435                          
  1436                          FPFASTDIV_RETURN_NAN:
  1437                          
  1438  0408  3d                	DEC A
  1439                          
  1440  0409  67                	LD H, A
  1441                          
  1442  040a  6f                	LD L, A
  1443                          
  1444                          FPFASTDIV_READYL1:
  1445                          
  1446  040b  a8                	XOR B
  1447                          
  1448  040c  e67f              	AND $7F
  1449                          
  1450  040e  a8                	XOR B
  1451                          
  1452  040f  c9                	RET
  1453                          
  1454                          
  1455                          
  1456                          FPFASTDIV_DIV16:
  1457                          
  1458  0410  af                	XOR A
  1459                          
  1460  0411  93                	SUB E
  1461                          
  1462  0412  5f                	LD E, A
  1463                          
  1464                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  1465                          ;	LD A, 0
  1466                          
  1467  0413  af                	XOR A
  1468  0414  9a                	SBC A, D
  1469                          
  1470  0415  57                	LD D, A
  1471                          
  1472  0416  9f                	SBC A, A
  1473                          
  1474  0417  3d                	DEC A
  1475                          
  1476  0418  47                	LD B, A
  1477                          
  1478                          
  1479                          
  1480  0419  79                	LD A, C
  1481                          
  1482  041a  cd3304            	CALL FPFASTDIV_DIV8
  1483                          
  1484  041d  cb11              	RL C
  1485                          
  1486  041f  c5                	PUSH BC
  1487                          
  1488  0420  cd3304            	CALL FPFASTDIV_DIV8
  1489                          
  1490  0423  cb11              	RL C
  1491                          
  1492                          
  1493                          
  1494  0425  29                	ADD HL, HL
  1495                          
  1496  0426  8f                	ADC A, A
  1497                          
  1498  0427  19                	ADD HL, DE
  1499                          
  1500  0428  88                	ADC A, B
  1501                          
  1502                          
  1503                          
  1504  0429  e1                	POP HL
  1505                          
  1506  042a  65                	LD H, L
  1507                          
  1508  042b  69                	LD L, C
  1509                          
  1510  042c  010000            	LD BC, 0
  1511                          
  1512  042f  78                	LD A, B
  1513                          
  1514  0430  ed4a              	ADC HL, BC
  1515                          
  1516  0432  c9                	RET
  1517                          
  1518                          
  1519                          
  1520                          FPFASTDIV_DIV8:
  1521                          
  1522  0433  cd3604            	CALL FPFASTDIV_DIV4
  1523                          
  1524                          FPFASTDIV_DIV4:
  1525                          
  1526  0436  cd3904            	CALL FPFASTDIV_DIV2
  1527                          
  1528                          FPFASTDIV_DIV2:
  1529                          
  1530  0439  cd3c04            	CALL FPFASTDIV_DIV1
  1531                          
  1532                          FPFASTDIV_DIV1:
  1533                          
  1534  043c  cb11              	RL C
  1535                          
  1536  043e  29                	ADD HL, HL
  1537                          
  1538  043f  8f                	ADC A, A
  1539                          
  1540  0440  c8                	RET Z
  1541                          
  1542  0441  19                	ADD HL, DE
  1543                          
  1544  0442  88                	ADC A, B
  1545                          
  1546  0443  d8                	RET C
  1547                          
  1548  0444  ed52              	SBC HL, DE
  1549                          
  1550  0446  98                	SBC A, B
  1551                          
  1552  0447  c9                	RET
  1553                          
  1554                          
  1555                          
  1556                          FPFASTDIV_0_X:
  1557                          
  1558  0448  79                	LD A, C
  1559                          
  1560  0449  e67f              	AND $7F
  1561                          
  1562  044b  28bb              	JR Z, FPFASTDIV_RETURN_NAN
  1563                          
  1564  044d  3c                	INC A
  1565                          
  1566  044e  fa5304            	JP M, FPFASTDIV_0_XL1
  1567                          
  1568  0451  af                	XOR A
  1569                          
  1570  0452  c9                	RET
  1571                          
  1572                          FPFASTDIV_0_XL1:
  1573                          
  1574  0453  7a                	LD A, D
  1575                          
  1576  0454  b3                	OR E
  1577                          
  1578  0455  c8                	RET Z
  1579                          
  1580  0456  79                	LD A, C
  1581                          
  1582  0457  eb                	EX DE, HL
  1583                          
  1584  0458  c9                	RET
  1585                          
  1586                          
  1587                          
  1588                          FPFASTDIV_X_INFNAN:
  1589                          
  1590  0459  7a                	LD A, D
  1591                          
  1592  045a  b3                	OR E
  1593                          
  1594  045b  c8                	RET Z
  1595                          
  1596  045c  79                	LD A, C
  1597                          
  1598                          FPFASTDIV_X_INFNANL1:
  1599                          
  1600  045d  eb                	EX DE, HL
  1601                          
  1602  045e  c9                	RET
  1603                          
  1604                          
  1605                          
  1606                          FPFASTDIV_INFNAN_X:
  1607                          
  1608  045f  7c                	LD A, H
  1609                          
  1610  0460  b5                	OR L
  1611                          
  1612  0461  78                	LD A, B
  1613                          
  1614  0462  c0                	RET NZ
  1615                          
  1616  0463  79                	LD A, C
  1617                          
  1618  0464  e67f              	AND $7F
  1619                          
  1620  0466  28a0              	JR Z, FPFASTDIV_RETURN_NAN
  1621                          
  1622  0468  3c                	INC A
  1623                          
  1624  0469  fa0804            	JP M, FPFASTDIV_RETURN_NAN
  1625                          
  1626  046c  78                	LD A, B
  1627                          
  1628  046d  c9                	RET
  1629                          
  1630                          
  1631                          fp_fast_div_after:
  1632  046e  3a5613            	LD A, (_Tflt18+2)
  1633  0471  5f                	LD E, A
  1634  0472  3a5513            	LD A, (_Tflt18+1)
  1635  0475  57                	LD D, A
  1636  0476  3a5413            	LD A, (_Tflt18)
  1637  0479  4f                	LD C, A
  1638  047a  3a5a13            	LD A, (_Tflt20+2)
  1639  047d  6f                	LD L, A
  1640  047e  3a5913            	LD A, (_Tflt20+1)
  1641  0481  67                	LD H, A
  1642  0482  3a5813            	LD A, (_Tflt20)
  1643  0485  cdb603            	CALL FPFASTDIV
  1644  0488  325c13            	LD (_Tflt21), A
  1645  048b  7c                	LD A, H
  1646  048c  325d13            	LD (_Tflt21+1), A
  1647  048f  7d                	LD A, L
  1648  0490  325e13            	LD (_Tflt21+2), A
  1649  0493  c30c05            	jp fp_fast_to_16_after
  1650                          ; /*****************************************************************************
  1651                          
  1652                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
  1653                          
  1654                          ;  *****************************************************************************
  1655                          
  1656                          ;  * Copyright 2023 Marco Spedaletti (asimov@mclink.it)
  1657                          
  1658                          ;  * Inspired from modules/z80float, copyright 2018 Zeda A.K. Thomas
  1659                          
  1660                          ;  *
  1661                          
  1662                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
  1663                          
  1664                          ;  * you may not use this file except in compliance with the License.
  1665                          
  1666                          ;  * You may obtain a copy of the License at
  1667                          
  1668                          ;  *
  1669                          
  1670                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  1671                          
  1672                          ;  *
  1673                          
  1674                          ;  * Unless required by applicable law or agreed to in writing, software
  1675                          
  1676                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
  1677                          
  1678                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  1679                          
  1680                          ;  * See the License for the specific language governing permissions and
  1681                          
  1682                          ;  * limitations under the License.
  1683                          
  1684                          ;  *----------------------------------------------------------------------------
  1685                          
  1686                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
  1687                          
  1688                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
  1689                          
  1690                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
  1691                          
  1692                          ;  *
  1693                          
  1694                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  1695                          
  1696                          ;  *
  1697                          
  1698                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
  1699                          
  1700                          ;  * il software distribuito nei termini della Licenza è distribuito
  1701                          
  1702                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
  1703                          
  1704                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
  1705                          
  1706                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
  1707                          
  1708                          ;  ****************************************************************************/
  1709                          
  1710                          
  1711                          
  1712                          FPFASTTOS16:
  1713                          
  1714  0496  4f                	LD C, A
  1715                          
  1716  0497  87                	ADD A, A
  1717                          
  1718  0498  2814              	JR Z, FPFASTTOI16_RETURN_0
  1719                          
  1720                          
  1721                          
  1722  049a  fefe              	CP $FE
  1723                          
  1724  049c  200c              	JR NZ, FPFASTTOS16L1
  1725                          
  1726  049e  7c                	LD A, H
  1727                          
  1728  049f  b5                	OR L
  1729                          
  1730  04a0  200c              	JR NZ,FPFASTTOI16_RETURN_0
  1731                          
  1732                          FPFASTTOI16_RETURN_INF:
  1733                          
  1734  04a2  cb21              	SLA C
  1735                          
  1736  04a4  21ff7f            	LD HL, 32767
  1737                          
  1738  04a7  d0                	RET NC
  1739                          
  1740  04a8  23                	INC HL
  1741                          
  1742  04a9  c9                	RET
  1743                          
  1744                          FPFASTTOS16L1:
  1745                          
  1746                          
  1747                          
  1748  04aa  fe7e              	CP 63*2
  1749                          
  1750  04ac  3004              	JR NC, FPFASTTOS16L2
  1751                          
  1752                          FPFASTTOI16_RETURN_0:
  1753                          
  1754  04ae  210000            	LD HL, 0
  1755                          
  1756  04b1  c9                	RET
  1757                          
  1758                          FPFASTTOS16L2:
  1759                          
  1760                          
  1761                          
  1762  04b2  1f                	RRA
  1763                          
  1764  04b3  d63f              	SUB 63
  1765                          
  1766  04b5  fe0f              	CP 15
  1767                          
  1768  04b7  30e9              	JR NC, FPFASTTOI16_RETURN_INF
  1769                          
  1770                          
  1771                          
  1772  04b9  b7                	OR A
  1773                          
  1774  04ba  47                	LD B, A
  1775                          
  1776  04bb  1600              	LD D, 0
  1777                          
  1778  04bd  3e01              	LD A, 1
  1779                          
  1780  04bf  2806              	JR Z, FPFASTTOS16L3
  1781                          
  1782                          
  1783                          
  1784  04c1  29                	ADD HL, HL
  1785                          
  1786  04c2  17                	RLA
  1787                          
  1788  04c3  cb12              	RL D
  1789                          
  1790  04c5  10fa              	DJNZ $-4
  1791                          
  1792                          FPFASTTOS16L3:
  1793                          
  1794  04c7  cb21              	SLA C
  1795                          
  1796  04c9  5f                	LD E, A
  1797                          
  1798  04ca  eb                	EX DE, HL
  1799                          
  1800  04cb  d0                	RET NC
  1801                          
  1802  04cc  af                	XOR A
  1803                          
  1804  04cd  95                	SUB L
  1805                          
  1806  04ce  6f                	LD L, A
  1807                          
  1808  04cf  9f                	SBC A, A
  1809                          
  1810  04d0  94                	SUB H
  1811                          
  1812  04d1  67                	LD H, A
  1813                          
  1814  04d2  c9                	RET
  1815                          
  1816                          
  1817                          
  1818                          FPFASTTOU16:
  1819                          
  1820  04d3  4f                	LD C,A
  1821                          
  1822                          
  1823                          
  1824  04d4  87                	ADD A, A
  1825                          
  1826  04d5  2810              	JR Z, FPFASTTOU16_RETURN_0
  1827                          
  1828                          
  1829                          
  1830  04d7  fefe              	CP $FE
  1831                          
  1832  04d9  2008              	JR NZ, FPFASTTOU16L1
  1833                          
  1834  04db  7c                	LD A, H
  1835                          
  1836  04dc  b5                	OR L
  1837                          
  1838  04dd  2008              	JR NZ, FPFASTTOU16_RETURN_0
  1839                          
  1840                          FPFASTTOU16_RETURN_INF:
  1841                          
  1842  04df  21ffff            	LD HL, -1
  1843                          
  1844  04e2  c9                	RET
  1845                          
  1846                          FPFASTTOU16L1:
  1847                          
  1848                          
  1849                          
  1850  04e3  fe7e              	CP 63*2
  1851                          
  1852  04e5  3004              	JR NC, FPFASTTOU16L2
  1853                          
  1854                          FPFASTTOU16_RETURN_0:
  1855                          
  1856  04e7  210000            	LD HL, 0
  1857                          
  1858  04ea  c9                	RET
  1859                          
  1860                          FPFASTTOU16L2:
  1861                          
  1862                          
  1863                          
  1864  04eb  1f                	RRA
  1865                          
  1866  04ec  d63f              	SUB 63
  1867                          
  1868  04ee  fe10              	CP 16
  1869                          
  1870  04f0  30ed              	JR NC, FPFASTTOU16_RETURN_INF
  1871                          
  1872                          
  1873                          
  1874  04f2  47                	LD B, A
  1875                          
  1876  04f3  b7                	OR A
  1877                          
  1878  04f4  3e01              	LD A, 1
  1879                          
  1880  04f6  1600              	LD D, 0
  1881                          
  1882  04f8  2806              	JR Z, FPFASTTOU16L3
  1883                          
  1884                          
  1885                          
  1886  04fa  29                	ADD HL, HL
  1887                          
  1888  04fb  17                	RLA
  1889                          
  1890  04fc  cb12              	RL D
  1891                          
  1892  04fe  10fa              	DJNZ $-4
  1893                          
  1894                          FPFASTTOU16L3:
  1895                          
  1896  0500  cb21              	SLA C
  1897                          
  1898  0502  5f                	LD E, A
  1899                          
  1900  0503  eb                	EX DE, HL
  1901                          
  1902  0504  d0                	RET NC
  1903                          
  1904  0505  af                	XOR A
  1905                          
  1906  0506  95                	SUB L
  1907                          
  1908  0507  6f                	LD L, A
  1909                          
  1910  0508  9f                	SBC A, A
  1911                          
  1912  0509  94                	SUB H
  1913                          
  1914  050a  67                	LD H, A
  1915                          
  1916  050b  c9                	RET
  1917                          
  1918                          fp_fast_to_16_after:
  1919  050c  3a5e13            	LD A, (_Tflt21+2)
  1920  050f  6f                	LD L, A
  1921  0510  3a5d13            	LD A, (_Tflt21+1)
  1922  0513  67                	LD H, A
  1923  0514  3a5c13            	LD A, (_Tflt21)
  1924  0517  cd9604            	CALL FPFASTTOS16
  1925  051a  224613            	LD (_Ttmp11), HL
  1926  051d  3e00              	LD A, $00
  1927  051f  326013            	LD (_Ttmp23), A
  1928                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  1929                          ;	LD A, $00
  1930  0522  326313            	LD (_Ttmp25), A
  1931  0525  3e00              	LD A, $00
  1932  0527  326413            	LD (_Ttmp25+1), A
  1933  052a  3a6013            	LD A, (_Ttmp23)
  1934  052d  326313            	LD (_Ttmp25), A
  1935  0530  2ab70c            	LD HL, (ORIGINY)
  1936  0533  ed5b6313          	LD DE, (_Ttmp25)
  1937  0537  a7                	AND A
  1938  0538  ed52              	SBC HL, DE
  1939  053a  226513            	LD (_Ttmp29), HL
  1940  053d  2a6513            	LD HL, (_Ttmp29)
  1941  0540  cd0b02            	CALL FPFASTFROM16S
  1942  0543  326713            	LD (_Tflt30), A
  1943  0546  7c                	LD A, H
  1944  0547  326813            	LD (_Tflt30+1), A
  1945  054a  7d                	LD A, L
  1946  054b  326913            	LD (_Tflt30+2), A
  1947  054e  2ab00c            	LD HL, (CURRENTHEIGHT)
  1948  0551  cd0b02            	CALL FPFASTFROM16S
  1949  0554  326b13            	LD (_Tflt32), A
  1950  0557  7c                	LD A, H
  1951  0558  326c13            	LD (_Tflt32+1), A
  1952  055b  7d                	LD A, L
  1953  055c  326d13            	LD (_Tflt32+2), A
  1954  055f  2abb0c            	LD HL, (RESOLUTIONY)
  1955  0562  cd0b02            	CALL FPFASTFROM16S
  1956  0565  326f13            	LD (_Tflt34), A
  1957  0568  7c                	LD A, H
  1958  0569  327013            	LD (_Tflt34+1), A
  1959  056c  7d                	LD A, L
  1960  056d  327113            	LD (_Tflt34+2), A
  1961  0570  3a6d13            	LD A, (_Tflt32+2)
  1962  0573  5f                	LD E, A
  1963  0574  3a6c13            	LD A, (_Tflt32+1)
  1964  0577  57                	LD D, A
  1965  0578  3a6b13            	LD A, (_Tflt32)
  1966  057b  4f                	LD C, A
  1967  057c  3a6913            	LD A, (_Tflt30+2)
  1968  057f  6f                	LD L, A
  1969  0580  3a6813            	LD A, (_Tflt30+1)
  1970  0583  67                	LD H, A
  1971  0584  3a6713            	LD A, (_Tflt30)
  1972  0587  cd0e03            	CALL FPFASTMUL
  1973  058a  327313            	LD (_Tflt36), A
  1974  058d  7c                	LD A, H
  1975  058e  327413            	LD (_Tflt36+1), A
  1976  0591  7d                	LD A, L
  1977  0592  327513            	LD (_Tflt36+2), A
  1978  0595  3a7113            	LD A, (_Tflt34+2)
  1979  0598  5f                	LD E, A
  1980  0599  3a7013            	LD A, (_Tflt34+1)
  1981  059c  57                	LD D, A
  1982  059d  3a6f13            	LD A, (_Tflt34)
  1983  05a0  4f                	LD C, A
  1984  05a1  3a7513            	LD A, (_Tflt36+2)
  1985  05a4  6f                	LD L, A
  1986  05a5  3a7413            	LD A, (_Tflt36+1)
  1987  05a8  67                	LD H, A
  1988  05a9  3a7313            	LD A, (_Tflt36)
  1989  05ac  cdb603            	CALL FPFASTDIV
  1990  05af  327713            	LD (_Tflt37), A
  1991  05b2  7c                	LD A, H
  1992  05b3  327813            	LD (_Tflt37+1), A
  1993  05b6  7d                	LD A, L
  1994  05b7  327913            	LD (_Tflt37+2), A
  1995  05ba  3a7913            	LD A, (_Tflt37+2)
  1996  05bd  6f                	LD L, A
  1997  05be  3a7813            	LD A, (_Tflt37+1)
  1998  05c1  67                	LD H, A
  1999  05c2  3a7713            	LD A, (_Tflt37)
  2000  05c5  cd9604            	CALL FPFASTTOS16
  2001  05c8  226113            	LD (_Ttmp24), HL
  2002  05cb  c3ce05            	jp cpcvars_after
  2003                          ; /*****************************************************************************
  2004                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
  2005                          ;  *****************************************************************************
  2006                          ;  * Copyright 2021-2023 Marco Spedaletti (asimov@mclink.it)
  2007                          ;  *
  2008                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
  2009                          ;  * you may not use this file except in compliance with the License.
  2010                          ;  * You may obtain a copy of the License at
  2011                          ;  *
  2012                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  2013                          ;  *
  2014                          ;  * Unless required by applicable law or agreed to in writing, software
  2015                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
  2016                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  2017                          ;  * See the License for the specific language governing permissions and
  2018                          ;  * limitations under the License.
  2019                          ;  *----------------------------------------------------------------------------
  2020                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
  2021                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
  2022                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
  2023                          ;  *
  2024                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  2025                          ;  *
  2026                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
  2027                          ;  * il software distribuito nei termini della Licenza è distribuito
  2028                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
  2029                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
  2030                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
  2031                          ;  ****************************************************************************/
  2032                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  2033                          ;*                                                                             *
  2034                          ;*                          INTERNAL VARIABLES FOR CPC                         *
  2035                          ;*                                                                             *
  2036                          ;*                             by Marco Spedaletti                             *
  2037                          ;*                                                                             *
  2038                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  2039                          cpcvars_after:
  2040  05ce  c30a09            	jp cpcvarsGraphic_after
  2041                          ; /*****************************************************************************
  2042                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
  2043                          ;  *****************************************************************************
  2044                          ;  * Copyright 2021-2023 Marco Spedaletti (asimov@mclink.it)
  2045                          ;  *
  2046                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
  2047                          ;  * you may not use this file except in compliance with the License.
  2048                          ;  * You may obtain a copy of the License at
  2049                          ;  *
  2050                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  2051                          ;  *
  2052                          ;  * Unless required by applicable law or agreed to in writing, software
  2053                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
  2054                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  2055                          ;  * See the License for the specific language governing permissions and
  2056                          ;  * limitations under the License.
  2057                          ;  *----------------------------------------------------------------------------
  2058                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
  2059                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
  2060                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
  2061                          ;  *
  2062                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  2063                          ;  *
  2064                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
  2065                          ;  * il software distribuito nei termini della Licenza è distribuito
  2066                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
  2067                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
  2068                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
  2069                          ;  ****************************************************************************/
  2070                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  2071                          ;*                                                                             *
  2072                          ;*                          INTERNAL VARIABLES FOR CPC                         *
  2073                          ;*                                                                             *
  2074                          ;*                             by Marco Spedaletti                             *
  2075                          ;*                                                                             *
  2076                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  2077                          PLOTVBASE:
  2078  05d1  00c000c800d000d8  	DW $C000, $C800, $D000, $D800, $E000, $E800, $F000, $F800
              00e000e800f000f8  
  2079  05e1  50c050c850d050d8  	DW $C050, $C850, $D050, $D850, $E050, $E850, $F050, $F850
              50e050e850f050f8  
  2080  05f1  a0c0a0c8a0d0a0d8  	DW $C0A0, $C8A0, $D0A0, $D8A0, $E0A0, $E8A0, $F0A0, $F8A0
              a0e0a0e8a0f0a0f8  
  2081  0601  f0c0f0c8f0d0f0d8  	DW $C0F0, $C8F0, $D0F0, $D8F0, $E0F0, $E8F0, $F0F0, $F8F0
              f0e0f0e8f0f0f0f8  
  2082  0611  40c140c940d140d9  	DW $C140, $C940, $D140, $D940, $E140, $E940, $F140, $F940
              40e140e940f140f9  
  2083  0621  90c190c990d190d9  	DW $C190, $C990, $D190, $D990, $E190, $E990, $F190, $F990
              90e190e990f190f9  
  2084  0631  e0c1e0c9e0d1e0d9  	DW $C1E0, $C9E0, $D1E0, $D9E0, $E1E0, $E9E0, $F1E0, $F9E0
              e0e1e0e9e0f1e0f9  
  2085  0641  30c230ca30d230da  	DW $C230, $CA30, $D230, $DA30, $E230, $EA30, $F230, $FA30
              30e230ea30f230fa  
  2086  0651  80c280ca80d280da  	DW $C280, $CA80, $D280, $DA80, $E280, $EA80, $F280, $FA80
              80e280ea80f280fa  
  2087  0661  d0c2d0cad0d2d0da  	DW $C2D0, $CAD0, $D2D0, $DAD0, $E2D0, $EAD0, $F2D0, $FAD0
              d0e2d0ead0f2d0fa  
  2088  0671  20c320cb20d320db  	DW $C320, $CB20, $D320, $DB20, $E320, $EB20, $F320, $FB20
              20e320eb20f320fb  
  2089  0681  70c370cb70d370db  	DW $C370, $CB70, $D370, $DB70, $E370, $EB70, $F370, $FB70
              70e370eb70f370fb  
  2090  0691  c0c3c0cbc0d3c0db  	DW $C3C0, $CBC0, $D3C0, $DBC0, $E3C0, $EBC0, $F3C0, $FBC0
              c0e3c0ebc0f3c0fb  
  2091  06a1  10c410cc10d410dc  	DW $C410, $CC10, $D410, $DC10, $E410, $EC10, $F410, $FC10
              10e410ec10f410fc  
  2092  06b1  60c460cc60d460dc  	DW $C460, $CC60, $D460, $DC60, $E460, $EC60, $F460, $FC60
              60e460ec60f460fc  
  2093  06c1  b0c4b0ccb0d4b0dc  	DW $C4B0, $CCB0, $D4B0, $DCB0, $E4B0, $ECB0, $F4B0, $FCB0
              b0e4b0ecb0f4b0fc  
  2094  06d1  00c500cd00d500dd  	DW $C500, $CD00, $D500, $DD00, $E500, $ED00, $F500, $FD00
              00e500ed00f500fd  
  2095  06e1  50c550cd50d550dd  	DW $C550, $CD50, $D550, $DD50, $E550, $ED50, $F550, $FD50
              50e550ed50f550fd  
  2096  06f1  a0c5a0cda0d5a0dd  	DW $C5A0, $CDA0, $D5A0, $DDA0, $E5A0, $EDA0, $F5A0, $FDA0
              a0e5a0eda0f5a0fd  
  2097  0701  f0c5f0cdf0d5f0dd  	DW $C5F0, $CDF0, $D5F0, $DDF0, $E5F0, $EDF0, $F5F0, $FDF0
              f0e5f0edf0f5f0fd  
  2098  0711  40c640ce40d640de  	DW $C640, $CE40, $D640, $DE40, $E640, $EE40, $F640, $FE40
              40e640ee40f640fe  
  2099  0721  90c690ce90d690de  	DW $C690, $CE90, $D690, $DE90, $E690, $EE90, $F690, $FE90
              90e690ee90f690fe  
  2100  0731  e0c6e0cee0d6e0de  	DW $C6E0, $CEE0, $D6E0, $DEE0, $E6E0, $EEE0, $F6E0, $FEE0
              e0e6e0eee0f6e0fe  
  2101  0741  30c730cf30d730df  	DW $C730, $CF30, $D730, $DF30, $E730, $EF30, $F730, $FF30
              30e730ef30f730ff  
  2102  0751  80c780cf80d780df  	DW $C780, $CF80, $D780, $DF80, $E780, $EF80, $F780, $FF80
              80e780ef80f780ff  
  2103                          ; Look for a specific color into the palette.
  2104                          ;   input: IXL = color to look for
  2105                          ;   output: IXH = index of ink, $FF if not found
  2106                          CPCLOOKFORPALETTE:
  2107  0761  c5                	PUSH BC
  2108  0762  e5                	PUSH HL
  2109  0763  f5                	PUSH AF
  2110  0764  d5                	PUSH DE
  2111  0765  211300            	LD HL, PALETTE
  2112                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2113                          ;    LD A, 0
  2114  0768  af                	XOR A
  2115  0769  4f                	LD C, A
  2116  076a  dd7d              	LD A, IXL
  2117  076c  47                	LD B, A
  2118  076d  0c                	INC C
  2119  076e  23                	INC HL
  2120                          CPCLOOKFORPALETTEL1:
  2121  076f  7e                	LD A, (HL)
  2122  0770  b8                	CP B
  2123  0771  280f              	JR Z, CPCLOOKFORPALETTEFOUND
  2124  0773  23                	INC HL
  2125  0774  0c                	INC C
  2126  0775  3ab20c            	LD A, (PALETTELIMIT)
  2127  0778  5f                	LD E, A
  2128  0779  79                	LD A, C
  2129  077a  bb                	CP E
  2130  077b  38f2              	JR C, CPCLOOKFORPALETTEL1
  2131  077d  20f0              	JR NZ, CPCLOOKFORPALETTEL1
  2132  077f  3eff              	LD A, $FF
  2133  0781  4f                	LD C, A
  2134                          CPCLOOKFORPALETTEFOUND:
  2135  0782  d1                	POP DE
  2136  0783  f1                	POP AF
  2137  0784  e1                	POP HL
  2138  0785  79                	LD A, C
  2139  0786  dd67              	LD IXH, A
  2140  0788  c1                	POP BC
  2141  0789  c9                	RET
  2142                          ; Insert a specific color into the palette.
  2143                          ;   input: IXL = color to insert
  2144                          ;   output: IXH = index of ink allocated
  2145                          CPCINSERTPALETTE:
  2146  078a  c5                	PUSH BC
  2147  078b  e5                	PUSH HL
  2148  078c  d5                	PUSH DE
  2149  078d  f5                	PUSH AF
  2150  078e  dd7d              	LD A, IXL
  2151  0790  feff              	CP $FF
  2152  0792  2828              	JR Z, CPCINSERTPALETTEDONE
  2153  0794  3ab20c            	LD A, (PALETTELIMIT)
  2154  0797  47                	LD B, A
  2155  0798  3a2300            	LD A, (PALETTEUNUSED)
  2156  079b  3c                	INC A
  2157  079c  b8                	CP B
  2158  079d  3802              	JR C, CPCINSERTPALETTEUNDER
  2159  079f  3e01              	LD A, 1
  2160                          CPCINSERTPALETTEUNDER:
  2161  07a1  322300            	LD (PALETTEUNUSED), A
  2162  07a4  dd67              	LD IXH, A
  2163  07a6  3a2300            	LD A, (PALETTEUNUSED)
  2164  07a9  211300            	LD HL, PALETTE
  2165  07ac  5f                	LD E, A
  2166                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2167                          ;    LD A, 0
  2168  07ad  af                	XOR A
  2169  07ae  57                	LD D, A
  2170  07af  19                	ADD HL, DE
  2171  07b0  dd7d              	LD A, IXL
  2172  07b2  77                	LD (HL), A
  2173  07b3  fd7d              	LD A, IYL
  2174  07b5  fe00              	CP $0
  2175  07b7  2803              	JR Z, CPCINSERTPALETTEDONE
  2176  07b9  cd2400            	CALL SETHWPALETTE
  2177                          CPCINSERTPALETTEDONE:
  2178  07bc  f1                	POP AF
  2179  07bd  d1                	POP DE
  2180  07be  e1                	POP HL
  2181  07bf  c1                	POP BC
  2182  07c0  c9                	RET
  2183                          ; Update a specific color into the palette.
  2184                          ;   input:
  2185                          ;           IXH = index of ink to update
  2186                          ;           IXL = color to update
  2187                          ;           IYL > 0 update ink on GATE ARRAY, also
  2188                          CPCUPDATEPALETTE:
  2189  07c1  f5                	PUSH AF
  2190  07c2  e5                	PUSH HL
  2191  07c3  d5                	PUSH DE
  2192  07c4  dd7d              	LD A, IXL
  2193  07c6  feff              	CP $FF
  2194  07c8  2814              	JR Z, CPCUPDATEPALETTEDONE
  2195  07ca  dd5c              	LD E, IXH
  2196                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2197                          ;    LD A, 0
  2198  07cc  af                	XOR A
  2199  07cd  57                	LD D, A
  2200  07ce  211300            	LD HL, PALETTE
  2201  07d1  19                	ADD HL, DE
  2202  07d2  dd7d              	LD A, IXL
  2203  07d4  77                	LD (HL), A
  2204  07d5  fd7d              	LD A, IYL
  2205  07d7  fe00              	CP $0
  2206  07d9  2803              	JR Z, CPCUPDATEPALETTEDONE
  2207  07db  cd2400            	CALL SETHWPALETTE
  2208                          CPCUPDATEPALETTEDONE:
  2209  07de  d1                	POP DE
  2210  07df  e1                	POP HL
  2211  07e0  f1                	POP AF
  2212  07e1  c9                	RET
  2213                          ; Get a specific color from the palette.
  2214                          ;   input:
  2215                          ;           IXH = index of ink
  2216                          ;   output:
  2217                          ;           IXL = color
  2218                          CPCGETPALETTE:
  2219  07e2  f5                	PUSH AF
  2220  07e3  e5                	PUSH HL
  2221  07e4  d5                	PUSH DE
  2222  07e5  dd5c              	LD E, IXH
  2223                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2224                          ;    LD A, 0
  2225  07e7  af                	XOR A
  2226  07e8  57                	LD D, A
  2227  07e9  211300            	LD HL, PALETTE
  2228  07ec  19                	ADD HL, DE
  2229  07ed  7e                	LD A, (HL)
  2230  07ee  dd6f              	LD IXL, A
  2231  07f0  d1                	POP DE
  2232  07f1  e1                	POP HL
  2233  07f2  f1                	POP AF
  2234  07f3  c9                	RET
  2235                          ; Look for a specific color into the palette and, if missing,
  2236                          ; insert it into palette.
  2237                          ;   input:
  2238                          ;           IXL = color to look for / insert
  2239                          ;           IYL > 0 update ink on GATE ARRAY, also
  2240                          ;   output:
  2241                          ;           IXH = index of ink
  2242                          CPCSELECTPALETTE:
  2243  07f4  cd6107            	CALL CPCLOOKFORPALETTE
  2244  07f7  dd7c              	LD A, IXH
  2245  07f9  feff              	CP $FF
  2246  07fb  c0                	RET NZ
  2247                          ; peephole(1): r383 (CALL+RET)->(JP)
  2248                          ;    CALL CPCINSERTPALETTE
  2249  07fc  c38a07            	JP CPCINSERTPALETTE
  2250                          ;    RET
  2251                          ; CPCVIDEOMUL8:
  2252                          ;     PUSH HL
  2253                          ;     PUSH DE
  2254                          ;     PUSH BC
  2255                          ;     LD E, A
  2256                          ;     LD A, B
  2257                          ;     LD H, A
  2258                          ;     LD D,0
  2259                          ;     LD L,D
  2260                          ;     LD B,8
  2261                          ; CPCVIDEOMUL8L1:
  2262                          ;     ADD HL, HL
  2263                          ;     JR NC, CPCVIDEOMUL8L1A
  2264                          ;     ADD HL, DE
  2265                          ; CPCVIDEOMUL8L1A:
  2266                          ;     DJNZ CPCVIDEOMUL8L1
  2267                          ;     LD A, L
  2268                          ;     POP BC
  2269                          ;     POP DE
  2270                          ;     POP HL
  2271                          ;     RET
  2272                          CPCVIDEOMUL82:
  2273  07ff  e5                	PUSH HL
  2274  0800  c5                	PUSH BC
  2275  0801  f5                	PUSH AF
  2276  0802  78                	LD A, B
  2277  0803  e602              	AND $2
  2278  0805  fe00              	CP $0
  2279  0807  2809              	JR Z, CPCVIDEOMUL82L0
  2280                          CPCVIDEOMUL82L1:
  2281  0809  f1                	POP AF
  2282  080a  f5                	PUSH AF
  2283  080b  e60f              	AND $F
  2284  080d  6f                	LD L, A
  2285  080e  f1                	POP AF
  2286  080f  c31508            	JP CPCVIDEOMUL82H
  2287                          CPCVIDEOMUL82L0:
  2288                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2289                          ;    LD A, 0
  2290  0812  af                	XOR A
  2291  0813  6f                	LD L, A
  2292  0814  f1                	POP AF
  2293                          CPCVIDEOMUL82H:
  2294  0815  f5                	PUSH AF
  2295  0816  78                	LD A, B
  2296  0817  e601              	AND $1
  2297  0819  fe00              	CP $0
  2298  081b  280f              	JR Z, CPCVIDEOMUL82H0
  2299                          CPCVIDEOMUL82H1:
  2300  081d  f1                	POP AF
  2301  081e  f5                	PUSH AF
  2302  081f  cb27              	SLA A
  2303  0821  cb27              	SLA A
  2304  0823  cb27              	SLA A
  2305  0825  cb27              	SLA A
  2306  0827  67                	LD H, A
  2307  0828  f1                	POP AF
  2308  0829  c32f08            	JP CPCVIDEOMUL82E
  2309                          CPCVIDEOMUL82H0:
  2310                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2311                          ;    LD A, 0
  2312  082c  af                	XOR A
  2313  082d  67                	LD H, A
  2314  082e  f1                	POP AF
  2315                          CPCVIDEOMUL82E:
  2316  082f  c1                	POP BC
  2317  0830  7c                	LD A, H
  2318  0831  b5                	OR L
  2319  0832  e1                	POP HL
  2320  0833  c9                	RET
  2321                          CPCVIDEOMUL84:
  2322  0834  e5                	PUSH HL
  2323  0835  c5                	PUSH BC
  2324  0836  f5                	PUSH AF
  2325  0837  78                	LD A, B
  2326  0838  e601              	AND $1
  2327  083a  fe00              	CP $0
  2328  083c  2815              	JR Z, CPCVIDEOMUL84L0
  2329                          CPCVIDEOMUL84L1:
  2330  083e  f1                	POP AF
  2331  083f  f5                	PUSH AF
  2332  0840  e603              	AND $3
  2333  0842  cb27              	SLA A
  2334  0844  cb27              	SLA A
  2335  0846  cb27              	SLA A
  2336  0848  cb27              	SLA A
  2337  084a  cb27              	SLA A
  2338  084c  cb27              	SLA A
  2339  084e  6f                	LD L, A
  2340  084f  f1                	POP AF
  2341  0850  c35608            	JP CPCVIDEOMUL84H
  2342                          CPCVIDEOMUL84L0:
  2343                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2344                          ;    LD A, 0
  2345  0853  af                	XOR A
  2346  0854  6f                	LD L, A
  2347  0855  f1                	POP AF
  2348                          CPCVIDEOMUL84H:
  2349  0856  f5                	PUSH AF
  2350  0857  78                	LD A, B
  2351  0858  e602              	AND $2
  2352  085a  fe00              	CP $0
  2353  085c  280e              	JR Z, CPCVIDEOMUL84H0
  2354                          CPCVIDEOMUL84H1:
  2355  085e  f1                	POP AF
  2356  085f  f5                	PUSH AF
  2357  0860  e603              	AND $3
  2358  0862  cb27              	SLA A
  2359  0864  cb27              	SLA A
  2360  0866  b5                	OR L
  2361  0867  6f                	LD L, A
  2362  0868  f1                	POP AF
  2363  0869  c36d08            	JP CPCVIDEOMUL84I
  2364                          CPCVIDEOMUL84H0:
  2365  086c  f1                	POP AF
  2366                          CPCVIDEOMUL84I:
  2367  086d  f5                	PUSH AF
  2368  086e  78                	LD A, B
  2369  086f  e604              	AND $4
  2370  0871  fe00              	CP $0
  2371  0873  2812              	JR Z, CPCVIDEOMUL84I0
  2372                          CPCVIDEOMUL84I1:
  2373  0875  f1                	POP AF
  2374  0876  f5                	PUSH AF
  2375  0877  e603              	AND $3
  2376  0879  cb27              	SLA A
  2377  087b  cb27              	SLA A
  2378  087d  cb27              	SLA A
  2379  087f  cb27              	SLA A
  2380  0881  b5                	OR L
  2381  0882  6f                	LD L, A
  2382  0883  f1                	POP AF
  2383  0884  c38808            	JP CPCVIDEOMUL84J
  2384                          CPCVIDEOMUL84I0:
  2385  0887  f1                	POP AF
  2386                          CPCVIDEOMUL84J:
  2387  0888  f5                	PUSH AF
  2388  0889  78                	LD A, B
  2389  088a  e608              	AND $8
  2390  088c  fe00              	CP $0
  2391  088e  280a              	JR Z, CPCVIDEOMUL84J0
  2392                          CPCVIDEOMUL84J1:
  2393  0890  f1                	POP AF
  2394  0891  f5                	PUSH AF
  2395  0892  e603              	AND $3
  2396  0894  b5                	OR L
  2397  0895  6f                	LD L, A
  2398  0896  f1                	POP AF
  2399  0897  c39b08            	JP CPCVIDEOMUL84K
  2400                          CPCVIDEOMUL84J0:
  2401  089a  f1                	POP AF
  2402                          CPCVIDEOMUL84K:
  2403  089b  c1                	POP BC
  2404  089c  7d                	LD A, L
  2405  089d  e1                	POP HL
  2406  089e  c9                	RET
  2407                          CPCVIDEOPOS:
  2408  089f  d5                	PUSH DE
  2409  08a0  21d105            	LD HL, PLOTVBASE
  2410  08a3  5a                	LD E, D
  2411  08a4  1600              	LD D, 0
  2412  08a6  19                	ADD HL, DE
  2413  08a7  19                	ADD HL, DE
  2414  08a8  7e                	LD A, (HL)
  2415  08a9  5f                	LD E, A
  2416  08aa  23                	INC HL
  2417  08ab  7e                	LD A, (HL)
  2418  08ac  57                	LD D, A
  2419  08ad  626b              	LD HL, DE
  2420  08af  d1                	POP DE
  2421  08b0  3ac10c            	LD A, (CURRENTMODE)
  2422  08b3  fe00              	CP 0
  2423  08b5  280d              	JR Z, CPCVIDEOPOS0
  2424  08b7  fe01              	CP 1
  2425  08b9  2811              	JR Z, CPCVIDEOPOS1
  2426  08bb  fe02              	CP 2
  2427  08bd  281c              	JR Z, CPCVIDEOPOS2
  2428  08bf  fe03              	CP 3
  2429  08c1  2809              	JR Z, CPCVIDEOPOS3
  2430  08c3  c9                	RET
  2431                          CPCVIDEOPOS0:
  2432  08c4  d5                	PUSH DE
  2433  08c5  cb3b              	SRL E
  2434                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2435                          ;    LD A, 0
  2436  08c7  af                	XOR A
  2437  08c8  57                	LD D, A
  2438  08c9  19                	ADD HL, DE
  2439  08ca  d1                	POP DE
  2440  08cb  c9                	RET
  2441                          CPCVIDEOPOS1:
  2442                          CPCVIDEOPOS3:
  2443  08cc  d5                	PUSH DE
  2444  08cd  dd7d              	LD A, IXL
  2445  08cf  57                	LD D, A
  2446  08d0  cb3a              	SRL D
  2447  08d2  cb1b              	RR E
  2448  08d4  cb3a              	SRL D
  2449  08d6  cb1b              	RR E
  2450  08d8  19                	ADD HL, DE
  2451  08d9  d1                	POP DE
  2452  08da  c9                	RET
  2453                          CPCVIDEOPOS2:
  2454  08db  d5                	PUSH DE
  2455  08dc  dd7d              	LD A, IXL
  2456  08de  57                	LD D, A
  2457  08df  cb3a              	SRL D
  2458  08e1  cb1b              	RR E
  2459  08e3  cb3a              	SRL D
  2460  08e5  cb1b              	RR E
  2461  08e7  cb3a              	SRL D
  2462  08e9  cb1b              	RR E
  2463  08eb  19                	ADD HL, DE
  2464  08ec  d1                	POP DE
  2465  08ed  c9                	RET
  2466                          CPCVIDEOBITMASK1:
  2467  08ee  00112233          	DB $00,$11,$22,$33
  2468  08f2  44556677          	DB $44,$55,$66,$77
  2469  08f6  8899aabb          	DB $88,$99,$aa,$bb
  2470  08fa  ccddeeff          	DB $cc,$dd,$ee,$ff
  2471                          CPCVIDEOBITMASK2:
  2472  08fe  88442211          	DB $88,$44,$22,$11
  2473                          CPCVIDEOBITMASK4:
  2474  0902  80402010          	DB $80,$40,$20,$10
  2475  0906  08040201          	DB $08,$04,$02,$01
  2476                          cpcvarsGraphic_after:
  2477  090a  c3410c            	jp putimage_after
  2478                          ; /*****************************************************************************
  2479                          ;  * ugBASIC - an isomorphic BASIC language compiler for retrocomputers        *
  2480                          ;  *****************************************************************************
  2481                          ;  * Copyright 2021-2023 Marco Spedaletti (asimov@mclink.it)
  2482                          ;  *
  2483                          ;  * Licensed under the Apache License, Version 2.0 (the "License");
  2484                          ;  * you may not use this file except in compliance with the License.
  2485                          ;  * You may obtain a copy of the License at
  2486                          ;  *
  2487                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  2488                          ;  *
  2489                          ;  * Unless required by applicable law or agreed to in writing, software
  2490                          ;  * distributed under the License is distributed on an "AS IS" BASIS,
  2491                          ;  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  2492                          ;  * See the License for the specific language governing permissions and
  2493                          ;  * limitations under the License.
  2494                          ;  *----------------------------------------------------------------------------
  2495                          ;  * Concesso in licenza secondo i termini della Licenza Apache, versione 2.0
  2496                          ;  * (la "Licenza"); è proibito usare questo file se non in conformità alla
  2497                          ;  * Licenza. Una copia della Licenza è disponibile all'indirizzo:
  2498                          ;  *
  2499                          ;  * http://www.apache.org/licenses/LICENSE-2.0
  2500                          ;  *
  2501                          ;  * Se non richiesto dalla legislazione vigente o concordato per iscritto,
  2502                          ;  * il software distribuito nei termini della Licenza è distribuito
  2503                          ;  * "COSì COM'è", SENZA GARANZIE O CONDIZIONI DI ALCUN TIPO, esplicite o
  2504                          ;  * implicite. Consultare la Licenza per il testo specifico che regola le
  2505                          ;  * autorizzazioni e le limitazioni previste dalla medesima.
  2506                          ;  ****************************************************************************/
  2507                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  2508                          ;*                                                                             *
  2509                          ;*                          IMAGES ROUTINE FOR CPC                             *
  2510                          ;*                                                                             *
  2511                          ;*                             by Marco Spedaletti                             *
  2512                          ;*                                                                             *
  2513                          ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  2514                          ; PUT an IMAGE on the screen.
  2515                          ;
  2516                          ; input:
  2517                          ;       IXL:E           -> x
  2518                          ;       D               -> y
  2519                          ;       HL              -> start of bitmap data
  2520                          ;       IMAGET + IMAGEF ->  various flags
  2521                          PUTIMAGE:
  2522                              ; Skip if in TILE MODE
  2523  090d  3ac20c            	LD A, (CURRENTTILEMODE)
  2524  0910  fe01              	CP 1
  2525  0912  c8                	RET Z
  2526                              ; Retrieve the width (in pixel) and height (in pixel),
  2527                              ;   IXH:C -> WIDTH
  2528                              ;   B -> HEIGHT
  2529                          
  2530  0913  4e                	LD C, (HL)
  2531  0914  23                	INC HL
  2532  0915  7e                	LD A, (HL)
  2533  0916  dd67              	LD IXH, A
  2534  0918  23                	INC HL
  2535  0919  46                	LD B, (HL)
  2536  091a  23                	INC HL
  2537                              ; Save IMAGEY
  2538  091b  7a                	LD A, D
  2539  091c  32f50c            	LD (IMAGEY), A
  2540                              ; Decrement the y position in order to calculate
  2541                              ; correctly the position on the first loop.
  2542  091f  15                	DEC D
  2543                              ; Dispatch the execution to the proper
  2544                              ; function.
  2545  0920  d5                	PUSH DE
  2546  0921  3ac10c            	LD A, (CURRENTMODE)
  2547  0924  fe00              	CP 0
  2548  0926  ca3a09            	JP Z, PUTIMAGE0
  2549  0929  fe01              	CP 1
  2550  092b  ca050a            	JP Z, PUTIMAGE1
  2551  092e  fe02              	CP 2
  2552  0930  ca140b            	JP Z, PUTIMAGE2
  2553  0933  fe03              	CP 3
  2554  0935  ca3a09            	JP Z, PUTIMAGE3
  2555  0938  d1                	POP DE
  2556  0939  c9                	RET
  2557                              ; ------------------------------------------------------------------------
  2558                              ; --- MODE 0 & 3
  2559                              ; ------------------------------------------------------------------------
  2560                          PUTIMAGE0:
  2561                          PUTIMAGE3:
  2562                              ; Halves the width of the image to draw, since each byte keep two pixels.
  2563  093a  cb39              	SRL C
  2564                          PUTIMAGE0L2:
  2565                              ; Move ahead of one row.
  2566  093c  d1                	POP DE
  2567  093d  14                	INC D
  2568  093e  d5                	PUSH DE
  2569                              ; Recalculate the starting position on the video buffer.
  2570  093f  e5                	PUSH HL
  2571  0940  cd9f08            	CALL CPCVIDEOPOS
  2572  0943  545d              	LD DE, HL
  2573  0945  e1                	POP HL
  2574                              ; Row copy loop.
  2575  0946  c5                	PUSH BC
  2576                          PUTIMAGE0L1:
  2577                              ; Manage the "WITH TRANSPARENCY" flag.
  2578  0947  3ae00c            	LD A, (IMAGEF)
  2579  094a  e620              	AND $20
  2580  094c  fe20              	CP $20
  2581  094e  ca5609            	JP Z, PUTIMAGE0L1T
  2582                              ; Copy the bitmap data from the memory to the video.
  2583                              ; This is a direct copy.
  2584  0951  7e                	LD A, (HL)
  2585  0952  12                	LD (DE),A
  2586                              ; Jump to the end of the loop.
  2587  0953  c38509            	JP PUTIMAGE0L1T0
  2588                              ; Copy the bitmap data from the memory to the video.
  2589                              ; This is a copy that support the transparency.
  2590                          PUTIMAGE0L1T:
  2591  0956  dde5              	PUSH IX
  2592  0958  c5                	PUSH BC
  2593                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2594                          ;    LD A, 0
  2595  0959  af                	XOR A
  2596  095a  dd67              	LD IXH, A
  2597  095c  7e                	LD A, (HL)
  2598  095d  e6aa              	AND $AA
  2599  095f  fe00              	CP $0
  2600  0961  2806              	JR Z, PUTIMAGE0L1T2
  2601  0963  dd7c              	LD A, IXH
  2602  0965  f6aa              	OR $AA
  2603  0967  dd67              	LD IXH, A
  2604                          PUTIMAGE0L1T2:
  2605  0969  7e                	LD A, (HL)
  2606  096a  e655              	AND $55
  2607  096c  fe00              	CP $0
  2608  096e  2806              	JR Z, PUTIMAGE0L1T3
  2609  0970  dd7c              	LD A, IXH
  2610  0972  f655              	OR $55
  2611  0974  dd67              	LD IXH, A
  2612                          PUTIMAGE0L1T3:
  2613  0976  dd7c              	LD A, IXH
  2614                          ; peephole(1): r319 (XOR $FF)->(CPL)
  2615                          ;    XOR $FF
  2616  0978  2f                	CPL
  2617  0979  47                	LD B, A
  2618  097a  1a                	LD A, (DE)
  2619  097b  a0                	AND B
  2620  097c  47                	LD B, A
  2621  097d  7e                	LD A, (HL)
  2622  097e  dda4              	AND IXH
  2623  0980  b0                	ORA B
  2624  0981  12                	LD (DE),A
  2625  0982  c1                	POP BC
  2626  0983  dde1              	POP IX
  2627                          PUTIMAGE0L1T0:
  2628                              ; This is the end of the row copy loop.
  2629                              ; Move to the next source and destination byte.
  2630  0985  13                	INC DE
  2631  0986  23                	INC HL
  2632                              ; Decrement the number of byte to copy.
  2633                              ; Repeat until finished.
  2634  0987  0d                	DEC C
  2635  0988  20bd              	JR NZ, PUTIMAGE0L1
  2636                          PUTIMAGE0DONEROW:
  2637                              ; The copy of the row has been completed.
  2638                          
  2639  098a  c1                	POP BC
  2640                              ; Check (and manage) if a "DOUBLE" flag has been requested.
  2641  098b  3ae00c            	LD A, (IMAGEF)
  2642  098e  e641              	AND $41
  2643  0990  fe41              	CP $41
  2644  0992  2817              	JR Z, PUTIMAGE0DONEROW2
  2645  0994  e640              	AND $40
  2646  0996  fe40              	CP $40
  2647  0998  2011              	JR NZ, PUTIMAGE0DONEROW2
  2648  099a  f601              	OR $01
  2649  099c  32e00c            	LD (IMAGEF), A
  2650                              ; Move back of width pixels, to repeat the line for
  2651                              ; the DOUBLE flag support.
  2652  099f  d5                	PUSH DE
  2653  09a0  79                	LD A, C
  2654  09a1  5f                	LD E, A
  2655                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2656                          ;    LD A, 0
  2657  09a2  af                	XOR A
  2658  09a3  57                	LD D, A
  2659  09a4  a7                	AND A
  2660  09a5  ed52              	SBC HL, DE
  2661  09a7  d1                	POP DE
  2662  09a8  c33c09            	JP PUTIMAGE0L2 ; Repeat the row copy.
  2663                              ; Disable if a "DOUBLE" flag has been requested.
  2664                          PUTIMAGE0DONEROW2:
  2665  09ab  3ae00c            	LD A, (IMAGEF)
  2666  09ae  e6fe              	AND $FE
  2667  09b0  32e00c            	LD (IMAGEF), A
  2668                              ; Increment the vertical position
  2669  09b3  c5                	PUSH BC
  2670  09b4  3af50c            	LD A, (IMAGEY)
  2671  09b7  c601              	ADD $1
  2672  09b9  32f50c            	LD (IMAGEY), A
  2673  09bc  47                	LD B, A
  2674  09bd  3ab00c            	LD A, (CURRENTHEIGHT)
  2675  09c0  b8                	CP B
  2676  09c1  c1                	POP BC
  2677  09c2  2807              	JR Z, PUTIMAGE0L2A
  2678                              ; Decrement the number of rows last to copy.
  2679  09c4  05                	DEC B
  2680                              ; Repeat the copy for the next row.
  2681  09c5  c23c09            	JP NZ, PUTIMAGE0L2
  2682  09c8  c3d609            	JP PUTIMAGE0L2AX
  2683                          PUTIMAGE0L2A:
  2684  09cb  d5                	PUSH DE
  2685  09cc  79                	LD A, C
  2686  09cd  5f                	LD E, A
  2687  09ce  1600              	LD D, 0
  2688  09d0  19                	ADD HL, DE
  2689  09d1  d1                	POP DE
  2690  09d2  05                	DEC B
  2691  09d3  c2cb09            	JP NZ, PUTIMAGE0L2A
  2692                          PUTIMAGE0L2AX:
  2693                              ; Prepare to store the palette (16 colors)
  2694  09d6  3e10              	LD A, 16
  2695  09d8  47                	LD B, A
  2696                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2697                          ;    LD A, 0
  2698  09d9  af                	XOR A
  2699  09da  4f                	LD C, A
  2700                              ; Check if "WITH TRANSPARENCY" flag has been selected,
  2701                              ; so that the first index of the palette
  2702                              ; should not be changed.
  2703  09db  3ae00c            	LD A, (IMAGEF)
  2704  09de  e620              	AND $20
  2705  09e0  fe20              	CP $20
  2706  09e2  2002              	JR NZ, PUTIMAGE0DONEROWL1
  2707                              ; Skip the first color index
  2708  09e4  23                	INC HL
  2709  09e5  0c                	INC C
  2710                          PUTIMAGE0DONEROWL1:
  2711                              ; Check if "BITMAP" flag has been selected,
  2712                              ; so that the palette should not be touched
  2713  09e6  3ae10c            	LD A, (IMAGET)
  2714  09e9  e602              	AND $2
  2715  09eb  fe02              	CMP $2
  2716  09ed  2012              	JR NZ, PUTIMAGEC0DONE
  2717                          PUTIMAGE0DONEROWL1L:
  2718                              ; Loop to update the 16 colors of the palette.
  2719  09ef  7e                	LD A, (HL)
  2720  09f0  dd6f              	LD IXL, A
  2721  09f2  dd61              	LD IXH, C
  2722  09f4  fd2e01            	LD IYL, 1
  2723  09f7  cdc107            	CALL CPCUPDATEPALETTE
  2724  09fa  23                	INC HL
  2725  09fb  0c                	INC C
  2726  09fc  79                	LD A, C
  2727  09fd  fe10              	CP 16
  2728  09ff  20ee              	JR NZ, PUTIMAGE0DONEROWL1L
  2729                          PUTIMAGEC0DONE:
  2730                              ; The PUT IMAGE has finished!
  2731  0a01  d1                	POP DE
  2732  0a02  c3400c            	JP PUTIMAGEDONE
  2733                              ; ------------------------------------------------------------------------
  2734                              ; --- MODE 1
  2735                              ; ------------------------------------------------------------------------
  2736                          PUTIMAGE1:
  2737                              ; Subdivide the width of the image to draw, since each byte keep four pixels.
  2738  0a05  c5                	PUSH BC
  2739  0a06  dd7c              	LD A, IXH
  2740  0a08  47                	LD B, A
  2741  0a09  cb38              	SRL B
  2742  0a0b  cb19              	RR C
  2743  0a0d  cb38              	SRL B
  2744  0a0f  cb19              	RR C
  2745  0a11  79                	LD A, C
  2746  0a12  c1                	POP BC
  2747  0a13  4f                	LD C, A
  2748                          
  2749                          PUTIMAGE1L2:
  2750                              ; Move ahead of one row.
  2751  0a14  d1                	POP DE
  2752  0a15  14                	INC D
  2753  0a16  d5                	PUSH DE
  2754                              ; Recalculate the starting position on the video buffer.
  2755  0a17  e5                	PUSH HL
  2756  0a18  cd9f08            	CALL CPCVIDEOPOS
  2757  0a1b  545d              	LD DE, HL
  2758  0a1d  e1                	POP HL
  2759                              ; Row copy loop.
  2760  0a1e  c5                	PUSH BC
  2761                          PUTIMAGE1L1:
  2762                              ; Manage the "WITH TRANSPARENCY" flag.
  2763  0a1f  3ae00c            	LD A, (IMAGEF)
  2764  0a22  e620              	AND $20
  2765  0a24  fe20              	CP $20
  2766  0a26  ca2e0a            	JP Z, PUTIMAGE1L1T
  2767                              ; Copy the bitmap data from the memory to the video.
  2768                              ; This is a direct copy.
  2769  0a29  7e                	LD A, (HL)
  2770  0a2a  12                	LD (DE),A
  2771                              ; Jump to the end of the loop.
  2772  0a2b  c3770a            	JP PUTIMAGE1L1T0
  2773                              ; Copy the bitmap data from the memory to the video.
  2774                              ; This is a copy that support the transparency.
  2775                          PUTIMAGE1L1T:
  2776  0a2e  dde5              	PUSH IX
  2777  0a30  c5                	PUSH BC
  2778                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2779                          ;    LD A, 0
  2780  0a31  af                	XOR A
  2781  0a32  dd67              	LD IXH, A
  2782  0a34  7e                	LD A, (HL)
  2783  0a35  e688              	AND $88
  2784  0a37  fe00              	CP $0
  2785  0a39  2806              	JR Z, PUTIMAGE1L1T2
  2786  0a3b  dd7c              	LD A, IXH
  2787  0a3d  f688              	OR $88
  2788  0a3f  dd67              	LD IXH, A
  2789                          PUTIMAGE1L1T2:
  2790  0a41  7e                	LD A, (HL)
  2791  0a42  e644              	AND $44
  2792  0a44  fe00              	CP $0
  2793  0a46  2806              	JR Z, PUTIMAGE1L1T3
  2794  0a48  dd7c              	LD A, IXH
  2795  0a4a  f644              	OR $44
  2796  0a4c  dd67              	LD IXH, A
  2797                          PUTIMAGE1L1T3:
  2798  0a4e  7e                	LD A, (HL)
  2799  0a4f  e622              	AND $22
  2800  0a51  fe00              	CP $0
  2801  0a53  2806              	JR Z, PUTIMAGE1L1T4
  2802  0a55  dd7c              	LD A, IXH
  2803  0a57  f622              	OR $22
  2804  0a59  dd67              	LD IXH, A
  2805                          PUTIMAGE1L1T4:
  2806  0a5b  7e                	LD A, (HL)
  2807  0a5c  e611              	AND $11
  2808  0a5e  fe00              	CP $0
  2809  0a60  2806              	JR Z, PUTIMAGE1L1T5
  2810  0a62  dd7c              	LD A, IXH
  2811  0a64  f611              	OR $11
  2812  0a66  dd67              	LD IXH, A
  2813                          PUTIMAGE1L1T5:
  2814  0a68  dd7c              	LD A, IXH
  2815                          ; peephole(1): r319 (XOR $FF)->(CPL)
  2816                          ;    XOR $FF
  2817  0a6a  2f                	CPL
  2818  0a6b  47                	LD B, A
  2819  0a6c  1a                	LD A, (DE)
  2820  0a6d  a0                	AND B
  2821  0a6e  47                	LD B, A
  2822  0a6f  7e                	LD A, (HL)
  2823  0a70  dda4              	AND IXH
  2824  0a72  b0                	ORA B
  2825  0a73  12                	LD (DE),A
  2826  0a74  c1                	POP BC
  2827  0a75  dde1              	POP IX
  2828                          PUTIMAGE1L1T0:
  2829                              ; This is the end of the row copy loop.
  2830                              ; Move to the next source and destination byte.
  2831  0a77  13                	INC DE
  2832  0a78  23                	INC HL
  2833                              ; Decrement the number of byte to copy.
  2834                              ; Repeat until finished.
  2835  0a79  0d                	DEC C
  2836  0a7a  c21f0a            	JP NZ, PUTIMAGE1L1
  2837                              ; TODO: actually, up to 255 pixels images width are supported.
  2838                              ; TODO: this is the point where to change the behaviour.
  2839                              ; LD A, IXH
  2840                              ; CP $0
  2841                              ; JR Z, PUTIMAGE1DONEROW
  2842                              ; DEC IXH
  2843                              ; LD A, $FF
  2844                              ; LD C, A
  2845                              ; JP PUTIMAGE1L1
  2846                          PUTIMAGE1DONEROW:
  2847                              ; The copy of the row has been completed.
  2848  0a7d  c1                	POP BC
  2849                              ; Check (and manage) if a "DOUBLE" flag has been requested.
  2850  0a7e  3ae00c            	LD A, (IMAGEF)
  2851  0a81  e641              	AND $41
  2852  0a83  fe41              	CP $41
  2853  0a85  ca9f0a            	JP Z, PUTIMAGE1DONEROW2
  2854  0a88  e640              	AND $40
  2855  0a8a  fe40              	CP $40
  2856  0a8c  2011              	JR NZ, PUTIMAGE1DONEROW2
  2857  0a8e  f601              	OR $01
  2858  0a90  32e00c            	LD (IMAGEF), A
  2859                              ; Move back of width pixels, to repeat the line for
  2860                              ; the DOUBLE flag support.
  2861  0a93  d5                	PUSH DE
  2862  0a94  79                	LD A, C
  2863  0a95  5f                	LD E, A
  2864                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2865                          ;    LD A, 0
  2866  0a96  af                	XOR A
  2867  0a97  57                	LD D, A
  2868  0a98  a7                	AND A
  2869  0a99  ed52              	SBC HL, DE
  2870  0a9b  d1                	POP DE
  2871  0a9c  c33c09            	JP PUTIMAGE0L2 ; Repeat the row copy.
  2872                              ; Disable if a "DOUBLE" flag has been requested.
  2873                          PUTIMAGE1DONEROW2:
  2874  0a9f  3ae00c            	LD A, (IMAGEF)
  2875  0aa2  e6fe              	AND $FE
  2876  0aa4  32e00c            	LD (IMAGEF), A
  2877                              ; Increment the vertical position
  2878  0aa7  c5                	PUSH BC
  2879  0aa8  3af50c            	LD A, (IMAGEY)
  2880  0aab  c601              	ADD $1
  2881  0aad  32f50c            	LD (IMAGEY), A
  2882  0ab0  47                	LD B, A
  2883  0ab1  3ab00c            	LD A, (CURRENTHEIGHT)
  2884  0ab4  b8                	CP B
  2885  0ab5  c1                	POP BC
  2886  0ab6  2807              	JR Z, PUTIMAGE1L2A
  2887                              ; Decrement the number of rows last to copy.
  2888  0ab8  05                	DEC B
  2889                              ; Repeat the copy for the next row.
  2890  0ab9  c2140a            	JP NZ, PUTIMAGE1L2
  2891  0abc  c3ca0a            	JP PUTIMAGE1L2AX
  2892                          PUTIMAGE1L2A:
  2893  0abf  d5                	PUSH DE
  2894  0ac0  79                	LD A, C
  2895  0ac1  5f                	LD E, A
  2896  0ac2  1600              	LD D, 0
  2897  0ac4  19                	ADD HL, DE
  2898  0ac5  d1                	POP DE
  2899  0ac6  05                	DEC B
  2900  0ac7  c2bf0a            	JP NZ, PUTIMAGE1L2A
  2901                          PUTIMAGE1L2AX:
  2902                              ; Check if "WITH TRANSPARENCY" flag has been selected,
  2903                              ; so that the first index of the palette
  2904                              ; should not be changed.
  2905  0aca  3ae00c            	LD A, (IMAGEF)
  2906  0acd  e620              	AND $20
  2907  0acf  fe20              	CP $20
  2908  0ad1  cae00a            	JP Z, PUTIMAGE1DONEROW2T
  2909                              ; Update the first color index
  2910  0ad4  7e                	LD A, (HL)
  2911  0ad5  dd6f              	LD IXL, A
  2912  0ad7  dd2600            	LD IXH, 0
  2913  0ada  fd2e01            	LD IYL, 1
  2914  0add  cdc107            	CALL CPCUPDATEPALETTE
  2915                          PUTIMAGE1DONEROW2T:
  2916                              ; Check if "BITMAP" flag has been selected,
  2917                              ; so that the palette should not be touched
  2918  0ae0  3ae10c            	LD A, (IMAGET)
  2919  0ae3  e602              	AND $2
  2920  0ae5  fe02              	CMP $2
  2921  0ae7  2027              	JR NZ, PUTIMAGEC1DONE
  2922                              ; Skip the first index since we already changed it.
  2923                              ; Update color #1
  2924  0ae9  23                	INC HL
  2925  0aea  7e                	LD A, (HL)
  2926  0aeb  dd6f              	LD IXL, A
  2927  0aed  dd2601            	LD IXH, 1
  2928  0af0  fd2e01            	LD IYL, 1
  2929  0af3  cdc107            	CALL CPCUPDATEPALETTE
  2930                              ; Update color #2
  2931  0af6  23                	INC HL
  2932  0af7  7e                	LD A, (HL)
  2933  0af8  dd6f              	LD IXL, A
  2934  0afa  dd2602            	LD IXH, 2
  2935  0afd  fd2e01            	LD IYL, 1
  2936  0b00  cdc107            	CALL CPCUPDATEPALETTE
  2937                              ; Update color #3
  2938  0b03  23                	INC HL
  2939  0b04  7e                	LD A, (HL)
  2940  0b05  dd6f              	LD IXL, A
  2941  0b07  dd2603            	LD IXH, 3
  2942  0b0a  fd2e01            	LD IYL, 1
  2943  0b0d  cdc107            	CALL CPCUPDATEPALETTE
  2944                          PUTIMAGEC1DONE:
  2945                              ; The PUT IMAGE has finished!
  2946  0b10  d1                	POP DE
  2947  0b11  c3400c            	JP PUTIMAGEDONE
  2948                              ; ------------------------------------------------------------------------
  2949                              ; --- MODE 2
  2950                              ; ------------------------------------------------------------------------
  2951                          PUTIMAGE2:
  2952                              ; Subdivide the width of the image to draw, since each byte keep eight pixels.
  2953  0b14  c5                	PUSH BC
  2954  0b15  dd7c              	LD A, IXH
  2955  0b17  47                	LD B, A
  2956  0b18  cb38              	SRL B
  2957  0b1a  cb19              	RR C
  2958  0b1c  cb38              	SRL B
  2959  0b1e  cb19              	RR C
  2960  0b20  cb38              	SRL B
  2961  0b22  cb19              	RR C
  2962  0b24  79                	LD A, C
  2963  0b25  c1                	POP BC
  2964  0b26  4f                	LD C, A
  2965                          PUTIMAGE2L2:
  2966                              ; Move ahead of one row.
  2967  0b27  d1                	POP DE
  2968  0b28  14                	INC D
  2969  0b29  d5                	PUSH DE
  2970                              ; Recalculate the starting position on the video buffer.
  2971  0b2a  e5                	PUSH HL
  2972  0b2b  cd9f08            	CALL CPCVIDEOPOS
  2973  0b2e  545d              	LD DE, HL
  2974  0b30  e1                	POP HL
  2975                              ; Row copy loop.
  2976  0b31  c5                	PUSH BC
  2977                          PUTIMAGE2L1:
  2978                              ; Manage the "WITH TRANSPARENCY" flag.
  2979  0b32  3ae00c            	LD A, (IMAGEF)
  2980  0b35  e620              	AND $20
  2981  0b37  fe20              	CP $20
  2982  0b39  ca410b            	JP Z, PUTIMAGE2L1T
  2983                              ; Copy the bitmap data from the memory to the video.
  2984                              ; This is a direct copy.
  2985                          
  2986  0b3c  7e                	LD A, (HL)
  2987  0b3d  12                	LD (DE),A
  2988                              ; Jump to the end of the loop.
  2989  0b3e  c3be0b            	JP PUTIMAGE2L1T0
  2990                              ; Copy the bitmap data from the memory to the video.
  2991                              ; This is a copy that support the transparency.
  2992                          PUTIMAGE2L1T:
  2993  0b41  dde5              	PUSH IX
  2994  0b43  c5                	PUSH BC
  2995                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  2996                          ;    LD A, 0
  2997  0b44  af                	XOR A
  2998  0b45  dd67              	LD IXH, A
  2999  0b47  7e                	LD A, (HL)
  3000  0b48  e680              	AND $80
  3001  0b4a  fe00              	CP $0
  3002  0b4c  2806              	JR Z, PUTIMAGE2L1T2
  3003  0b4e  dd7c              	LD A, IXH
  3004  0b50  f680              	OR $80
  3005  0b52  dd67              	LD IXH, A
  3006                          PUTIMAGE2L1T2:
  3007  0b54  7e                	LD A, (HL)
  3008  0b55  e640              	AND $40
  3009  0b57  fe00              	CP $0
  3010  0b59  2806              	JR Z, PUTIMAGE2L1T3
  3011  0b5b  dd7c              	LD A, IXH
  3012  0b5d  f640              	OR $40
  3013  0b5f  dd67              	LD IXH, A
  3014                          PUTIMAGE2L1T3:
  3015  0b61  7e                	LD A, (HL)
  3016  0b62  e620              	AND $20
  3017  0b64  fe00              	CP $0
  3018  0b66  2806              	JR Z, PUTIMAGE2L1T4
  3019  0b68  dd7c              	LD A, IXH
  3020  0b6a  f620              	OR $20
  3021  0b6c  dd67              	LD IXH, A
  3022                          PUTIMAGE2L1T4:
  3023  0b6e  7e                	LD A, (HL)
  3024  0b6f  e610              	AND $10
  3025  0b71  fe00              	CP $0
  3026  0b73  2806              	JR Z, PUTIMAGE2L1T5
  3027  0b75  dd7c              	LD A, IXH
  3028  0b77  f610              	OR $10
  3029  0b79  dd67              	LD IXH, A
  3030                          PUTIMAGE2L1T5:
  3031  0b7b  7e                	LD A, (HL)
  3032  0b7c  e608              	AND $08
  3033  0b7e  fe00              	CP $0
  3034  0b80  2806              	JR Z, PUTIMAGE2L1T6
  3035  0b82  dd7c              	LD A, IXH
  3036  0b84  f608              	OR $08
  3037  0b86  dd67              	LD IXH, A
  3038                          PUTIMAGE2L1T6:
  3039  0b88  7e                	LD A, (HL)
  3040  0b89  e604              	AND $04
  3041  0b8b  fe00              	CP $0
  3042  0b8d  2806              	JR Z, PUTIMAGE2L1T7
  3043  0b8f  dd7c              	LD A, IXH
  3044  0b91  f604              	OR $04
  3045  0b93  dd67              	LD IXH, A
  3046                          PUTIMAGE2L1T7:
  3047  0b95  7e                	LD A, (HL)
  3048  0b96  e602              	AND $02
  3049  0b98  fe00              	CP $0
  3050  0b9a  2806              	JR Z, PUTIMAGE2L1T8
  3051  0b9c  dd7c              	LD A, IXH
  3052  0b9e  f602              	OR $02
  3053  0ba0  dd67              	LD IXH, A
  3054                          PUTIMAGE2L1T8:
  3055  0ba2  7e                	LD A, (HL)
  3056  0ba3  e601              	AND $01
  3057  0ba5  fe00              	CP $0
  3058  0ba7  2806              	JR Z, PUTIMAGE2L1T9
  3059  0ba9  dd7c              	LD A, IXH
  3060  0bab  f601              	OR $01
  3061  0bad  dd67              	LD IXH, A
  3062                          PUTIMAGE2L1T9:
  3063  0baf  dd7c              	LD A, IXH
  3064                          ; peephole(1): r319 (XOR $FF)->(CPL)
  3065                          ;    XOR $FF
  3066  0bb1  2f                	CPL
  3067  0bb2  47                	LD B, A
  3068  0bb3  1a                	LD A, (DE)
  3069  0bb4  a0                	AND B
  3070  0bb5  47                	LD B, A
  3071  0bb6  7e                	LD A, (HL)
  3072  0bb7  dda4              	AND IXH
  3073  0bb9  b0                	ORA B
  3074                              ; Draw them
  3075  0bba  12                	LD (DE),A
  3076  0bbb  c1                	POP BC
  3077  0bbc  dde1              	POP IX
  3078                          PUTIMAGE2L1T0:
  3079                              ; This is the end of the row copy loop.
  3080                              ; Move to the next source and destination byte.
  3081  0bbe  13                	INC DE
  3082  0bbf  23                	INC HL
  3083                              ; Decrement the number of byte to copy.
  3084                              ; Repeat until finished.
  3085  0bc0  0d                	DEC C
  3086  0bc1  c2320b            	JP NZ, PUTIMAGE2L1
  3087                              ; TODO: actually, up to 255 pixels images width are supported.
  3088                              ; TODO: this is the point where to change the behaviour.
  3089                              ; LD A, IXH
  3090                              ; CP $0
  3091                              ; JR Z, PUTIMAGE2DONEROW
  3092                              ; DEC IXH
  3093                              ; LD A, $FF
  3094                              ; LD C, A
  3095                              ; JP PUTIMAGE2L1
  3096                          PUTIMAGE2DONEROW:
  3097                              ; The copy of the row has been completed.
  3098  0bc4  c1                	POP BC
  3099                              ; Check (and manage) if a "DOUBLE" flag has been requested.
  3100  0bc5  3ae00c            	LD A, (IMAGEF)
  3101  0bc8  e641              	AND $41
  3102  0bca  fe41              	CP $41
  3103  0bcc  2817              	JR Z, PUTIMAGE2DONEROW2
  3104  0bce  e640              	AND $40
  3105  0bd0  fe40              	CP $40
  3106  0bd2  2011              	JR NZ, PUTIMAGE2DONEROW2
  3107  0bd4  f601              	OR $01
  3108  0bd6  32e00c            	LD (IMAGEF), A
  3109                              ; Move back of width pixels, to repeat the line for
  3110                              ; the DOUBLE flag support.
  3111  0bd9  d5                	PUSH DE
  3112  0bda  79                	LD A, C
  3113  0bdb  5f                	LD E, A
  3114                          ; peephole(1): r228 (LD A, 0)->(XOR A)
  3115                          ;    LD A, 0
  3116  0bdc  af                	XOR A
  3117  0bdd  57                	LD D, A
  3118  0bde  a7                	AND A
  3119  0bdf  ed52              	SBC HL, DE
  3120  0be1  d1                	POP DE
  3121  0be2  c33c09            	JP PUTIMAGE0L2 ; Repeat the row copy.
  3122                              ; Disable if a "DOUBLE" flag has been requested.
  3123                          PUTIMAGE2DONEROW2:
  3124  0be5  3ae00c            	LD A, (IMAGEF)
  3125  0be8  e6fe              	AND $FE
  3126  0bea  32e00c            	LD (IMAGEF), A
  3127                              ; Increment the vertical position
  3128  0bed  c5                	PUSH BC
  3129  0bee  3af50c            	LD A, (IMAGEY)
  3130  0bf1  c601              	ADD $1
  3131  0bf3  32f50c            	LD (IMAGEY), A
  3132  0bf6  47                	LD B, A
  3133  0bf7  3ab00c            	LD A, (CURRENTHEIGHT)
  3134  0bfa  b8                	CP B
  3135  0bfb  c1                	POP BC
  3136  0bfc  2807              	JR Z, PUTIMAGE2L2A
  3137                              ; Decrement the number of rows last to copy.
  3138  0bfe  05                	DEC B
  3139                              ; Repeat the copy for the next row.
  3140  0bff  c2270b            	JP NZ, PUTIMAGE2L2
  3141  0c02  c3100c            	JP PUTIMAGE2L2X
  3142                          PUTIMAGE2L2A:
  3143  0c05  d5                	PUSH DE
  3144  0c06  79                	LD A, C
  3145  0c07  5f                	LD E, A
  3146  0c08  1600              	LD D, 0
  3147  0c0a  19                	ADD HL, DE
  3148  0c0b  d1                	POP DE
  3149  0c0c  05                	DEC B
  3150  0c0d  c2050c            	JP NZ, PUTIMAGE2L2A
  3151                          PUTIMAGE2L2X:
  3152                              ; Check if "WITH TRANSPARENCY" flag has been selected,
  3153                              ; so that the first index of the palette
  3154                              ; should not be changed.
  3155  0c10  3ae10c            	LD A, (IMAGET)
  3156  0c13  e602              	AND $2
  3157  0c15  fe02              	CMP $2
  3158  0c17  2023              	JR NZ, PUTIMAGEC2DONE
  3159                              ; Check if "BITMAP" flag has been selected,
  3160                              ; so that the palette should not be touched
  3161  0c19  3ae00c            	LD A, (IMAGEF)
  3162  0c1c  e620              	AND $20
  3163  0c1e  fe20              	CP $20
  3164  0c20  ca2f0c            	JP Z, PUTIMAGE2DONEROW2T
  3165                              ; Update the first color index
  3166  0c23  7e                	LD A, (HL)
  3167  0c24  dd6f              	LD IXL, A
  3168  0c26  dd2600            	LD IXH, 0
  3169  0c29  fd2e01            	LD IYL, 1
  3170  0c2c  cdc107            	CALL CPCUPDATEPALETTE
  3171                          PUTIMAGE2DONEROW2T:
  3172                              ; Update the second color index
  3173  0c2f  23                	INC HL
  3174  0c30  7e                	LD A, (HL)
  3175  0c31  dd6f              	LD IXL, A
  3176  0c33  dd2601            	LD IXH, 1
  3177  0c36  fd2e01            	LD IYL, 1
  3178  0c39  cdc107            	CALL CPCUPDATEPALETTE
  3179                          PUTIMAGEC2DONE:
  3180                              ; The PUT IMAGE has finished!
  3181  0c3c  d1                	POP DE
  3182  0c3d  c3400c            	JP PUTIMAGEDONE
  3183                          PUTIMAGEDONE:
  3184  0c40  c9                	RET
  3185                          putimage_after:
  3186  0c41  210c0d            	LD HL, _plancheSprite
  3187  0c44  3a4613            	LD A, (_Ttmp11)
  3188  0c47  5f                	LD E, A
  3189  0c48  3a4713            	LD A, (_Ttmp11+1)
  3190  0c4b  dd6f              	LD IXL, A
  3191  0c4d  3a6113            	LD A, (_Ttmp24)
  3192  0c50  57                	LD D, A
  3193  0c51  3e20              	LD A, $20
  3194  0c53  32e00c            	LD (IMAGEF), A
  3195  0c56  3e02              	LD A, $02
  3196  0c58  32e10c            	LD (IMAGET), A
  3197  0c5b  cd0d09            	CALL PUTIMAGE
  3198  0c5e  3e00              	LD A, $00
  3199                          ; peephole(3): unread
  3200                          ;	LD (XGR), A
  3201                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3202                          ;	LD A, $00
  3203                          ; peephole(3): unread
  3204                          ;	LD (XGR+1), A
  3205  0c60  3a4413            	LD A, (_Ttmp3)
  3206                          ; peephole(3): unread
  3207                          ;	LD (XGR), A
  3208                          ; peephole(4): r407 (LD A, *; LD A, *)->(LD, A)
  3209                          ;	LD A, $00
  3210                          ; peephole(3): unread
  3211                          ;	LD (YGR), A
  3212                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3213                          ;	LD A, $00
  3214                          ; peephole(3): unread
  3215                          ;	LD (YGR+1), A
  3216  0c63  3a6013            	LD A, (_Ttmp23)
  3217                          ; peephole(3): unread
  3218                          ;	LD (YGR), A
  3219                          	; P:1556
  3220                          	; L:12
  3221                          	; P:0
  3222                          	; L:13
  3223                          	; P:0
  3224                          	; L:14
  3225                          	; P:0
  3226                          _label46:
  3227  0c66  c3660c            	jp _label46
  3228  0c69  1800eda0eda0eda0  DUFFDEVICEL0: db 24,0,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,237,160,234,0,0,	201
              eda0eda0eda0eda0  
              eda0eda0eda0eda0  
              eda0eda0eda0eda0  
              eda0ea0000c9      
  3229  0c8f  0000              	DUFFDEVICEL1: defs 2
  3230  0c91  00                	EVERYSTATUS: defs 1
  3231  0c92  0000              	BITMAPADDRESS: defs 2
  3232  0c94  0000              	COLORMAPADDRESS: defs 2
  3233                          ; peephole(3): unread
  3234                          ;	TEXTADDRESS: defs 2
  3235  0c96  0000              	TILESADDRESS: defs 2
  3236  0c98  00                	EMPTYTILE: db 0
  3237  0c99  00                	USING: defs 1
  3238  0c9a  0000              	COPYOFBITMAPADDRESS: defs 2
  3239  0c9c  0000              	COPYOFCOLORMAPADDRESS: defs 2
  3240  0c9e  0000              	COPYOFTEXTADDRESS: defs 2
  3241  0ca0  0000              	COPYOFTILESADDRESS: defs 2
  3242  0ca2  0000              	CPCTIMER: defs 2
  3243  0ca4  000000            	IRQVECTOR: defs 3
  3244  0ca7  00                	IRQVECTORREADY: defs 1
  3245  0ca8  00                	TICKSPERSECOND: defs 1
  3246  0ca9  00                	KBDCHAR: defs 1
  3247  0caa  00                	KBDRATE: defs 1
  3248  0cab  00                	KBDDELAY: defs 1
  3249  0cac  00                	KBDRATEC: defs 1
  3250  0cad  00                	KBDDELAYC: defs 1
  3251  0cae  0000              	CURRENTWIDTH: defs 2
  3252  0cb0  0000              	CURRENTHEIGHT: defs 2
  3253                          ; peephole(3): unread
  3254                          ;	CURRENTTILES: defs 1
  3255                          ; peephole(3): unread
  3256                          ;	CURRENTTILESWIDTH: defs 1
  3257                          ; peephole(3): unread
  3258                          ;	CURRENTTILESHEIGHT: defs 1
  3259                          ; peephole(3): unread
  3260                          ;	FONTWIDTH: defs 1
  3261                          ; peephole(3): unread
  3262                          ;	FONTHEIGHT: defs 1
  3263  0cb2  00                	PALETTELIMIT: defs 1
  3264                          ; peephole(3): unread
  3265                          ;	XGR: defs 2
  3266                          ; peephole(3): unread
  3267                          ;	YGR: defs 2
  3268  0cb3  0000              	LINE: defs 2
  3269                          ; peephole(3): unread
  3270                          ;	CLIPX1: defs 2
  3271                          ; peephole(3): unread
  3272                          ;	CLIPX2: defs 2
  3273                          ; peephole(3): unread
  3274                          ;	CLIPY1: defs 2
  3275                          ; peephole(3): unread
  3276                          ;	CLIPY2: defs 2
  3277  0cb5  0000              	ORIGINX: defs 2
  3278  0cb7  0000              	ORIGINY: defs 2
  3279  0cb9  0000              	RESOLUTIONX: defs 2
  3280  0cbb  0000              	RESOLUTIONY: defs 2
  3281                          ; peephole(3): unread
  3282                          ;	XCURSYS: defs 1
  3283                          ; peephole(3): unread
  3284                          ;	YCURSYS: defs 1
  3285  0cbd  00                	TABCOUNT: defs 1
  3286  0cbe  00                	CLINEX: defs 1
  3287  0cbf  00                	CLINEY: defs 1
  3288  0cc0  00                	TABSTODRAW: defs 1
  3289  0cc1  00                	CURRENTMODE: defs 1
  3290  0cc2  00                	CURRENTTILEMODE: defs 1
  3291  0cc3  00                	SPRITECOUNT: db 0
  3292                          	SPRITEXY: defs 0
  3293  0cc4  00                	TILEX: defs 1
  3294  0cc5  00                	TILEY: defs 1
  3295  0cc6  00                	TILEX2: defs 1
  3296  0cc7  00                	TILET: defs 1
  3297  0cc8  00                	TILEW: defs 1
  3298  0cc9  00                	TILEH: defs 1
  3299  0cca  00                	TILEW2: defs 1
  3300  0ccb  00                	TILEH2: defs 1
  3301  0ccc  00                	TILEA: defs 1
  3302  0ccd  0000              	TILEO: defs 2
  3303  0ccf  00                	XSCROLLPOS: defs 1
  3304  0cd0  00                	YSCROLLPOS: defs 1
  3305  0cd1  00                	XSCROLL: defs 1
  3306  0cd2  00                	YSCROLL: defs 1
  3307  0cd3  00                	DIRECTION: defs 1
  3308  0cd4  000000            	ONSCROLLUP: defs 3
  3309  0cd7  000000            	ONSCROLLDOWN: defs 3
  3310  0cda  000000            	ONSCROLLLEFT: defs 3
  3311  0cdd  000000            	ONSCROLLRIGHT: defs 3
  3312  0ce0  00                	IMAGEF: defs 1
  3313  0ce1  00                	IMAGET: defs 1
  3314  0ce2  00                	CPCTIMER2: defs 1
  3315  0ce3  00                	EVERYCOUNTER: defs 1
  3316  0ce4  00                	EVERYTIMING: defs 1
  3317  0ce5  0000000000000000  	FPSCRAP: defs 16
              0000000000000000  
  3318  0cf5  00                	IMAGEY: defs 1
  3319  0cf6  0000              	SLICEX: defs 2
  3320  0cf8  0000              	SLICEY: defs 2
  3321  0cfa  0000              	SLICEDTARGET: defs 2
  3322  0cfc  00                	GAVALUE: defs 1
  3323  0cfd  00                	AY8910MUSICREADY: defs 1
  3324  0cfe  00                	AY8910BLOCKS: defs 1
  3325  0cff  00                	AY8910LASTBLOCK: defs 1
  3326  0d00  0000              	AY8910TMPPTR2: defs 2
  3327  0d02  0000              	AY8910TMPPTR: defs 2
  3328  0d04  00                	AY8910TMPOFS: defs 1
  3329  0d05  00                	AY8910TMPLEN: defs 1
  3330  0d06  00                	AY8910JIFFIES: defs 1
  3331                          ; peephole(3): unread
  3332                          ;	_PEN: defs 1
  3333                          ; peephole(3): unread
  3334                          ;	_PAPER: defs 1
  3335                          ; peephole(3): unread
  3336                          ;	_windowE: defs 1
  3337                          ; peephole(3): unread
  3338                          ;	_windowS: defs 1
  3339                          ; peephole(3): unread
  3340                          ;	_windowW: defs 1
  3341                          ; peephole(3): unread
  3342                          ;	TEXTWW: defs 1
  3343                          	_TAB: EQU cstring0
  3344                          ; peephole(3): unread
  3345                          ;	_windowMX: defs 1
  3346                          ; peephole(3): unread
  3347                          ;	_windowMY: defs 1
  3348  0d07  00                	PROTOTHREADCT: defs 1
  3349  0d08  00000000          	CPURANDOM_SEED: defs 4
  3350                          	_boom: defs 0
  3351                          	_ciel: defs 0
  3352  0d0c  4000310000000000  _plancheSprite: db 64,0,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,64,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,128,64,0,128,64,0,128,128,64,0,0,0,128,0,0,0,64,0,128,64,0,128,64,0,128,0,128,0,128,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,64,0,0,64,0,0,64,0,64,0,0,128,0,0,0,0,0,64,64,192,192,192,192,128,128,0,0,64,0,0,0,128,0,0,128,0,64,0,0,0,0,0,0,0,64,64,0,192,192,128,128,0,0,0,0,192,204,0,0,0,0,0,128,0,0,0,0,0,0,0,64,0,128,64,0,64,0,192,192,0,0,0,0,0,0,192,192,128,0,0,128,0,128,0,0,0,64,0,0,128,0,128,0,0,128,192,192,192,192,0,0,0,0,0,0,64,192,128,0,0,0,0,0,0,0,0,0,128,0,0,128,0,0,192,192,192,64,0,0,0,0,0,0,0,0,0,192,128,0,0,0,64,0,0,64,0,64,0,0,0,0,0,0,128,192,128,0,0,0,0,0,0,0,0,0,0,64,192,128,0,0,0,0,0,128,0,0,0,0,0,0,64,0,0,0,196,192,0,0,0,0,0,0,0,0,0,64,64,128,0,0,0,0,64,0,0,0,0,0,128,0,64,0,0,128,0,196,196,192,0,0,0,0,0,0,128,192,192,200,128,128,0,0,64,0,0,0,0,0,0,0,0,64,0,0,0,0,64,200,200,136,0,0,4,0,0,192,200,200,200,128,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,128,0,0,192,200,200,128,0,0,12,12,72,200,200,200,132,192,0,64,0,128,0,0,64,0,0,64,0,64,0,0,0,0,64,64,200,200,200,0,0,12,12,12,196,196,196,192,72,0,0,0,0,0,64,0,0,0,0,0,0,0,0,64,0,0,0,68,200,200,200,0,4,12,12,72,196,196,196,140,12,128,128,0,0,0,0,0,0,128,0,0,0,0,128,0,0,128,0,200,200,200,200,0,4,12,12,76,200,200,200,132,12,128,0,64,0,0,0,0,0,0,128,64,0,0,0,0,0,0,64,196,196,196,192,0,12,12,12,72,200,200,200,132,12,64,0,0,0,64,0,128,0,0,0,0,0,0,64,0,128,0,64,200,204,196,192,4,12,12,12,72,200,200,200,132,12,64,128,0,128,0,0,0,0,0,0,0,0,128,0,0,64,0,68,200,200,200,136,4,12,12,12,76,196,196,196,12,12,0,128,0,0,0,0,0,128,64,0,64,0,0,0,0,0,0,192,200,200,200,136,4,12,12,12,72,200,200,200,132,12,0,192,0,0,128,128,0,0,0,0,0,0,64,0,128,0,0,192,200,200,200,128,4,12,12,12,72,200,200,200,132,12,8,64,128,0,196,200,0,0,0,64,0,0,0,0,0,128,0,196,196,196,196,128,4,12,12,12,72,200,200,204,132,12,8,64,0,196,192,136,0,128,0,0,64,0,64,0,0,64,0,192,200,204,196,128,4,12,12,12,72,200,200,200,140,12,12,0,196,196,204,128,0,0,128,0,0,0,0,0,0,0,64,196,196,196,196,128,4,12,12,12,12,200,200,200,200,12,12,72,128,200,196,128,0,0,0,128,0,0,0,0,128,0,192,68,196,204,196,128,4,12,12,12,72,196,196,196,196,12,12,8,64,196,196,128,64,0,0,0,64,0,64,64,64,192,12,68,196,204,200,128,4,12,12,12,12,196,196,196,196,132,12,8,68,196,196,0,0,0,0,64,0,0,64,64,128,12,8,68,196,192,204,128,4,12,12,12,12,196,196,196,196,132,12,12,68,196,196,128,0,64,0,0,0,0,68,128,0,8,8,192,200,204,196,192,0,12,12,12,12,196,196,200,200,140,12,12,192,200,204,0,64,0,0,0,64,0,64,196,192,0,0,68,196,196,196,192,4,12,12,12,12,192,200,200,200,140,12,12,68,196,196,128,0,0,64,0,0,0,0,192,192,192,128,64,200,200,200,200,0,12,12,12,12,196,196,196,196,132,12,12,192,200,200,0,0,64,0,0,0,0,0,0,0,0,192,192,196,196,196,192,0,12,12,12,12,196,196,196,196,140,12,72,192,200,204,64,0,0,0,128,64,0,0,0,64,0,0,192,200,200,200,200,128,4,12,12,12,192,204,196,196,132,12,72,68,196,196,128,0,0,0,0,0,0,0,128,0,0,0,192,200,200,200,200,128,4,12,12,12,76,196,196,196,132,12,72,0,196,196,128,0,64,0,0,0,0,0,0,0,128,0,64,200,204,196,196,128,0,12,12,12,192,200,200,200,132,12,72,0,64,192,128,128,0,0,128,64,0,0,128,0,0,128,0,200,200,200,200,136,0,12,12,12,192,200,200,204,140,12,72,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,128,196,196,196,196,192,0,4,12,12,76,196,196,192,192,12,128,0,0,0,0,64,0,128,0,64,0,0,0,0,128,0,0,64,204,196,196,196,0,0,4,12,72,196,196,204,200,12,128,128,0,64,0,0,0,0,128,0,0,0,128,0,0,0,0,0,196,196,196,196,128,0,0,0,0,200,200,192,200,12,128,0,64,0,0,0,0,0,0,0,128,0,0,0,64,0,128,0,0,196,200,200,200,192,128,0,0,196,196,200,204,132,192,0,0,0,0,128,64,0,128,0,0,0,64,0,0,0,0,0,64,0,196,200,204,200,136,0,0,64,196,196,192,200,8,0,0,64,0,0,0,0,0,0,0,0,0,128,0,128,0,128,0,0,0,192,204,196,192,0,0,0,68,196,200,200,200,64,0,0,0,64,0,0,128,64,0,0,0,0,128,0,0,0,64,0,0,0,64,204,196,192,192,192,192,200,200,200,136,0,0,0,128,0,0,0,0,0,0,64,0,0,0,128,64,0,0,64,0,0,0,64,192,0,0,0,128,64,192,204,200,0,128,0,0,0,0,128,0,64,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,64,0,0,0,0,0,0,128,0,0,0,64,0,128,0,128,0,0,0,0,128,0,64,0,0,64,0,64,0,128,64,0,0,0,128,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,64,0,0,128,0,0,0,0,64,0,0,0,0,64,0,128,0,128,64,0,0,64,0,128,0,0,128,0,0,128,64,0,0,0,0,0,0,128,64,0,0,0,128,64,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,64,0,0,0,0,0,128,0,64,0,0,0,0,128,0,0,0,64,0,128,0,128,64,0,0,0,0,0,64,0,128,0,0,0,64,0,128,11,0,3,20,255,255,255,255,255,255,255,255,255,255,255,	255
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              0000000000000000  
              8000400040000000  
              0000000000000000  
              0000004000804000  
              8040008080400000  
              0080000000400080  
              4000804000800080  
              0080000000000000  
              0000000000004000  
              0000008000000000  
              0000000000000000  
              0000000000004000  
              0040000040000040  
              0040000080000000  
              00004040c0c0c0c0  
              8080000040000000  
              8000008000400000  
              0000000000404000  
              c0c0808000000000  
              c0cc000000000080  
              0000000000000040  
              008040004000c0c0  
              000000000000c0c0  
              8000008000800000  
              0040000080008000  
              0080c0c0c0c00000  
              0000000040c08000  
              0000000000000000  
              800000800000c0c0  
              c040000000000000  
              000000c080000000  
              4000004000400000  
              0000000080c08000  
              0000000000000000  
              0040c08000000000  
              0080000000000000  
              40000000c4c00000  
              0000000000000040  
              4080000000004000  
              0000000080004000  
              008000c4c4c00000  
              0000000080c0c0c8  
              8080000040000000  
              0000000000400000  
              000040c8c8880000  
              040000c0c8c8c880  
              0000000000000000  
              4000000000000080  
              0000c0c8c8800000  
              0c0c48c8c8c884c0  
              0040008000004000  
              0040004000000000  
              4040c8c8c800000c  
              0c0cc4c4c4c04800  
              0000000040000000  
              0000000000400000  
              0044c8c8c800040c  
              0c48c4c4c48c0c80  
              8000000000000080  
              0000000080000080  
              00c8c8c8c800040c  
              0c4cc8c8c8840c80  
              0040000000000000  
              8040000000000000  
              40c4c4c4c0000c0c  
              0c48c8c8c8840c40  
              0000004000800000  
              0000000040008000  
              40c8ccc4c0040c0c  
              0c48c8c8c8840c40  
              8000800000000000  
              0000008000004000  
              44c8c8c888040c0c  
              0c4cc4c4c40c0c00  
              8000000000008040  
              0040000000000000  
              c0c8c8c888040c0c  
              0c48c8c8c8840c00  
              c000008080000000  
              0000004000800000  
              c0c8c8c880040c0c  
              0c48c8c8c8840c08  
              408000c4c8000000  
              4000000000008000  
              c4c4c4c480040c0c  
              0c48c8c8cc840c08  
              4000c4c088008000  
              0040004000004000  
              c0c8ccc480040c0c  
              0c48c8c8c88c0c0c  
              00c4c4cc80000080  
              0000000000000040  
              c4c4c4c480040c0c  
              0c0cc8c8c8c80c0c  
              4880c8c480000000  
              80000000008000c0  
              44c4ccc480040c0c  
              0c48c4c4c4c40c0c  
              0840c4c480400000  
              004000404040c00c  
              44c4ccc880040c0c  
              0c0cc4c4c4c4840c  
              0844c4c400000000  
              4000004040800c08  
              44c4c0cc80040c0c  
              0c0cc4c4c4c4840c  
              0c44c4c480004000  
              0000004480000808  
              c0c8ccc4c0000c0c  
              0c0cc4c4c8c88c0c  
              0cc0c8cc00400000  
              00400040c4c00000  
              44c4c4c4c0040c0c  
              0c0cc0c8c8c88c0c  
              0c44c4c480000040  
              00000000c0c0c080  
              40c8c8c8c8000c0c  
              0c0cc4c4c4c4840c  
              0cc0c8c800004000  
              00000000000000c0  
              c0c4c4c4c0000c0c  
              0c0cc4c4c4c48c0c  
              48c0c8cc40000000  
              8040000000400000  
              c0c8c8c8c880040c  
              0c0cc0ccc4c4840c  
              4844c4c480000000  
              0000000080000000  
              c0c8c8c8c880040c  
              0c0c4cc4c4c4840c  
              4800c4c480004000  
              0000000000008000  
              40c8ccc4c480000c  
              0c0cc0c8c8c8840c  
              480040c080800000  
              8040000080000080  
              00c8c8c8c888000c  
              0c0cc0c8c8cc8c0c  
              4800000000000000  
              0000000000800000  
              80c4c4c4c4c00004  
              0c0c4cc4c4c0c00c  
              8000000000400080  
              0040000000008000  
              0040ccc4c4c40000  
              040c48c4c4ccc80c  
              8080004000000000  
              8000000080000000  
              0000c4c4c4c48000  
              000000c8c8c0c80c  
              8000400000000000  
              0000800000004000  
              800000c4c8c8c8c0  
              800000c4c4c8cc84  
              c000000000804000  
              8000000040000000  
              00004000c4c8ccc8  
              88000040c4c4c0c8  
              0800004000000000  
              0000000000800080  
              0080000000c0ccc4  
              c000000044c4c8c8  
              c840000000400000  
              8040000000008000  
              00004000000040cc  
              c4c0c0c0c0c8c8c8  
              8800000080000000  
              0000004000000080  
              4000004000000040  
              c00000008040c0cc  
              c800800000000080  
              0040000000000000  
              0040000000000000  
              0040000000000000  
              8000000040008000  
              8000000000800040  
              0000400040008040  
              0000008000000000  
              0000008000000000  
              0000004000008000  
              0000004000000000  
              4000800080400000  
              4000800000800000  
              8040000000000000  
              8040000000804000  
              0000000000004000  
              0000000000004000  
              0000000080004000  
              0000008000000040  
              0080008040000000  
              0000400080000000  
              4000800b000314ff  
              ffffffffffffffff  
              ffffff            
  3353  133f  00                	defs 1
  3354  1340  0000              	_Ttmp1: defs 2
  3355  1342  0000              	_Ttmp2: defs 2
  3356  1344  00                	_Ttmp3: defs 1
  3357                          ; peephole(3): unread
  3358                          ;	_Ttmp4: defs 1
  3359                          ; peephole(3): unread
  3360                          ;	_Ttmp5: defs 1
  3361                          ; peephole(3): unread
  3362                          ;	_Ttmp7: defs 1
  3363  1345  00                	_Ttmp8: defs 1
  3364                          	_Timg9: defs 0
  3365  1346  0000              	_Ttmp11: defs 2
  3366  1348  0000              	_Ttmp12: defs 2
  3367  134a  0000              	_Ttmp14: defs 2
  3368  134c  00000000          	_Tflt15: defs 4
  3369  1350  00000000          	_Tflt16: defs 4
  3370                          ; peephole(3): unread
  3371                          ;	_Ttmp17: defs 1
  3372  1354  00000000          	_Tflt18: defs 4
  3373                          ; peephole(3): unread
  3374                          ;	_Ttmp19: defs 1
  3375  1358  00000000          	_Tflt20: defs 4
  3376  135c  00000000          	_Tflt21: defs 4
  3377                          ; peephole(3): unread
  3378                          ;	_Ttmp22: defs 1
  3379  1360  00                	_Ttmp23: defs 1
  3380  1361  0000              	_Ttmp24: defs 2
  3381  1363  0000              	_Ttmp25: defs 2
  3382                          ; peephole(3): unread
  3383                          ;	_Ttmp26: defs 1
  3384                          ; peephole(3): unread
  3385                          ;	_Ttmp27: defs 1
  3386  1365  0000              	_Ttmp29: defs 2
  3387  1367  00000000          	_Tflt30: defs 4
  3388                          ; peephole(3): unread
  3389                          ;	_Ttmp31: defs 1
  3390  136b  00000000          	_Tflt32: defs 4
  3391                          ; peephole(3): unread
  3392                          ;	_Ttmp33: defs 1
  3393  136f  00000000          	_Tflt34: defs 4
  3394                          ; peephole(3): unread
  3395                          ;	_Ttmp35: defs 1
  3396  1373  00000000          	_Tflt36: defs 4
  3397  1377  00000000          	_Tflt37: defs 4
  3398                          ; peephole(3): unread
  3399                          ;	_Ttmp38: defs 1
  3400                          ; peephole(3): unread
  3401                          ;	_Ttmp40: defs 1
  3402                          ; peephole(3): unread
  3403                          ;	_Ttmp41: defs 1
  3404                          ; peephole(3): unread
  3405                          ;	_Ttmp43: defs 1
  3406                          ; peephole(3): unread
  3407                          ;	_Ttmp44: defs 1
  3408  137b  00                	defs 1
  3409  137c  00                	defs 1
  3410                          VARINIT:
  3411  137d  3e00              	LD A, $00
  3412  137f  328f0c            	LD (DUFFDEVICEL1), A
  3413                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3414                          ;	LD A, $00
  3415  1382  32900c            	LD (DUFFDEVICEL1+1), A
  3416  1385  3e00              	LD A, $00
  3417  1387  32910c            	LD (EVERYSTATUS), A
  3418                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3419                          ;	LD A, $00
  3420  138a  32920c            	LD (BITMAPADDRESS), A
  3421  138d  3ec0              	LD A, $c0
  3422  138f  32930c            	LD (BITMAPADDRESS+1), A
  3423  1392  3e00              	LD A, $00
  3424  1394  32940c            	LD (COLORMAPADDRESS), A
  3425  1397  3ec0              	LD A, $c0
  3426  1399  32950c            	LD (COLORMAPADDRESS+1), A
  3427  139c  3e00              	LD A, $00
  3428                          ; peephole(3): unread
  3429                          ;	LD (TEXTADDRESS), A
  3430  139e  3ec0              	LD A, $c0
  3431                          ; peephole(3): unread
  3432                          ;	LD (TEXTADDRESS+1), A
  3433                          ; peephole(4): r407 (LD A, *; LD A, *)->(LD, A)
  3434                          ;	LD A, $00
  3435  13a0  32960c            	LD (TILESADDRESS), A
  3436                          ; peephole(5): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3437                          ;	LD A, $c0
  3438  13a3  32970c            	LD (TILESADDRESS+1), A
  3439  13a6  3e20              	LD A, $20
  3440  13a8  32980c            	LD (EMPTYTILE), A
  3441  13ab  3e00              	LD A, $00
  3442  13ad  32990c            	LD (USING), A
  3443                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3444                          ;	LD A, $00
  3445  13b0  329a0c            	LD (COPYOFBITMAPADDRESS), A
  3446  13b3  3ec0              	LD A, $c0
  3447  13b5  329b0c            	LD (COPYOFBITMAPADDRESS+1), A
  3448  13b8  3e00              	LD A, $00
  3449  13ba  329c0c            	LD (COPYOFCOLORMAPADDRESS), A
  3450  13bd  3ec0              	LD A, $c0
  3451  13bf  329d0c            	LD (COPYOFCOLORMAPADDRESS+1), A
  3452  13c2  3e00              	LD A, $00
  3453  13c4  329e0c            	LD (COPYOFTEXTADDRESS), A
  3454  13c7  3ec0              	LD A, $c0
  3455  13c9  329f0c            	LD (COPYOFTEXTADDRESS+1), A
  3456  13cc  3e00              	LD A, $00
  3457  13ce  32a00c            	LD (COPYOFTILESADDRESS), A
  3458  13d1  3ec0              	LD A, $c0
  3459  13d3  32a10c            	LD (COPYOFTILESADDRESS+1), A
  3460  13d6  3e00              	LD A, $00
  3461  13d8  32a20c            	LD (CPCTIMER), A
  3462                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3463                          ;	LD A, $00
  3464  13db  32a30c            	LD (CPCTIMER+1), A
  3465  13de  3e00              	LD A, $00
  3466  13e0  32a70c            	LD (IRQVECTORREADY), A
  3467                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3468                          ;	LD A, $00
  3469  13e3  32a80c            	LD (TICKSPERSECOND), A
  3470  13e6  3e00              	LD A, $00
  3471  13e8  32a90c            	LD (KBDCHAR), A
  3472  13eb  3e10              	LD A, $10
  3473  13ed  32aa0c            	LD (KBDRATE), A
  3474                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3475                          ;	LD A, $10
  3476  13f0  32ab0c            	LD (KBDDELAY), A
  3477  13f3  3e10              	LD A, $10
  3478  13f5  32ac0c            	LD (KBDRATEC), A
  3479                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3480                          ;	LD A, $10
  3481  13f8  32ad0c            	LD (KBDDELAYC), A
  3482  13fb  3ea0              	LD A, $a0
  3483  13fd  32ae0c            	LD (CURRENTWIDTH), A
  3484  1400  3e00              	LD A, $00
  3485  1402  32af0c            	LD (CURRENTWIDTH+1), A
  3486  1405  3ec8              	LD A, $c8
  3487  1407  32b00c            	LD (CURRENTHEIGHT), A
  3488  140a  3e00              	LD A, $00
  3489  140c  32b10c            	LD (CURRENTHEIGHT+1), A
  3490  140f  3eff              	LD A, $ff
  3491                          ; peephole(3): unread
  3492                          ;	LD (CURRENTTILES), A
  3493  1411  3e14              	LD A, $14
  3494                          ; peephole(3): unread
  3495                          ;	LD (CURRENTTILESWIDTH), A
  3496  1413  3e19              	LD A, $19
  3497                          ; peephole(3): unread
  3498                          ;	LD (CURRENTTILESHEIGHT), A
  3499  1415  3e08              	LD A, $08
  3500                          ; peephole(3): unread
  3501                          ;	LD (FONTWIDTH), A
  3502                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3503                          ;	LD A, $08
  3504                          ; peephole(3): unread
  3505                          ;	LD (FONTHEIGHT), A
  3506  1417  3e10              	LD A, $10
  3507  1419  32b20c            	LD (PALETTELIMIT), A
  3508  141c  3e00              	LD A, $00
  3509                          ; peephole(3): unread
  3510                          ;	LD (XGR), A
  3511                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3512                          ;	LD A, $00
  3513                          ; peephole(3): unread
  3514                          ;	LD (XGR+1), A
  3515  141e  3e00              	LD A, $00
  3516                          ; peephole(3): unread
  3517                          ;	LD (YGR), A
  3518                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3519                          ;	LD A, $00
  3520                          ; peephole(3): unread
  3521                          ;	LD (YGR+1), A
  3522  1420  3eff              	LD A, $ff
  3523  1422  32b30c            	LD (LINE), A
  3524                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3525                          ;	LD A, $ff
  3526  1425  32b40c            	LD (LINE+1), A
  3527  1428  3e00              	LD A, $00
  3528                          ; peephole(3): unread
  3529                          ;	LD (CLIPX1), A
  3530                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3531                          ;	LD A, $00
  3532                          ; peephole(3): unread
  3533                          ;	LD (CLIPX1+1), A
  3534  142a  3eff              	LD A, $ff
  3535                          ; peephole(3): unread
  3536                          ;	LD (CLIPX2), A
  3537                          ; peephole(4): r407 (LD A, *; LD A, *)->(LD, A)
  3538                          ;	LD A, $00
  3539                          ; peephole(3): unread
  3540                          ;	LD (CLIPX2+1), A
  3541                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3542                          ;	LD A, $00
  3543                          ; peephole(3): unread
  3544                          ;	LD (CLIPY1), A
  3545                          ; peephole(5): r407 (LD A, *; LD A, *)->(LD, A)
  3546                          ;	LD A, $00
  3547                          ; peephole(3): unread
  3548                          ;	LD (CLIPY1+1), A
  3549  142c  3ebf              	LD A, $bf
  3550                          ; peephole(3): unread
  3551                          ;	LD (CLIPY2), A
  3552                          ; peephole(4): r407 (LD A, *; LD A, *)->(LD, A)
  3553                          ;	LD A, $00
  3554                          ; peephole(3): unread
  3555                          ;	LD (CLIPY2+1), A
  3556                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3557                          ;	LD A, $00
  3558  142e  32b50c            	LD (ORIGINX), A
  3559  1431  3e00              	LD A, $00
  3560  1433  32b60c            	LD (ORIGINX+1), A
  3561                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3562                          ;	LD A, $00
  3563  1436  32b70c            	LD (ORIGINY), A
  3564  1439  3e00              	LD A, $00
  3565  143b  32b80c            	LD (ORIGINY+1), A
  3566                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3567                          ;	LD A, $00
  3568  143e  32b90c            	LD (RESOLUTIONX), A
  3569  1441  3e00              	LD A, $00
  3570  1443  32ba0c            	LD (RESOLUTIONX+1), A
  3571                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3572                          ;	LD A, $00
  3573  1446  32bb0c            	LD (RESOLUTIONY), A
  3574  1449  3e00              	LD A, $00
  3575  144b  32bc0c            	LD (RESOLUTIONY+1), A
  3576                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3577                          ;	LD A, $00
  3578                          ; peephole(3): unread
  3579                          ;	LD (XCURSYS), A
  3580                          ; peephole(4): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3581                          ;	LD A, $00
  3582                          ; peephole(3): unread
  3583                          ;	LD (YCURSYS), A
  3584  144e  3e04              	LD A, $04
  3585  1450  32bd0c            	LD (TABCOUNT), A
  3586  1453  3e00              	LD A, $00
  3587  1455  32be0c            	LD (CLINEX), A
  3588                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3589                          ;	LD A, $00
  3590  1458  32bf0c            	LD (CLINEY), A
  3591  145b  3e00              	LD A, $00
  3592  145d  32c00c            	LD (TABSTODRAW), A
  3593  1460  3e02              	LD A, $02
  3594  1462  32c10c            	LD (CURRENTMODE), A
  3595  1465  3e01              	LD A, $01
  3596  1467  32c20c            	LD (CURRENTTILEMODE), A
  3597  146a  3e00              	LD A, $00
  3598  146c  32c40c            	LD (TILEX), A
  3599                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3600                          ;	LD A, $00
  3601  146f  32c50c            	LD (TILEY), A
  3602  1472  3e00              	LD A, $00
  3603  1474  32c60c            	LD (TILEX2), A
  3604                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3605                          ;	LD A, $00
  3606  1477  32c70c            	LD (TILET), A
  3607  147a  3e00              	LD A, $00
  3608  147c  32c80c            	LD (TILEW), A
  3609                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3610                          ;	LD A, $00
  3611  147f  32c90c            	LD (TILEH), A
  3612  1482  3e00              	LD A, $00
  3613  1484  32ca0c            	LD (TILEW2), A
  3614                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3615                          ;	LD A, $00
  3616  1487  32cb0c            	LD (TILEH2), A
  3617  148a  3e00              	LD A, $00
  3618  148c  32cc0c            	LD (TILEA), A
  3619                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3620                          ;	LD A, $00
  3621  148f  32cd0c            	LD (TILEO), A
  3622  1492  3e00              	LD A, $00
  3623  1494  32ce0c            	LD (TILEO+1), A
  3624                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3625                          ;	LD A, $00
  3626  1497  32cf0c            	LD (XSCROLLPOS), A
  3627  149a  3e00              	LD A, $00
  3628  149c  32d00c            	LD (YSCROLLPOS), A
  3629                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3630                          ;	LD A, $00
  3631  149f  32d10c            	LD (XSCROLL), A
  3632  14a2  3e00              	LD A, $00
  3633  14a4  32d20c            	LD (YSCROLL), A
  3634                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3635                          ;	LD A, $00
  3636  14a7  32d30c            	LD (DIRECTION), A
  3637  14aa  3e00              	LD A, $00
  3638  14ac  32e00c            	LD (IMAGEF), A
  3639                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3640                          ;	LD A, $00
  3641  14af  32e10c            	LD (IMAGET), A
  3642  14b2  3e06              	LD A, $06
  3643  14b4  32e20c            	LD (CPCTIMER2), A
  3644  14b7  3e00              	LD A, $00
  3645  14b9  32e30c            	LD (EVERYCOUNTER), A
  3646                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3647                          ;	LD A, $00
  3648  14bc  32e40c            	LD (EVERYTIMING), A
  3649  14bf  3e00              	LD A, $00
  3650  14c1  32f50c            	LD (IMAGEY), A
  3651                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3652                          ;	LD A, $00
  3653  14c4  32f60c            	LD (SLICEX), A
  3654  14c7  3e00              	LD A, $00
  3655  14c9  32f70c            	LD (SLICEX+1), A
  3656                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3657                          ;	LD A, $00
  3658  14cc  32f80c            	LD (SLICEY), A
  3659  14cf  3e00              	LD A, $00
  3660  14d1  32f90c            	LD (SLICEY+1), A
  3661                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3662                          ;	LD A, $00
  3663  14d4  32fa0c            	LD (SLICEDTARGET), A
  3664  14d7  3e00              	LD A, $00
  3665  14d9  32fb0c            	LD (SLICEDTARGET+1), A
  3666  14dc  3efc              	LD A, $fc
  3667  14de  32fc0c            	LD (GAVALUE), A
  3668  14e1  3e00              	LD A, $00
  3669  14e3  32fd0c            	LD (AY8910MUSICREADY), A
  3670                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3671                          ;	LD A, $00
  3672  14e6  32fe0c            	LD (AY8910BLOCKS), A
  3673  14e9  3e00              	LD A, $00
  3674  14eb  32ff0c            	LD (AY8910LASTBLOCK), A
  3675                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3676                          ;	LD A, $00
  3677  14ee  32000d            	LD (AY8910TMPPTR2), A
  3678  14f1  3e00              	LD A, $00
  3679  14f3  32010d            	LD (AY8910TMPPTR2+1), A
  3680                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3681                          ;	LD A, $00
  3682  14f6  32020d            	LD (AY8910TMPPTR), A
  3683  14f9  3e00              	LD A, $00
  3684  14fb  32030d            	LD (AY8910TMPPTR+1), A
  3685                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3686                          ;	LD A, $00
  3687  14fe  32040d            	LD (AY8910TMPOFS), A
  3688  1501  3e00              	LD A, $00
  3689  1503  32050d            	LD (AY8910TMPLEN), A
  3690                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3691                          ;	LD A, $00
  3692  1506  32060d            	LD (AY8910JIFFIES), A
  3693  1509  3e00              	LD A, $00
  3694                          ; peephole(3): unread
  3695                          ;	LD (_PEN), A
  3696  150b  3e14              	LD A, $14
  3697                          ; peephole(3): unread
  3698                          ;	LD (_PAPER), A
  3699                          ; peephole(4): r407 (LD A, *; LD A, *)->(LD, A)
  3700                          ;	LD A, $00
  3701                          ; peephole(3): unread
  3702                          ;	LD (_windowE), A
  3703                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3704                          ;	LD A, $00
  3705                          ; peephole(3): unread
  3706                          ;	LD (_windowS), A
  3707                          ; peephole(5): r407 (LD A, *; LD A, *)->(LD, A)
  3708                          ;	LD A, $00
  3709                          ; peephole(3): unread
  3710                          ;	LD (_windowW), A
  3711  150d  3e03              	LD A, $03
  3712                          ; peephole(3): unread
  3713                          ;	LD (TEXTWW), A
  3714                          ; peephole(4): r407 (LD A, *; LD A, *)->(LD, A)
  3715                          ;	LD A, $00
  3716                          ; peephole(3): unread
  3717                          ;	LD (_windowMX), A
  3718                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3719                          ;	LD A, $00
  3720                          ; peephole(3): unread
  3721                          ;	LD (_windowMY), A
  3722  150f  3e00              	LD A, $00
  3723  1511  32070d            	LD (PROTOTHREADCT), A
  3724  1514  3eff              	LD A, $ff
  3725  1516  32080d            	LD (CPURANDOM_SEED), A
  3726                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3727                          ;	LD A, $ff
  3728  1519  32090d            	LD (CPURANDOM_SEED+1), A
  3729  151c  3eff              	LD A, $ff
  3730  151e  320a0d            	LD (CPURANDOM_SEED+2), A
  3731                          ; peephole(1): r250 (LD A, x; LD (x), A; LD A, x)->(LD A, x; LD (x), A)
  3732                          ;	LD A, $ff
  3733  1521  320b0d            	LD (CPURANDOM_SEED+3), A
  3734  1524  c9                	RET
  3735  1525  0109              	cstring0: db 1, $09
  3736                          UDCCHAR:
  3737                          	; $00
  3738  1527  3c666e6e60623c00  DEFB $3c,$66,$6e,$6e,$60,$62,$3c,	$00
  3739                          	; $01
  3740  152f  00003c063e663e00  DEFB $00,$00,$3c,$06,$3e,$66,$3e,	$00
  3741                          	; $02
  3742  1537  0060607c66667c00  DEFB $00,$60,$60,$7c,$66,$66,$7c,	$00
  3743                          	; $03
  3744  153f  00003c6060603c00  DEFB $00,$00,$3c,$60,$60,$60,$3c,	$00
  3745                          	; $04
  3746  1547  0006063e66663e00  DEFB $00,$06,$06,$3e,$66,$66,$3e,	$00
  3747                          	; $05
  3748  154f  00003c667e603c00  DEFB $00,$00,$3c,$66,$7e,$60,$3c,	$00
  3749                          	; $06
  3750  1557  000e183e18181800  DEFB $00,$0e,$18,$3e,$18,$18,$18,	$00
  3751                          	; $07
  3752  155f  00003e66663e067c  DEFB $00,$00,$3e,$66,$66,$3e,$06,	$7c
  3753                          	; $08
  3754  1567  0060607c66666600  DEFB $00,$60,$60,$7c,$66,$66,$66,	$00
  3755                          	; $09
  3756  156f  0018003818183c00  DEFB $00,$18,$00,$38,$18,$18,$3c,	$00
  3757                          	; $0a
  3758  1577  000600060606063c  DEFB $00,$06,$00,$06,$06,$06,$06,	$3c
  3759                          	; $0b
  3760  157f  0060606c786c6600  DEFB $00,$60,$60,$6c,$78,$6c,$66,	$00
  3761                          	; $0c
  3762  1587  0038181818183c00  DEFB $00,$38,$18,$18,$18,$18,$3c,	$00
  3763                          	; $0d
  3764  158f  0000667f7f6b6300  DEFB $00,$00,$66,$7f,$7f,$6b,$63,	$00
  3765                          	; $0e
  3766  1597  00007c6666666600  DEFB $00,$00,$7c,$66,$66,$66,$66,	$00
  3767                          	; $0f
  3768  159f  00003c6666663c00  DEFB $00,$00,$3c,$66,$66,$66,$3c,	$00
  3769                          	; $10
  3770  15a7  00007c66667c6060  DEFB $00,$00,$7c,$66,$66,$7c,$60,	$60
  3771                          	; $11
  3772  15af  00003e66663e0606  DEFB $00,$00,$3e,$66,$66,$3e,$06,	$06
  3773                          	; $12
  3774  15b7  00007c6660606000  DEFB $00,$00,$7c,$66,$60,$60,$60,	$00
  3775                          	; $13
  3776  15bf  00003e603c067c00  DEFB $00,$00,$3e,$60,$3c,$06,$7c,	$00
  3777                          	; $14
  3778  15c7  00187e1818180e00  DEFB $00,$18,$7e,$18,$18,$18,$0e,	$00
  3779                          	; $15
  3780  15cf  0000666666663e00  DEFB $00,$00,$66,$66,$66,$66,$3e,	$00
  3781                          	; $16
  3782  15d7  00006666663c1800  DEFB $00,$00,$66,$66,$66,$3c,$18,	$00
  3783                          	; $17
  3784  15df  0000636b7f3e3600  DEFB $00,$00,$63,$6b,$7f,$3e,$36,	$00
  3785                          	; $18
  3786  15e7  0000663c183c6600  DEFB $00,$00,$66,$3c,$18,$3c,$66,	$00
  3787                          	; $19
  3788  15ef  00006666663e0c78  DEFB $00,$00,$66,$66,$66,$3e,$0c,	$78
  3789                          	; $1a
  3790  15f7  00007e0c18307e00  DEFB $00,$00,$7e,$0c,$18,$30,$7e,	$00
  3791                          	; $1b
  3792  15ff  3c30303030303c00  DEFB $3c,$30,$30,$30,$30,$30,$3c,	$00
  3793                          	; $1c
  3794  1607  0c12307c3062fc00  DEFB $0c,$12,$30,$7c,$30,$62,$fc,	$00
  3795                          	; $1d
  3796  160f  3c0c0c0c0c0c3c00  DEFB $3c,$0c,$0c,$0c,$0c,$0c,$3c,	$00
  3797                          	; $1e
  3798  1617  00183c7e18181818  DEFB $00,$18,$3c,$7e,$18,$18,$18,	$18
  3799                          	; $1f
  3800  161f  0010307f7f301000  DEFB $00,$10,$30,$7f,$7f,$30,$10,	$00
  3801                          	; $20
  3802  1627  0000000000000000  DEFB $00,$00,$00,$00,$00,$00,$00,	$00
  3803                          	; $21
  3804  162f  1818181800001800  DEFB $18,$18,$18,$18,$00,$00,$18,	$00
  3805                          	; $22
  3806  1637  6666660000000000  DEFB $66,$66,$66,$00,$00,$00,$00,	$00
  3807                          	; $23
  3808  163f  6666ff66ff666600  DEFB $66,$66,$ff,$66,$ff,$66,$66,	$00
  3809                          	; $24
  3810  1647  183e603c067c1800  DEFB $18,$3e,$60,$3c,$06,$7c,$18,	$00
  3811                          	; $25
  3812  164f  62660c1830664600  DEFB $62,$66,$0c,$18,$30,$66,$46,	$00
  3813                          	; $26
  3814  1657  3c663c3867663f00  DEFB $3c,$66,$3c,$38,$67,$66,$3f,	$00
  3815                          	; $27
  3816  165f  060c180000000000  DEFB $06,$0c,$18,$00,$00,$00,$00,	$00
  3817                          	; $28
  3818  1667  0c18303030180c00  DEFB $0c,$18,$30,$30,$30,$18,$0c,	$00
  3819                          	; $29
  3820  166f  30180c0c0c183000  DEFB $30,$18,$0c,$0c,$0c,$18,$30,	$00
  3821                          	; $2a
  3822  1677  00663cff3c660000  DEFB $00,$66,$3c,$ff,$3c,$66,$00,	$00
  3823                          	; $2b
  3824  167f  0018187e18180000  DEFB $00,$18,$18,$7e,$18,$18,$00,	$00
  3825                          	; $2c
  3826  1687  0000000000181830  DEFB $00,$00,$00,$00,$00,$18,$18,	$30
  3827                          	; $2d
  3828  168f  0000007e00000000  DEFB $00,$00,$00,$7e,$00,$00,$00,	$00
  3829                          	; $2e
  3830  1697  0000000000181800  DEFB $00,$00,$00,$00,$00,$18,$18,	$00
  3831                          	; $2f
  3832  169f  0003060c18306000  DEFB $00,$03,$06,$0c,$18,$30,$60,	$00
  3833                          	; $30
  3834  16a7  3c666e7666663c00  DEFB $3c,$66,$6e,$76,$66,$66,$3c,	$00
  3835                          	; $31
  3836  16af  1818381818187e00  DEFB $18,$18,$38,$18,$18,$18,$7e,	$00
  3837                          	; $32
  3838  16b7  3c66060c30607e00  DEFB $3c,$66,$06,$0c,$30,$60,$7e,	$00
  3839                          	; $33
  3840  16bf  3c66061c06663c00  DEFB $3c,$66,$06,$1c,$06,$66,$3c,	$00
  3841                          	; $34
  3842  16c7  060e1e667f060600  DEFB $06,$0e,$1e,$66,$7f,$06,$06,	$00
  3843                          	; $35
  3844  16cf  7e607c0606663c00  DEFB $7e,$60,$7c,$06,$06,$66,$3c,	$00
  3845                          	; $36
  3846  16d7  3c66607c66663c00  DEFB $3c,$66,$60,$7c,$66,$66,$3c,	$00
  3847                          	; $37
  3848  16df  7e660c1818181800  DEFB $7e,$66,$0c,$18,$18,$18,$18,	$00
  3849                          	; $38
  3850  16e7  3c66663c66663c00  DEFB $3c,$66,$66,$3c,$66,$66,$3c,	$00
  3851                          	; $39
  3852  16ef  3c66663e06663c00  DEFB $3c,$66,$66,$3e,$06,$66,$3c,	$00
  3853                          	; $3a
  3854  16f7  0000180000180000  DEFB $00,$00,$18,$00,$00,$18,$00,	$00
  3855                          	; $3b
  3856  16ff  0000180000181830  DEFB $00,$00,$18,$00,$00,$18,$18,	$30
  3857                          	; $3c
  3858  1707  0e18306030180e00  DEFB $0e,$18,$30,$60,$30,$18,$0e,	$00
  3859                          	; $3d
  3860  170f  00007e007e000000  DEFB $00,$00,$7e,$00,$7e,$00,$00,	$00
  3861                          	; $3e
  3862  1717  70180c060c187000  DEFB $70,$18,$0c,$06,$0c,$18,$70,	$00
  3863                          	; $3f
  3864  171f  3c66060c18001800  DEFB $3c,$66,$06,$0c,$18,$00,$18,	$00
  3865                          	; $40
  3866  1727  000000ffff000000  DEFB $00,$00,$00,$ff,$ff,$00,$00,	$00
  3867                          	; $41
  3868  172f  183c667e66666600  DEFB $18,$3c,$66,$7e,$66,$66,$66,	$00
  3869                          	; $42
  3870  1737  7c66667c66667c00  DEFB $7c,$66,$66,$7c,$66,$66,$7c,	$00
  3871                          	; $43
  3872  173f  3c66606060663c00  DEFB $3c,$66,$60,$60,$60,$66,$3c,	$00
  3873                          	; $44
  3874  1747  786c6666666c7800  DEFB $78,$6c,$66,$66,$66,$6c,$78,	$00
  3875                          	; $45
  3876  174f  7e60607860607e00  DEFB $7e,$60,$60,$78,$60,$60,$7e,	$00
  3877                          	; $46
  3878  1757  7e60607860606000  DEFB $7e,$60,$60,$78,$60,$60,$60,	$00
  3879                          	; $47
  3880  175f  3c66606e66663c00  DEFB $3c,$66,$60,$6e,$66,$66,$3c,	$00
  3881                          	; $48
  3882  1767  6666667e66666600  DEFB $66,$66,$66,$7e,$66,$66,$66,	$00
  3883                          	; $49
  3884  176f  3c18181818183c00  DEFB $3c,$18,$18,$18,$18,$18,$3c,	$00
  3885                          	; $4a
  3886  1777  1e0c0c0c0c6c3800  DEFB $1e,$0c,$0c,$0c,$0c,$6c,$38,	$00
  3887                          	; $4b
  3888  177f  666c7870786c6600  DEFB $66,$6c,$78,$70,$78,$6c,$66,	$00
  3889                          	; $4c
  3890  1787  6060606060607e00  DEFB $60,$60,$60,$60,$60,$60,$7e,	$00
  3891                          	; $4d
  3892  178f  63777f6b63636300  DEFB $63,$77,$7f,$6b,$63,$63,$63,	$00
  3893                          	; $4e
  3894  1797  66767e7e6e666600  DEFB $66,$76,$7e,$7e,$6e,$66,$66,	$00
  3895                          	; $4f
  3896  179f  3c66666666663c00  DEFB $3c,$66,$66,$66,$66,$66,$3c,	$00
  3897                          	; $50
  3898  17a7  7c66667c60606000  DEFB $7c,$66,$66,$7c,$60,$60,$60,	$00
  3899                          	; $51
  3900  17af  3c666666663c0e00  DEFB $3c,$66,$66,$66,$66,$3c,$0e,	$00
  3901                          	; $52
  3902  17b7  7c66667c786c6600  DEFB $7c,$66,$66,$7c,$78,$6c,$66,	$00
  3903                          	; $53
  3904  17bf  3c66603c06663c00  DEFB $3c,$66,$60,$3c,$06,$66,$3c,	$00
  3905                          	; $54
  3906  17c7  7e18181818181800  DEFB $7e,$18,$18,$18,$18,$18,$18,	$00
  3907                          	; $55
  3908  17cf  6666666666663c00  DEFB $66,$66,$66,$66,$66,$66,$3c,	$00
  3909                          	; $56
  3910  17d7  66666666663c1800  DEFB $66,$66,$66,$66,$66,$3c,$18,	$00
  3911                          	; $57
  3912  17df  6363636b7f776300  DEFB $63,$63,$63,$6b,$7f,$77,$63,	$00
  3913                          	; $58
  3914  17e7  66663c183c666600  DEFB $66,$66,$3c,$18,$3c,$66,$66,	$00
  3915                          	; $59
  3916  17ef  6666663c18181800  DEFB $66,$66,$66,$3c,$18,$18,$18,	$00
  3917                          	; $5a
  3918  17f7  7e060c1830607e00  DEFB $7e,$06,$0c,$18,$30,$60,$7e,	$00
  3919                          	; $5b
  3920  17ff  181818ffff181818  DEFB $18,$18,$18,$ff,$ff,$18,$18,	$18
  3921                          	; $5c
  3922  1807  c0c03030c0c03030  DEFB $c0,$c0,$30,$30,$c0,$c0,$30,	$30
  3923                          	; $5d
  3924  180f  1818181818181818  DEFB $18,$18,$18,$18,$18,$18,$18,	$18
  3925                          	; $5e
  3926  1817  3333cccc3333cccc  DEFB $33,$33,$cc,$cc,$33,$33,$cc,	$cc
  3927                          	; $5f
  3928  181f  3399cc663399cc66  DEFB $33,$99,$cc,$66,$33,$99,$cc,	$66
  3929                          	; $60
  3930  1827  0000000000000000  DEFB $00,$00,$00,$00,$00,$00,$00,	$00
  3931                          	; $61
  3932  182f  f0f0f0f0f0f0f0f0  DEFB $f0,$f0,$f0,$f0,$f0,$f0,$f0,	$f0
  3933                          	; $62
  3934  1837  00000000ffffffff  DEFB $00,$00,$00,$00,$ff,$ff,$ff,	$ff
  3935                          	; $63
  3936  183f  ff00000000000000  DEFB $ff,$00,$00,$00,$00,$00,$00,	$00
  3937                          	; $64
  3938  1847  00000000000000ff  DEFB $00,$00,$00,$00,$00,$00,$00,	$ff
  3939                          	; $65
  3940  184f  c0c0c0c0c0c0c0c0  DEFB $c0,$c0,$c0,$c0,$c0,$c0,$c0,	$c0
  3941                          	; $66
  3942  1857  cccc3333cccc3333  DEFB $cc,$cc,$33,$33,$cc,$cc,$33,	$33
  3943                          	; $67
  3944  185f  0303030303030303  DEFB $03,$03,$03,$03,$03,$03,$03,	$03
  3945                          	; $68
  3946  1867  00000000cccc3333  DEFB $00,$00,$00,$00,$cc,$cc,$33,	$33
  3947                          	; $69
  3948  186f  cc993366cc993366  DEFB $cc,$99,$33,$66,$cc,$99,$33,	$66
  3949                          	; $6a
  3950  1877  0303030303030303  DEFB $03,$03,$03,$03,$03,$03,$03,	$03
  3951                          	; $6b
  3952  187f  1818181f1f181818  DEFB $18,$18,$18,$1f,$1f,$18,$18,	$18
  3953                          	; $6c
  3954  1887  000000000f0f0f0f  DEFB $00,$00,$00,$00,$0f,$0f,$0f,	$0f
  3955                          	; $6d
  3956  188f  1818181f1f000000  DEFB $18,$18,$18,$1f,$1f,$00,$00,	$00
  3957                          	; $6e
  3958  1897  000000f8f8181818  DEFB $00,$00,$00,$f8,$f8,$18,$18,	$18
  3959                          	; $6f
  3960  189f  000000000000ffff  DEFB $00,$00,$00,$00,$00,$00,$ff,	$ff
  3961                          	; $70
  3962  18a7  0000001f1f181818  DEFB $00,$00,$00,$1f,$1f,$18,$18,	$18
  3963                          	; $71
  3964  18af  181818ffff000000  DEFB $18,$18,$18,$ff,$ff,$00,$00,	$00
  3965                          	; $72
  3966  18b7  000000ffff181818  DEFB $00,$00,$00,$ff,$ff,$18,$18,	$18
  3967                          	; $73
  3968  18bf  181818f8f8181818  DEFB $18,$18,$18,$f8,$f8,$18,$18,	$18
  3969                          	; $74
  3970  18c7  c0c0c0c0c0c0c0c0  DEFB $c0,$c0,$c0,$c0,$c0,$c0,$c0,	$c0
  3971                          	; $75
  3972  18cf  e0e0e0e0e0e0e0e0  DEFB $e0,$e0,$e0,$e0,$e0,$e0,$e0,	$e0
  3973                          	; $76
  3974  18d7  0707070707070707  DEFB $07,$07,$07,$07,$07,$07,$07,	$07
  3975                          	; $77
  3976  18df  ffff000000000000  DEFB $ff,$ff,$00,$00,$00,$00,$00,	$00
  3977                          	; $78
  3978  18e7  ffffff0000000000  DEFB $ff,$ff,$ff,$00,$00,$00,$00,	$00
  3979                          	; $79
  3980  18ef  0000000000ffffff  DEFB $00,$00,$00,$00,$00,$ff,$ff,	$ff
  3981                          	; $7a
  3982  18f7  0103066c78706000  DEFB $01,$03,$06,$6c,$78,$70,$60,	$00
  3983                          	; $7b
  3984  18ff  00000000f0f0f0f0  DEFB $00,$00,$00,$00,$f0,$f0,$f0,	$f0
  3985                          	; $7c
  3986  1907  0f0f0f0f00000000  DEFB $0f,$0f,$0f,$0f,$00,$00,$00,	$00
  3987                          	; $7d
  3988  190f  181818f8f8000000  DEFB $18,$18,$18,$f8,$f8,$00,$00,	$00
  3989                          	; $7e
  3990  1917  f0f0f0f000000000  DEFB $f0,$f0,$f0,$f0,$00,$00,$00,	$00
  3991                          	; $7f
  3992  191f  f0f0f0f00f0f0f0f  DEFB $f0,$f0,$f0,$f0,$0f,$0f,$0f,	$0f
  3993                          	; $80
  3994  1927  c39991919f99c3ff  DEFB $c3,$99,$91,$91,$9f,$99,$c3,	$ff
  3995                          	; $81
  3996  192f  ffffc3f9c199c1ff  DEFB $ff,$ff,$c3,$f9,$c1,$99,$c1,	$ff
  3997                          	; $82
  3998  1937  ff9f9f83999983ff  DEFB $ff,$9f,$9f,$83,$99,$99,$83,	$ff
  3999                          	; $83
  4000  193f  ffffc39f9f9fc3ff  DEFB $ff,$ff,$c3,$9f,$9f,$9f,$c3,	$ff
  4001                          	; $84
  4002  1947  fff9f9c19999c1ff  DEFB $ff,$f9,$f9,$c1,$99,$99,$c1,	$ff
  4003                          	; $85
  4004  194f  ffffc399819fc3ff  DEFB $ff,$ff,$c3,$99,$81,$9f,$c3,	$ff
  4005                          	; $86
  4006  1957  fff1e7c1e7e7e7ff  DEFB $ff,$f1,$e7,$c1,$e7,$e7,$e7,	$ff
  4007                          	; $87
  4008  195f  ffffc19999c1f983  DEFB $ff,$ff,$c1,$99,$99,$c1,$f9,	$83
  4009                          	; $88
  4010  1967  ff9f9f83999999ff  DEFB $ff,$9f,$9f,$83,$99,$99,$99,	$ff
  4011                          	; $89
  4012  196f  ffe7ffc7e7e7c3ff  DEFB $ff,$e7,$ff,$c7,$e7,$e7,$c3,	$ff
  4013                          	; $8a
  4014  1977  fff9fff9f9f9f9c3  DEFB $ff,$f9,$ff,$f9,$f9,$f9,$f9,	$c3
  4015                          	; $8b
  4016  197f  ff9f9f93879399ff  DEFB $ff,$9f,$9f,$93,$87,$93,$99,	$ff
  4017                          	; $8c
  4018  1987  ffc7e7e7e7e7c3ff  DEFB $ff,$c7,$e7,$e7,$e7,$e7,$c3,	$ff
  4019                          	; $8d
  4020  198f  ffff998080949cff  DEFB $ff,$ff,$99,$80,$80,$94,$9c,	$ff
  4021                          	; $8e
  4022  1997  ffff8399999999ff  DEFB $ff,$ff,$83,$99,$99,$99,$99,	$ff
  4023                          	; $8f
  4024  199f  ffffc3999999c3ff  DEFB $ff,$ff,$c3,$99,$99,$99,$c3,	$ff
  4025                          	; $90
  4026  19a7  ffff839999839f9f  DEFB $ff,$ff,$83,$99,$99,$83,$9f,	$9f
  4027                          	; $91
  4028  19af  ffffc19999c1f9f9  DEFB $ff,$ff,$c1,$99,$99,$c1,$f9,	$f9
  4029                          	; $92
  4030  19b7  ffff83999f9f9fff  DEFB $ff,$ff,$83,$99,$9f,$9f,$9f,	$ff
  4031                          	; $93
  4032  19bf  ffffc19fc3f983ff  DEFB $ff,$ff,$c1,$9f,$c3,$f9,$83,	$ff
  4033                          	; $94
  4034  19c7  ffe781e7e7e7f1ff  DEFB $ff,$e7,$81,$e7,$e7,$e7,$f1,	$ff
  4035                          	; $95
  4036  19cf  ffff99999999c1ff  DEFB $ff,$ff,$99,$99,$99,$99,$c1,	$ff
  4037                          	; $96
  4038  19d7  ffff999999c3e7ff  DEFB $ff,$ff,$99,$99,$99,$c3,$e7,	$ff
  4039                          	; $97
  4040  19df  ffff9c9480c1c9ff  DEFB $ff,$ff,$9c,$94,$80,$c1,$c9,	$ff
  4041                          	; $98
  4042  19e7  ffff99c3e7c399ff  DEFB $ff,$ff,$99,$c3,$e7,$c3,$99,	$ff
  4043                          	; $99
  4044  19ef  ffff999999c1f387  DEFB $ff,$ff,$99,$99,$99,$c1,$f3,	$87
  4045                          	; $9a
  4046  19f7  ffff81f3e7cf81ff  DEFB $ff,$ff,$81,$f3,$e7,$cf,$81,	$ff
  4047                          	; $9b
  4048  19ff  c3cfcfcfcfcfc3ff  DEFB $c3,$cf,$cf,$cf,$cf,$cf,$c3,	$ff
  4049                          	; $9c
  4050  1a07  f3edcf83cf9d03ff  DEFB $f3,$ed,$cf,$83,$cf,$9d,$03,	$ff
  4051                          	; $9d
  4052  1a0f  c3f3f3f3f3f3c3ff  DEFB $c3,$f3,$f3,$f3,$f3,$f3,$c3,	$ff
  4053                          	; $9e
  4054  1a17  ffe7c381e7e7e7e7  DEFB $ff,$e7,$c3,$81,$e7,$e7,$e7,	$e7
  4055                          	; $9f
  4056  1a1f  ffefcf8080cfefff  DEFB $ff,$ef,$cf,$80,$80,$cf,$ef,	$ff
  4057                          	; $a0
  4058  1a27  ffffffffffffffff  DEFB $ff,$ff,$ff,$ff,$ff,$ff,$ff,	$ff
  4059                          	; $a1
  4060  1a2f  e7e7e7e7ffffe7ff  DEFB $e7,$e7,$e7,$e7,$ff,$ff,$e7,	$ff
  4061                          	; $a2
  4062  1a37  999999ffffffffff  DEFB $99,$99,$99,$ff,$ff,$ff,$ff,	$ff
  4063                          	; $a3
  4064  1a3f  99990099009999ff  DEFB $99,$99,$00,$99,$00,$99,$99,	$ff
  4065                          	; $a4
  4066  1a47  e7c19fc3f983e7ff  DEFB $e7,$c1,$9f,$c3,$f9,$83,$e7,	$ff
  4067                          	; $a5
  4068  1a4f  9d99f3e7cf99b9ff  DEFB $9d,$99,$f3,$e7,$cf,$99,$b9,	$ff
  4069                          	; $a6
  4070  1a57  c399c3c79899c0ff  DEFB $c3,$99,$c3,$c7,$98,$99,$c0,	$ff
  4071                          	; $a7
  4072  1a5f  f9f3e7ffffffffff  DEFB $f9,$f3,$e7,$ff,$ff,$ff,$ff,	$ff
  4073                          	; $a8
  4074  1a67  f3e7cfcfcfe7f3ff  DEFB $f3,$e7,$cf,$cf,$cf,$e7,$f3,	$ff
  4075                          	; $a9
  4076  1a6f  cfe7f3f3f3e7cfff  DEFB $cf,$e7,$f3,$f3,$f3,$e7,$cf,	$ff
  4077                          	; $aa
  4078  1a77  ff99c300c399ffff  DEFB $ff,$99,$c3,$00,$c3,$99,$ff,	$ff
  4079                          	; $ab
  4080  1a7f  ffe7e781e7e7ffff  DEFB $ff,$e7,$e7,$81,$e7,$e7,$ff,	$ff
  4081                          	; $ac
  4082  1a87  ffffffffffe7e7cf  DEFB $ff,$ff,$ff,$ff,$ff,$e7,$e7,	$cf
  4083                          	; $ad
  4084  1a8f  ffffff81ffffffff  DEFB $ff,$ff,$ff,$81,$ff,$ff,$ff,	$ff
  4085                          	; $ae
  4086  1a97  ffffffffffe7e7ff  DEFB $ff,$ff,$ff,$ff,$ff,$e7,$e7,	$ff
  4087                          	; $af
  4088  1a9f  fffcf9f3e7cf9fff  DEFB $ff,$fc,$f9,$f3,$e7,$cf,$9f,	$ff
  4089                          	; $b0
  4090  1aa7  c39991899999c3ff  DEFB $c3,$99,$91,$89,$99,$99,$c3,	$ff
  4091                          	; $b1
  4092  1aaf  e7e7c7e7e7e781ff  DEFB $e7,$e7,$c7,$e7,$e7,$e7,$81,	$ff
  4093                          	; $b2
  4094  1ab7  c399f9f3cf9f81ff  DEFB $c3,$99,$f9,$f3,$cf,$9f,$81,	$ff
  4095                          	; $b3
  4096  1abf  c399f9e3f999c3ff  DEFB $c3,$99,$f9,$e3,$f9,$99,$c3,	$ff
  4097                          	; $b4
  4098  1ac7  f9f1e19980f9f9ff  DEFB $f9,$f1,$e1,$99,$80,$f9,$f9,	$ff
  4099                          	; $b5
  4100  1acf  819f83f9f999c3ff  DEFB $81,$9f,$83,$f9,$f9,$99,$c3,	$ff
  4101                          	; $b6
  4102  1ad7  c3999f839999c3ff  DEFB $c3,$99,$9f,$83,$99,$99,$c3,	$ff
  4103                          	; $b7
  4104  1adf  8199f3e7e7e7e7ff  DEFB $81,$99,$f3,$e7,$e7,$e7,$e7,	$ff
  4105                          	; $b8
  4106  1ae7  c39999c39999c3ff  DEFB $c3,$99,$99,$c3,$99,$99,$c3,	$ff
  4107                          	; $b9
  4108  1aef  c39999c1f999c3ff  DEFB $c3,$99,$99,$c1,$f9,$99,$c3,	$ff
  4109                          	; $ba
  4110  1af7  ffffe7ffffe7ffff  DEFB $ff,$ff,$e7,$ff,$ff,$e7,$ff,	$ff
  4111                          	; $bb
  4112  1aff  ffffe7ffffe7e7cf  DEFB $ff,$ff,$e7,$ff,$ff,$e7,$e7,	$cf
  4113                          	; $bc
  4114  1b07  f1e7cf9fcfe7f1ff  DEFB $f1,$e7,$cf,$9f,$cf,$e7,$f1,	$ff
  4115                          	; $bd
  4116  1b0f  ffff81ff81ffffff  DEFB $ff,$ff,$81,$ff,$81,$ff,$ff,	$ff
  4117                          	; $be
  4118  1b17  8fe7f3f9f3e78fff  DEFB $8f,$e7,$f3,$f9,$f3,$e7,$8f,	$ff
  4119                          	; $bf
  4120  1b1f  c399f9f3e7ffe7ff  DEFB $c3,$99,$f9,$f3,$e7,$ff,$e7,	$ff
  4121                          	; $c0
  4122  1b27  ffffff0000ffffff  DEFB $ff,$ff,$ff,$00,$00,$ff,$ff,	$ff
  4123                          	; $c1
  4124  1b2f  e7c39981999999ff  DEFB $e7,$c3,$99,$81,$99,$99,$99,	$ff
  4125                          	; $c2
  4126  1b37  83999983999983ff  DEFB $83,$99,$99,$83,$99,$99,$83,	$ff
  4127                          	; $c3
  4128  1b3f  c3999f9f9f99c3ff  DEFB $c3,$99,$9f,$9f,$9f,$99,$c3,	$ff
  4129                          	; $c4
  4130  1b47  87939999999387ff  DEFB $87,$93,$99,$99,$99,$93,$87,	$ff
  4131                          	; $c5
  4132  1b4f  819f9f879f9f81ff  DEFB $81,$9f,$9f,$87,$9f,$9f,$81,	$ff
  4133                          	; $c6
  4134  1b57  819f9f879f9f9fff  DEFB $81,$9f,$9f,$87,$9f,$9f,$9f,	$ff
  4135                          	; $c7
  4136  1b5f  c3999f919999c3ff  DEFB $c3,$99,$9f,$91,$99,$99,$c3,	$ff
  4137                          	; $c8
  4138  1b67  99999981999999ff  DEFB $99,$99,$99,$81,$99,$99,$99,	$ff
  4139                          	; $c9
  4140  1b6f  c3e7e7e7e7e7c3ff  DEFB $c3,$e7,$e7,$e7,$e7,$e7,$c3,	$ff
  4141                          	; $ca
  4142  1b77  e1f3f3f3f393c7ff  DEFB $e1,$f3,$f3,$f3,$f3,$93,$c7,	$ff
  4143                          	; $cb
  4144  1b7f  9993878f879399ff  DEFB $99,$93,$87,$8f,$87,$93,$99,	$ff
  4145                          	; $cc
  4146  1b87  9f9f9f9f9f9f81ff  DEFB $9f,$9f,$9f,$9f,$9f,$9f,$81,	$ff
  4147                          	; $cd
  4148  1b8f  9c8880949c9c9cff  DEFB $9c,$88,$80,$94,$9c,$9c,$9c,	$ff
  4149                          	; $ce
  4150  1b97  99898181919999ff  DEFB $99,$89,$81,$81,$91,$99,$99,	$ff
  4151                          	; $cf
  4152  1b9f  c39999999999c3ff  DEFB $c3,$99,$99,$99,$99,$99,$c3,	$ff
  4153                          	; $d0
  4154  1ba7  839999839f9f9fff  DEFB $83,$99,$99,$83,$9f,$9f,$9f,	$ff
  4155                          	; $d1
  4156  1baf  c399999999c3f1ff  DEFB $c3,$99,$99,$99,$99,$c3,$f1,	$ff
  4157                          	; $d2
  4158  1bb7  83999983879399ff  DEFB $83,$99,$99,$83,$87,$93,$99,	$ff
  4159                          	; $d3
  4160  1bbf  c3999fc3f999c3ff  DEFB $c3,$99,$9f,$c3,$f9,$99,$c3,	$ff
  4161                          	; $d4
  4162  1bc7  81e7e7e7e7e7e7ff  DEFB $81,$e7,$e7,$e7,$e7,$e7,$e7,	$ff
  4163                          	; $d5
  4164  1bcf  999999999999c3ff  DEFB $99,$99,$99,$99,$99,$99,$c3,	$ff
  4165                          	; $d6
  4166  1bd7  9999999999c3e7ff  DEFB $99,$99,$99,$99,$99,$c3,$e7,	$ff
  4167                          	; $d7
  4168  1bdf  9c9c9c9480889cff  DEFB $9c,$9c,$9c,$94,$80,$88,$9c,	$ff
  4169                          	; $d8
  4170  1be7  9999c3e7c39999ff  DEFB $99,$99,$c3,$e7,$c3,$99,$99,	$ff
  4171                          	; $d9
  4172  1bef  999999c3e7e7e7ff  DEFB $99,$99,$99,$c3,$e7,$e7,$e7,	$ff
  4173                          	; $da
  4174  1bf7  81f9f3e7cf9f81ff  DEFB $81,$f9,$f3,$e7,$cf,$9f,$81,	$ff
  4175                          	; $db
  4176  1bff  e7e7e70000e7e7e7  DEFB $e7,$e7,$e7,$00,$00,$e7,$e7,	$e7
  4177                          	; $dc
  4178  1c07  3f3fcfcf3f3fcfcf  DEFB $3f,$3f,$cf,$cf,$3f,$3f,$cf,	$cf
  4179                          	; $dd
  4180  1c0f  e7e7e7e7e7e7e7e7  DEFB $e7,$e7,$e7,$e7,$e7,$e7,$e7,	$e7
  4181                          	; $de
  4182  1c17  cccc3333cccc3333  DEFB $cc,$cc,$33,$33,$cc,$cc,$33,	$33
  4183                          	; $df
  4184  1c1f  cc663399cc663399  DEFB $cc,$66,$33,$99,$cc,$66,$33,	$99
  4185                          	; $e0
  4186  1c27  ffffffffffffffff  DEFB $ff,$ff,$ff,$ff,$ff,$ff,$ff,	$ff
  4187                          	; $e1
  4188  1c2f  0f0f0f0f0f0f0f0f  DEFB $0f,$0f,$0f,$0f,$0f,$0f,$0f,	$0f
  4189                          	; $e2
  4190  1c37  ffffffff00000000  DEFB $ff,$ff,$ff,$ff,$00,$00,$00,	$00
  4191                          	; $e3
  4192  1c3f  00ffffffffffffff  DEFB $00,$ff,$ff,$ff,$ff,$ff,$ff,	$ff
  4193                          	; $e4
  4194  1c47  ffffffffffffff00  DEFB $ff,$ff,$ff,$ff,$ff,$ff,$ff,	$00
  4195                          	; $e5
  4196  1c4f  3f3f3f3f3f3f3f3f  DEFB $3f,$3f,$3f,$3f,$3f,$3f,$3f,	$3f
  4197                          	; $e6
  4198  1c57  3333cccc3333cccc  DEFB $33,$33,$cc,$cc,$33,$33,$cc,	$cc
  4199                          	; $e7
  4200  1c5f  fcfcfcfcfcfcfcfc  DEFB $fc,$fc,$fc,$fc,$fc,$fc,$fc,	$fc
  4201                          	; $e8
  4202  1c67  ffffffff3333cccc  DEFB $ff,$ff,$ff,$ff,$33,$33,$cc,	$cc
  4203                          	; $e9
  4204  1c6f  3366cc993366cc99  DEFB $33,$66,$cc,$99,$33,$66,$cc,	$99
  4205                          	; $ea
  4206  1c77  fcfcfcfcfcfcfcfc  DEFB $fc,$fc,$fc,$fc,$fc,$fc,$fc,	$fc
  4207                          	; $eb
  4208  1c7f  e7e7e7e0e0e7e7e7  DEFB $e7,$e7,$e7,$e0,$e0,$e7,$e7,	$e7
  4209                          	; $ec
  4210  1c87  fffffffff0f0f0f0  DEFB $ff,$ff,$ff,$ff,$f0,$f0,$f0,	$f0
  4211                          	; $ed
  4212  1c8f  e7e7e7e0e0ffffff  DEFB $e7,$e7,$e7,$e0,$e0,$ff,$ff,	$ff
  4213                          	; $ee
  4214  1c97  ffffff0707e7e7e7  DEFB $ff,$ff,$ff,$07,$07,$e7,$e7,	$e7
  4215                          	; $ef
  4216  1c9f  ffffffffffff0000  DEFB $ff,$ff,$ff,$ff,$ff,$ff,$00,	$00
  4217                          	; $f0
  4218  1ca7  ffffffe0e0e7e7e7  DEFB $ff,$ff,$ff,$e0,$e0,$e7,$e7,	$e7
  4219                          	; $f1
  4220  1caf  e7e7e70000ffffff  DEFB $e7,$e7,$e7,$00,$00,$ff,$ff,	$ff
  4221                          	; $f2
  4222  1cb7  ffffff0000e7e7e7  DEFB $ff,$ff,$ff,$00,$00,$e7,$e7,	$e7
  4223                          	; $f3
  4224  1cbf  e7e7e70707e7e7e7  DEFB $e7,$e7,$e7,$07,$07,$e7,$e7,	$e7
  4225                          	; $f4
  4226  1cc7  3f3f3f3f3f3f3f3f  DEFB $3f,$3f,$3f,$3f,$3f,$3f,$3f,	$3f
  4227                          	; $f5
  4228  1ccf  1f1f1f1f1f1f1f1f  DEFB $1f,$1f,$1f,$1f,$1f,$1f,$1f,	$1f
  4229                          	; $f6
  4230  1cd7  f8f8f8f8f8f8f8f8  DEFB $f8,$f8,$f8,$f8,$f8,$f8,$f8,	$f8
  4231                          	; $f7
  4232  1cdf  0000ffffffffffff  DEFB $00,$00,$ff,$ff,$ff,$ff,$ff,	$ff
  4233                          	; $f8
  4234  1ce7  000000ffffffffff  DEFB $00,$00,$00,$ff,$ff,$ff,$ff,	$ff
  4235                          	; $f9
  4236  1cef  ffffffffff000000  DEFB $ff,$ff,$ff,$ff,$ff,$00,$00,	$00
  4237                          	; $fa
  4238  1cf7  fefcf993878f9fff  DEFB $fe,$fc,$f9,$93,$87,$8f,$9f,	$ff
  4239                          	; $fb
  4240  1cff  ffffffff0f0f0f0f  DEFB $ff,$ff,$ff,$ff,$0f,$0f,$0f,	$0f
  4241                          	; $fc
  4242  1d07  f0f0f0f0ffffffff  DEFB $f0,$f0,$f0,$f0,$ff,$ff,$ff,	$ff
  4243                          	; $fd
  4244  1d0f  e7e7e70707ffffff  DEFB $e7,$e7,$e7,$07,$07,$ff,$ff,	$ff
  4245                          	; $fe
  4246  1d17  0f0f0f0fffffffff  DEFB $0f,$0f,$0f,$0f,$ff,$ff,$ff,	$ff
  4247                          AY8910STARTUP:
  4248  1d1f  c9                	RET
  4249                          MUSICPLAYER:
  4250  1d20  c9                	RET
  4251                          PROTOTHREADINIT:
  4252  1d21  c9                	RET
  4253                          ; peephole: pass 1, 76 changes.
  4254                          ; peephole: pass 2, 0 change.
  4255                          ; peephole: pass 3, 38 vars removed.
  4256                          ; peephole: pass 4, 8 changes.
  4257                          ; peephole: pass 5, 3 changes.
  4258                          ; peephole: pass 6, 0 change.
  4259                          ; peephole: pass 7, 0 var removed.
  4260                          ; peephole: pass 8, 0 var moved to dp, 0 var inlined.
  4261                          
