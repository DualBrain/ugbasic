H2STRING
    CMPB #0
    BNE H2STRINGA
    RTS

H2STRINGA
    LDA #0
    TFR D, U
    LDB #0
    LEAU -1, U
H2STRINGL1
    LDA B,X
    JSR H2STRINGBYTE
    LDA <MATHPTR2
    STA 1,Y
    LDA <MATHPTR1
    STA 0,Y
    LEAY 2, Y
H2STRINGL1A
    INCB
    LEAU -1, U
    CMPU #$FFFF
    BNE H2STRINGL1
    RTS

H2STRINGBYTE
    PSHS A
    LSRA
    LSRA
    LSRA
    LSRA
    CMPA #$0a
    BGE HEX2STRINGA
HEX2STRING0
    ADDA #48
    STA <MATHPTR1
    JMP HEX2STRINGLSB
HEX2STRINGA
    ADDA #55
    STA <MATHPTR1
HEX2STRINGLSB
    PULS A
    ANDA #$0F
    CMPA #$0A
    BGE HEX2STRINGA2
HEX2STRING02
    ADDA #48
    STA <MATHPTR2
    RTS
HEX2STRINGA2
    ADDA #55
    STA <MATHPTR2
    RTS